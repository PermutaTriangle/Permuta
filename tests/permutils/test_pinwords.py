# import pytest

from pathlib import Path

from automata.fa.dfa import DFA
from automata.fa.nfa import NFA

from permuta import Perm
from permuta.permutils.pin_words import PinWords


def test_pinwords_of_length():
    assert list(PinWords.pinwords_of_length(0)) == [""]
    assert list(PinWords.pinwords_of_length(1)) == ["1", "2", "3", "4"]
    assert list(PinWords.pinwords_of_length(2)) == [
        "1U",
        "1D",
        "1L",
        "1R",
        "11",
        "12",
        "13",
        "14",
        "2U",
        "2D",
        "2L",
        "2R",
        "21",
        "22",
        "23",
        "24",
        "3U",
        "3D",
        "3L",
        "3R",
        "31",
        "32",
        "33",
        "34",
        "4U",
        "4D",
        "4L",
        "4R",
        "41",
        "42",
        "43",
        "44",
    ]
    assert list(PinWords.pinwords_of_length(3)) == [
        "1UL",
        "1UR",
        "1U1",
        "1U2",
        "1U3",
        "1U4",
        "1DL",
        "1DR",
        "1D1",
        "1D2",
        "1D3",
        "1D4",
        "1LU",
        "1LD",
        "1L1",
        "1L2",
        "1L3",
        "1L4",
        "1RU",
        "1RD",
        "1R1",
        "1R2",
        "1R3",
        "1R4",
        "11U",
        "11D",
        "11L",
        "11R",
        "111",
        "112",
        "113",
        "114",
        "12U",
        "12D",
        "12L",
        "12R",
        "121",
        "122",
        "123",
        "124",
        "13U",
        "13D",
        "13L",
        "13R",
        "131",
        "132",
        "133",
        "134",
        "14U",
        "14D",
        "14L",
        "14R",
        "141",
        "142",
        "143",
        "144",
        "2UL",
        "2UR",
        "2U1",
        "2U2",
        "2U3",
        "2U4",
        "2DL",
        "2DR",
        "2D1",
        "2D2",
        "2D3",
        "2D4",
        "2LU",
        "2LD",
        "2L1",
        "2L2",
        "2L3",
        "2L4",
        "2RU",
        "2RD",
        "2R1",
        "2R2",
        "2R3",
        "2R4",
        "21U",
        "21D",
        "21L",
        "21R",
        "211",
        "212",
        "213",
        "214",
        "22U",
        "22D",
        "22L",
        "22R",
        "221",
        "222",
        "223",
        "224",
        "23U",
        "23D",
        "23L",
        "23R",
        "231",
        "232",
        "233",
        "234",
        "24U",
        "24D",
        "24L",
        "24R",
        "241",
        "242",
        "243",
        "244",
        "3UL",
        "3UR",
        "3U1",
        "3U2",
        "3U3",
        "3U4",
        "3DL",
        "3DR",
        "3D1",
        "3D2",
        "3D3",
        "3D4",
        "3LU",
        "3LD",
        "3L1",
        "3L2",
        "3L3",
        "3L4",
        "3RU",
        "3RD",
        "3R1",
        "3R2",
        "3R3",
        "3R4",
        "31U",
        "31D",
        "31L",
        "31R",
        "311",
        "312",
        "313",
        "314",
        "32U",
        "32D",
        "32L",
        "32R",
        "321",
        "322",
        "323",
        "324",
        "33U",
        "33D",
        "33L",
        "33R",
        "331",
        "332",
        "333",
        "334",
        "34U",
        "34D",
        "34L",
        "34R",
        "341",
        "342",
        "343",
        "344",
        "4UL",
        "4UR",
        "4U1",
        "4U2",
        "4U3",
        "4U4",
        "4DL",
        "4DR",
        "4D1",
        "4D2",
        "4D3",
        "4D4",
        "4LU",
        "4LD",
        "4L1",
        "4L2",
        "4L3",
        "4L4",
        "4RU",
        "4RD",
        "4R1",
        "4R2",
        "4R3",
        "4R4",
        "41U",
        "41D",
        "41L",
        "41R",
        "411",
        "412",
        "413",
        "414",
        "42U",
        "42D",
        "42L",
        "42R",
        "421",
        "422",
        "423",
        "424",
        "43U",
        "43D",
        "43L",
        "43R",
        "431",
        "432",
        "433",
        "434",
        "44U",
        "44D",
        "44L",
        "44R",
        "441",
        "442",
        "443",
        "444",
    ]
    assert list(PinWords.pinwords_of_length(4)) == [
        "1ULU",
        "1ULD",
        "1UL1",
        "1UL2",
        "1UL3",
        "1UL4",
        "1URU",
        "1URD",
        "1UR1",
        "1UR2",
        "1UR3",
        "1UR4",
        "1U1U",
        "1U1D",
        "1U1L",
        "1U1R",
        "1U11",
        "1U12",
        "1U13",
        "1U14",
        "1U2U",
        "1U2D",
        "1U2L",
        "1U2R",
        "1U21",
        "1U22",
        "1U23",
        "1U24",
        "1U3U",
        "1U3D",
        "1U3L",
        "1U3R",
        "1U31",
        "1U32",
        "1U33",
        "1U34",
        "1U4U",
        "1U4D",
        "1U4L",
        "1U4R",
        "1U41",
        "1U42",
        "1U43",
        "1U44",
        "1DLU",
        "1DLD",
        "1DL1",
        "1DL2",
        "1DL3",
        "1DL4",
        "1DRU",
        "1DRD",
        "1DR1",
        "1DR2",
        "1DR3",
        "1DR4",
        "1D1U",
        "1D1D",
        "1D1L",
        "1D1R",
        "1D11",
        "1D12",
        "1D13",
        "1D14",
        "1D2U",
        "1D2D",
        "1D2L",
        "1D2R",
        "1D21",
        "1D22",
        "1D23",
        "1D24",
        "1D3U",
        "1D3D",
        "1D3L",
        "1D3R",
        "1D31",
        "1D32",
        "1D33",
        "1D34",
        "1D4U",
        "1D4D",
        "1D4L",
        "1D4R",
        "1D41",
        "1D42",
        "1D43",
        "1D44",
        "1LUL",
        "1LUR",
        "1LU1",
        "1LU2",
        "1LU3",
        "1LU4",
        "1LDL",
        "1LDR",
        "1LD1",
        "1LD2",
        "1LD3",
        "1LD4",
        "1L1U",
        "1L1D",
        "1L1L",
        "1L1R",
        "1L11",
        "1L12",
        "1L13",
        "1L14",
        "1L2U",
        "1L2D",
        "1L2L",
        "1L2R",
        "1L21",
        "1L22",
        "1L23",
        "1L24",
        "1L3U",
        "1L3D",
        "1L3L",
        "1L3R",
        "1L31",
        "1L32",
        "1L33",
        "1L34",
        "1L4U",
        "1L4D",
        "1L4L",
        "1L4R",
        "1L41",
        "1L42",
        "1L43",
        "1L44",
        "1RUL",
        "1RUR",
        "1RU1",
        "1RU2",
        "1RU3",
        "1RU4",
        "1RDL",
        "1RDR",
        "1RD1",
        "1RD2",
        "1RD3",
        "1RD4",
        "1R1U",
        "1R1D",
        "1R1L",
        "1R1R",
        "1R11",
        "1R12",
        "1R13",
        "1R14",
        "1R2U",
        "1R2D",
        "1R2L",
        "1R2R",
        "1R21",
        "1R22",
        "1R23",
        "1R24",
        "1R3U",
        "1R3D",
        "1R3L",
        "1R3R",
        "1R31",
        "1R32",
        "1R33",
        "1R34",
        "1R4U",
        "1R4D",
        "1R4L",
        "1R4R",
        "1R41",
        "1R42",
        "1R43",
        "1R44",
        "11UL",
        "11UR",
        "11U1",
        "11U2",
        "11U3",
        "11U4",
        "11DL",
        "11DR",
        "11D1",
        "11D2",
        "11D3",
        "11D4",
        "11LU",
        "11LD",
        "11L1",
        "11L2",
        "11L3",
        "11L4",
        "11RU",
        "11RD",
        "11R1",
        "11R2",
        "11R3",
        "11R4",
        "111U",
        "111D",
        "111L",
        "111R",
        "1111",
        "1112",
        "1113",
        "1114",
        "112U",
        "112D",
        "112L",
        "112R",
        "1121",
        "1122",
        "1123",
        "1124",
        "113U",
        "113D",
        "113L",
        "113R",
        "1131",
        "1132",
        "1133",
        "1134",
        "114U",
        "114D",
        "114L",
        "114R",
        "1141",
        "1142",
        "1143",
        "1144",
        "12UL",
        "12UR",
        "12U1",
        "12U2",
        "12U3",
        "12U4",
        "12DL",
        "12DR",
        "12D1",
        "12D2",
        "12D3",
        "12D4",
        "12LU",
        "12LD",
        "12L1",
        "12L2",
        "12L3",
        "12L4",
        "12RU",
        "12RD",
        "12R1",
        "12R2",
        "12R3",
        "12R4",
        "121U",
        "121D",
        "121L",
        "121R",
        "1211",
        "1212",
        "1213",
        "1214",
        "122U",
        "122D",
        "122L",
        "122R",
        "1221",
        "1222",
        "1223",
        "1224",
        "123U",
        "123D",
        "123L",
        "123R",
        "1231",
        "1232",
        "1233",
        "1234",
        "124U",
        "124D",
        "124L",
        "124R",
        "1241",
        "1242",
        "1243",
        "1244",
        "13UL",
        "13UR",
        "13U1",
        "13U2",
        "13U3",
        "13U4",
        "13DL",
        "13DR",
        "13D1",
        "13D2",
        "13D3",
        "13D4",
        "13LU",
        "13LD",
        "13L1",
        "13L2",
        "13L3",
        "13L4",
        "13RU",
        "13RD",
        "13R1",
        "13R2",
        "13R3",
        "13R4",
        "131U",
        "131D",
        "131L",
        "131R",
        "1311",
        "1312",
        "1313",
        "1314",
        "132U",
        "132D",
        "132L",
        "132R",
        "1321",
        "1322",
        "1323",
        "1324",
        "133U",
        "133D",
        "133L",
        "133R",
        "1331",
        "1332",
        "1333",
        "1334",
        "134U",
        "134D",
        "134L",
        "134R",
        "1341",
        "1342",
        "1343",
        "1344",
        "14UL",
        "14UR",
        "14U1",
        "14U2",
        "14U3",
        "14U4",
        "14DL",
        "14DR",
        "14D1",
        "14D2",
        "14D3",
        "14D4",
        "14LU",
        "14LD",
        "14L1",
        "14L2",
        "14L3",
        "14L4",
        "14RU",
        "14RD",
        "14R1",
        "14R2",
        "14R3",
        "14R4",
        "141U",
        "141D",
        "141L",
        "141R",
        "1411",
        "1412",
        "1413",
        "1414",
        "142U",
        "142D",
        "142L",
        "142R",
        "1421",
        "1422",
        "1423",
        "1424",
        "143U",
        "143D",
        "143L",
        "143R",
        "1431",
        "1432",
        "1433",
        "1434",
        "144U",
        "144D",
        "144L",
        "144R",
        "1441",
        "1442",
        "1443",
        "1444",
        "2ULU",
        "2ULD",
        "2UL1",
        "2UL2",
        "2UL3",
        "2UL4",
        "2URU",
        "2URD",
        "2UR1",
        "2UR2",
        "2UR3",
        "2UR4",
        "2U1U",
        "2U1D",
        "2U1L",
        "2U1R",
        "2U11",
        "2U12",
        "2U13",
        "2U14",
        "2U2U",
        "2U2D",
        "2U2L",
        "2U2R",
        "2U21",
        "2U22",
        "2U23",
        "2U24",
        "2U3U",
        "2U3D",
        "2U3L",
        "2U3R",
        "2U31",
        "2U32",
        "2U33",
        "2U34",
        "2U4U",
        "2U4D",
        "2U4L",
        "2U4R",
        "2U41",
        "2U42",
        "2U43",
        "2U44",
        "2DLU",
        "2DLD",
        "2DL1",
        "2DL2",
        "2DL3",
        "2DL4",
        "2DRU",
        "2DRD",
        "2DR1",
        "2DR2",
        "2DR3",
        "2DR4",
        "2D1U",
        "2D1D",
        "2D1L",
        "2D1R",
        "2D11",
        "2D12",
        "2D13",
        "2D14",
        "2D2U",
        "2D2D",
        "2D2L",
        "2D2R",
        "2D21",
        "2D22",
        "2D23",
        "2D24",
        "2D3U",
        "2D3D",
        "2D3L",
        "2D3R",
        "2D31",
        "2D32",
        "2D33",
        "2D34",
        "2D4U",
        "2D4D",
        "2D4L",
        "2D4R",
        "2D41",
        "2D42",
        "2D43",
        "2D44",
        "2LUL",
        "2LUR",
        "2LU1",
        "2LU2",
        "2LU3",
        "2LU4",
        "2LDL",
        "2LDR",
        "2LD1",
        "2LD2",
        "2LD3",
        "2LD4",
        "2L1U",
        "2L1D",
        "2L1L",
        "2L1R",
        "2L11",
        "2L12",
        "2L13",
        "2L14",
        "2L2U",
        "2L2D",
        "2L2L",
        "2L2R",
        "2L21",
        "2L22",
        "2L23",
        "2L24",
        "2L3U",
        "2L3D",
        "2L3L",
        "2L3R",
        "2L31",
        "2L32",
        "2L33",
        "2L34",
        "2L4U",
        "2L4D",
        "2L4L",
        "2L4R",
        "2L41",
        "2L42",
        "2L43",
        "2L44",
        "2RUL",
        "2RUR",
        "2RU1",
        "2RU2",
        "2RU3",
        "2RU4",
        "2RDL",
        "2RDR",
        "2RD1",
        "2RD2",
        "2RD3",
        "2RD4",
        "2R1U",
        "2R1D",
        "2R1L",
        "2R1R",
        "2R11",
        "2R12",
        "2R13",
        "2R14",
        "2R2U",
        "2R2D",
        "2R2L",
        "2R2R",
        "2R21",
        "2R22",
        "2R23",
        "2R24",
        "2R3U",
        "2R3D",
        "2R3L",
        "2R3R",
        "2R31",
        "2R32",
        "2R33",
        "2R34",
        "2R4U",
        "2R4D",
        "2R4L",
        "2R4R",
        "2R41",
        "2R42",
        "2R43",
        "2R44",
        "21UL",
        "21UR",
        "21U1",
        "21U2",
        "21U3",
        "21U4",
        "21DL",
        "21DR",
        "21D1",
        "21D2",
        "21D3",
        "21D4",
        "21LU",
        "21LD",
        "21L1",
        "21L2",
        "21L3",
        "21L4",
        "21RU",
        "21RD",
        "21R1",
        "21R2",
        "21R3",
        "21R4",
        "211U",
        "211D",
        "211L",
        "211R",
        "2111",
        "2112",
        "2113",
        "2114",
        "212U",
        "212D",
        "212L",
        "212R",
        "2121",
        "2122",
        "2123",
        "2124",
        "213U",
        "213D",
        "213L",
        "213R",
        "2131",
        "2132",
        "2133",
        "2134",
        "214U",
        "214D",
        "214L",
        "214R",
        "2141",
        "2142",
        "2143",
        "2144",
        "22UL",
        "22UR",
        "22U1",
        "22U2",
        "22U3",
        "22U4",
        "22DL",
        "22DR",
        "22D1",
        "22D2",
        "22D3",
        "22D4",
        "22LU",
        "22LD",
        "22L1",
        "22L2",
        "22L3",
        "22L4",
        "22RU",
        "22RD",
        "22R1",
        "22R2",
        "22R3",
        "22R4",
        "221U",
        "221D",
        "221L",
        "221R",
        "2211",
        "2212",
        "2213",
        "2214",
        "222U",
        "222D",
        "222L",
        "222R",
        "2221",
        "2222",
        "2223",
        "2224",
        "223U",
        "223D",
        "223L",
        "223R",
        "2231",
        "2232",
        "2233",
        "2234",
        "224U",
        "224D",
        "224L",
        "224R",
        "2241",
        "2242",
        "2243",
        "2244",
        "23UL",
        "23UR",
        "23U1",
        "23U2",
        "23U3",
        "23U4",
        "23DL",
        "23DR",
        "23D1",
        "23D2",
        "23D3",
        "23D4",
        "23LU",
        "23LD",
        "23L1",
        "23L2",
        "23L3",
        "23L4",
        "23RU",
        "23RD",
        "23R1",
        "23R2",
        "23R3",
        "23R4",
        "231U",
        "231D",
        "231L",
        "231R",
        "2311",
        "2312",
        "2313",
        "2314",
        "232U",
        "232D",
        "232L",
        "232R",
        "2321",
        "2322",
        "2323",
        "2324",
        "233U",
        "233D",
        "233L",
        "233R",
        "2331",
        "2332",
        "2333",
        "2334",
        "234U",
        "234D",
        "234L",
        "234R",
        "2341",
        "2342",
        "2343",
        "2344",
        "24UL",
        "24UR",
        "24U1",
        "24U2",
        "24U3",
        "24U4",
        "24DL",
        "24DR",
        "24D1",
        "24D2",
        "24D3",
        "24D4",
        "24LU",
        "24LD",
        "24L1",
        "24L2",
        "24L3",
        "24L4",
        "24RU",
        "24RD",
        "24R1",
        "24R2",
        "24R3",
        "24R4",
        "241U",
        "241D",
        "241L",
        "241R",
        "2411",
        "2412",
        "2413",
        "2414",
        "242U",
        "242D",
        "242L",
        "242R",
        "2421",
        "2422",
        "2423",
        "2424",
        "243U",
        "243D",
        "243L",
        "243R",
        "2431",
        "2432",
        "2433",
        "2434",
        "244U",
        "244D",
        "244L",
        "244R",
        "2441",
        "2442",
        "2443",
        "2444",
        "3ULU",
        "3ULD",
        "3UL1",
        "3UL2",
        "3UL3",
        "3UL4",
        "3URU",
        "3URD",
        "3UR1",
        "3UR2",
        "3UR3",
        "3UR4",
        "3U1U",
        "3U1D",
        "3U1L",
        "3U1R",
        "3U11",
        "3U12",
        "3U13",
        "3U14",
        "3U2U",
        "3U2D",
        "3U2L",
        "3U2R",
        "3U21",
        "3U22",
        "3U23",
        "3U24",
        "3U3U",
        "3U3D",
        "3U3L",
        "3U3R",
        "3U31",
        "3U32",
        "3U33",
        "3U34",
        "3U4U",
        "3U4D",
        "3U4L",
        "3U4R",
        "3U41",
        "3U42",
        "3U43",
        "3U44",
        "3DLU",
        "3DLD",
        "3DL1",
        "3DL2",
        "3DL3",
        "3DL4",
        "3DRU",
        "3DRD",
        "3DR1",
        "3DR2",
        "3DR3",
        "3DR4",
        "3D1U",
        "3D1D",
        "3D1L",
        "3D1R",
        "3D11",
        "3D12",
        "3D13",
        "3D14",
        "3D2U",
        "3D2D",
        "3D2L",
        "3D2R",
        "3D21",
        "3D22",
        "3D23",
        "3D24",
        "3D3U",
        "3D3D",
        "3D3L",
        "3D3R",
        "3D31",
        "3D32",
        "3D33",
        "3D34",
        "3D4U",
        "3D4D",
        "3D4L",
        "3D4R",
        "3D41",
        "3D42",
        "3D43",
        "3D44",
        "3LUL",
        "3LUR",
        "3LU1",
        "3LU2",
        "3LU3",
        "3LU4",
        "3LDL",
        "3LDR",
        "3LD1",
        "3LD2",
        "3LD3",
        "3LD4",
        "3L1U",
        "3L1D",
        "3L1L",
        "3L1R",
        "3L11",
        "3L12",
        "3L13",
        "3L14",
        "3L2U",
        "3L2D",
        "3L2L",
        "3L2R",
        "3L21",
        "3L22",
        "3L23",
        "3L24",
        "3L3U",
        "3L3D",
        "3L3L",
        "3L3R",
        "3L31",
        "3L32",
        "3L33",
        "3L34",
        "3L4U",
        "3L4D",
        "3L4L",
        "3L4R",
        "3L41",
        "3L42",
        "3L43",
        "3L44",
        "3RUL",
        "3RUR",
        "3RU1",
        "3RU2",
        "3RU3",
        "3RU4",
        "3RDL",
        "3RDR",
        "3RD1",
        "3RD2",
        "3RD3",
        "3RD4",
        "3R1U",
        "3R1D",
        "3R1L",
        "3R1R",
        "3R11",
        "3R12",
        "3R13",
        "3R14",
        "3R2U",
        "3R2D",
        "3R2L",
        "3R2R",
        "3R21",
        "3R22",
        "3R23",
        "3R24",
        "3R3U",
        "3R3D",
        "3R3L",
        "3R3R",
        "3R31",
        "3R32",
        "3R33",
        "3R34",
        "3R4U",
        "3R4D",
        "3R4L",
        "3R4R",
        "3R41",
        "3R42",
        "3R43",
        "3R44",
        "31UL",
        "31UR",
        "31U1",
        "31U2",
        "31U3",
        "31U4",
        "31DL",
        "31DR",
        "31D1",
        "31D2",
        "31D3",
        "31D4",
        "31LU",
        "31LD",
        "31L1",
        "31L2",
        "31L3",
        "31L4",
        "31RU",
        "31RD",
        "31R1",
        "31R2",
        "31R3",
        "31R4",
        "311U",
        "311D",
        "311L",
        "311R",
        "3111",
        "3112",
        "3113",
        "3114",
        "312U",
        "312D",
        "312L",
        "312R",
        "3121",
        "3122",
        "3123",
        "3124",
        "313U",
        "313D",
        "313L",
        "313R",
        "3131",
        "3132",
        "3133",
        "3134",
        "314U",
        "314D",
        "314L",
        "314R",
        "3141",
        "3142",
        "3143",
        "3144",
        "32UL",
        "32UR",
        "32U1",
        "32U2",
        "32U3",
        "32U4",
        "32DL",
        "32DR",
        "32D1",
        "32D2",
        "32D3",
        "32D4",
        "32LU",
        "32LD",
        "32L1",
        "32L2",
        "32L3",
        "32L4",
        "32RU",
        "32RD",
        "32R1",
        "32R2",
        "32R3",
        "32R4",
        "321U",
        "321D",
        "321L",
        "321R",
        "3211",
        "3212",
        "3213",
        "3214",
        "322U",
        "322D",
        "322L",
        "322R",
        "3221",
        "3222",
        "3223",
        "3224",
        "323U",
        "323D",
        "323L",
        "323R",
        "3231",
        "3232",
        "3233",
        "3234",
        "324U",
        "324D",
        "324L",
        "324R",
        "3241",
        "3242",
        "3243",
        "3244",
        "33UL",
        "33UR",
        "33U1",
        "33U2",
        "33U3",
        "33U4",
        "33DL",
        "33DR",
        "33D1",
        "33D2",
        "33D3",
        "33D4",
        "33LU",
        "33LD",
        "33L1",
        "33L2",
        "33L3",
        "33L4",
        "33RU",
        "33RD",
        "33R1",
        "33R2",
        "33R3",
        "33R4",
        "331U",
        "331D",
        "331L",
        "331R",
        "3311",
        "3312",
        "3313",
        "3314",
        "332U",
        "332D",
        "332L",
        "332R",
        "3321",
        "3322",
        "3323",
        "3324",
        "333U",
        "333D",
        "333L",
        "333R",
        "3331",
        "3332",
        "3333",
        "3334",
        "334U",
        "334D",
        "334L",
        "334R",
        "3341",
        "3342",
        "3343",
        "3344",
        "34UL",
        "34UR",
        "34U1",
        "34U2",
        "34U3",
        "34U4",
        "34DL",
        "34DR",
        "34D1",
        "34D2",
        "34D3",
        "34D4",
        "34LU",
        "34LD",
        "34L1",
        "34L2",
        "34L3",
        "34L4",
        "34RU",
        "34RD",
        "34R1",
        "34R2",
        "34R3",
        "34R4",
        "341U",
        "341D",
        "341L",
        "341R",
        "3411",
        "3412",
        "3413",
        "3414",
        "342U",
        "342D",
        "342L",
        "342R",
        "3421",
        "3422",
        "3423",
        "3424",
        "343U",
        "343D",
        "343L",
        "343R",
        "3431",
        "3432",
        "3433",
        "3434",
        "344U",
        "344D",
        "344L",
        "344R",
        "3441",
        "3442",
        "3443",
        "3444",
        "4ULU",
        "4ULD",
        "4UL1",
        "4UL2",
        "4UL3",
        "4UL4",
        "4URU",
        "4URD",
        "4UR1",
        "4UR2",
        "4UR3",
        "4UR4",
        "4U1U",
        "4U1D",
        "4U1L",
        "4U1R",
        "4U11",
        "4U12",
        "4U13",
        "4U14",
        "4U2U",
        "4U2D",
        "4U2L",
        "4U2R",
        "4U21",
        "4U22",
        "4U23",
        "4U24",
        "4U3U",
        "4U3D",
        "4U3L",
        "4U3R",
        "4U31",
        "4U32",
        "4U33",
        "4U34",
        "4U4U",
        "4U4D",
        "4U4L",
        "4U4R",
        "4U41",
        "4U42",
        "4U43",
        "4U44",
        "4DLU",
        "4DLD",
        "4DL1",
        "4DL2",
        "4DL3",
        "4DL4",
        "4DRU",
        "4DRD",
        "4DR1",
        "4DR2",
        "4DR3",
        "4DR4",
        "4D1U",
        "4D1D",
        "4D1L",
        "4D1R",
        "4D11",
        "4D12",
        "4D13",
        "4D14",
        "4D2U",
        "4D2D",
        "4D2L",
        "4D2R",
        "4D21",
        "4D22",
        "4D23",
        "4D24",
        "4D3U",
        "4D3D",
        "4D3L",
        "4D3R",
        "4D31",
        "4D32",
        "4D33",
        "4D34",
        "4D4U",
        "4D4D",
        "4D4L",
        "4D4R",
        "4D41",
        "4D42",
        "4D43",
        "4D44",
        "4LUL",
        "4LUR",
        "4LU1",
        "4LU2",
        "4LU3",
        "4LU4",
        "4LDL",
        "4LDR",
        "4LD1",
        "4LD2",
        "4LD3",
        "4LD4",
        "4L1U",
        "4L1D",
        "4L1L",
        "4L1R",
        "4L11",
        "4L12",
        "4L13",
        "4L14",
        "4L2U",
        "4L2D",
        "4L2L",
        "4L2R",
        "4L21",
        "4L22",
        "4L23",
        "4L24",
        "4L3U",
        "4L3D",
        "4L3L",
        "4L3R",
        "4L31",
        "4L32",
        "4L33",
        "4L34",
        "4L4U",
        "4L4D",
        "4L4L",
        "4L4R",
        "4L41",
        "4L42",
        "4L43",
        "4L44",
        "4RUL",
        "4RUR",
        "4RU1",
        "4RU2",
        "4RU3",
        "4RU4",
        "4RDL",
        "4RDR",
        "4RD1",
        "4RD2",
        "4RD3",
        "4RD4",
        "4R1U",
        "4R1D",
        "4R1L",
        "4R1R",
        "4R11",
        "4R12",
        "4R13",
        "4R14",
        "4R2U",
        "4R2D",
        "4R2L",
        "4R2R",
        "4R21",
        "4R22",
        "4R23",
        "4R24",
        "4R3U",
        "4R3D",
        "4R3L",
        "4R3R",
        "4R31",
        "4R32",
        "4R33",
        "4R34",
        "4R4U",
        "4R4D",
        "4R4L",
        "4R4R",
        "4R41",
        "4R42",
        "4R43",
        "4R44",
        "41UL",
        "41UR",
        "41U1",
        "41U2",
        "41U3",
        "41U4",
        "41DL",
        "41DR",
        "41D1",
        "41D2",
        "41D3",
        "41D4",
        "41LU",
        "41LD",
        "41L1",
        "41L2",
        "41L3",
        "41L4",
        "41RU",
        "41RD",
        "41R1",
        "41R2",
        "41R3",
        "41R4",
        "411U",
        "411D",
        "411L",
        "411R",
        "4111",
        "4112",
        "4113",
        "4114",
        "412U",
        "412D",
        "412L",
        "412R",
        "4121",
        "4122",
        "4123",
        "4124",
        "413U",
        "413D",
        "413L",
        "413R",
        "4131",
        "4132",
        "4133",
        "4134",
        "414U",
        "414D",
        "414L",
        "414R",
        "4141",
        "4142",
        "4143",
        "4144",
        "42UL",
        "42UR",
        "42U1",
        "42U2",
        "42U3",
        "42U4",
        "42DL",
        "42DR",
        "42D1",
        "42D2",
        "42D3",
        "42D4",
        "42LU",
        "42LD",
        "42L1",
        "42L2",
        "42L3",
        "42L4",
        "42RU",
        "42RD",
        "42R1",
        "42R2",
        "42R3",
        "42R4",
        "421U",
        "421D",
        "421L",
        "421R",
        "4211",
        "4212",
        "4213",
        "4214",
        "422U",
        "422D",
        "422L",
        "422R",
        "4221",
        "4222",
        "4223",
        "4224",
        "423U",
        "423D",
        "423L",
        "423R",
        "4231",
        "4232",
        "4233",
        "4234",
        "424U",
        "424D",
        "424L",
        "424R",
        "4241",
        "4242",
        "4243",
        "4244",
        "43UL",
        "43UR",
        "43U1",
        "43U2",
        "43U3",
        "43U4",
        "43DL",
        "43DR",
        "43D1",
        "43D2",
        "43D3",
        "43D4",
        "43LU",
        "43LD",
        "43L1",
        "43L2",
        "43L3",
        "43L4",
        "43RU",
        "43RD",
        "43R1",
        "43R2",
        "43R3",
        "43R4",
        "431U",
        "431D",
        "431L",
        "431R",
        "4311",
        "4312",
        "4313",
        "4314",
        "432U",
        "432D",
        "432L",
        "432R",
        "4321",
        "4322",
        "4323",
        "4324",
        "433U",
        "433D",
        "433L",
        "433R",
        "4331",
        "4332",
        "4333",
        "4334",
        "434U",
        "434D",
        "434L",
        "434R",
        "4341",
        "4342",
        "4343",
        "4344",
        "44UL",
        "44UR",
        "44U1",
        "44U2",
        "44U3",
        "44U4",
        "44DL",
        "44DR",
        "44D1",
        "44D2",
        "44D3",
        "44D4",
        "44LU",
        "44LD",
        "44L1",
        "44L2",
        "44L3",
        "44L4",
        "44RU",
        "44RD",
        "44R1",
        "44R2",
        "44R3",
        "44R4",
        "441U",
        "441D",
        "441L",
        "441R",
        "4411",
        "4412",
        "4413",
        "4414",
        "442U",
        "442D",
        "442L",
        "442R",
        "4421",
        "4422",
        "4423",
        "4424",
        "443U",
        "443D",
        "443L",
        "443R",
        "4431",
        "4432",
        "4433",
        "4434",
        "444U",
        "444D",
        "444L",
        "444R",
        "4441",
        "4442",
        "4443",
        "4444",
    ]


def test_pinword_to_perm_mapping():
    assert PinWords.pinword_to_perm_mapping(0) == {"": Perm(())}
    assert PinWords.pinword_to_perm_mapping(1) == {
        "1": Perm((0,)),
        "2": Perm((0,)),
        "3": Perm((0,)),
        "4": Perm((0,)),
    }
    assert PinWords.pinword_to_perm_mapping(2) == {
        "1U": Perm((1, 0)),
        "1D": Perm((0, 1)),
        "1L": Perm((0, 1)),
        "1R": Perm((1, 0)),
        "11": Perm((0, 1)),
        "12": Perm((1, 0)),
        "13": Perm((0, 1)),
        "14": Perm((1, 0)),
        "2U": Perm((0, 1)),
        "2D": Perm((1, 0)),
        "2L": Perm((0, 1)),
        "2R": Perm((1, 0)),
        "21": Perm((0, 1)),
        "22": Perm((1, 0)),
        "23": Perm((0, 1)),
        "24": Perm((1, 0)),
        "3U": Perm((0, 1)),
        "3D": Perm((1, 0)),
        "3L": Perm((1, 0)),
        "3R": Perm((0, 1)),
        "31": Perm((0, 1)),
        "32": Perm((1, 0)),
        "33": Perm((0, 1)),
        "34": Perm((1, 0)),
        "4U": Perm((1, 0)),
        "4D": Perm((0, 1)),
        "4L": Perm((1, 0)),
        "4R": Perm((0, 1)),
        "41": Perm((0, 1)),
        "42": Perm((1, 0)),
        "43": Perm((0, 1)),
        "44": Perm((1, 0)),
    }
    assert PinWords.pinword_to_perm_mapping(3) == {
        "1UL": Perm((1, 2, 0)),
        "1UR": Perm((2, 0, 1)),
        "1U1": Perm((1, 0, 2)),
        "1U2": Perm((2, 1, 0)),
        "1U3": Perm((0, 2, 1)),
        "1U4": Perm((2, 1, 0)),
        "1DL": Perm((1, 0, 2)),
        "1DR": Perm((0, 2, 1)),
        "1D1": Perm((0, 1, 2)),
        "1D2": Perm((2, 0, 1)),
        "1D3": Perm((0, 1, 2)),
        "1D4": Perm((1, 2, 0)),
        "1LU": Perm((0, 2, 1)),
        "1LD": Perm((1, 0, 2)),
        "1L1": Perm((0, 1, 2)),
        "1L2": Perm((2, 0, 1)),
        "1L3": Perm((0, 1, 2)),
        "1L4": Perm((1, 2, 0)),
        "1RU": Perm((1, 2, 0)),
        "1RD": Perm((2, 0, 1)),
        "1R1": Perm((1, 0, 2)),
        "1R2": Perm((2, 1, 0)),
        "1R3": Perm((0, 2, 1)),
        "1R4": Perm((2, 1, 0)),
        "11U": Perm((0, 2, 1)),
        "11D": Perm((1, 0, 2)),
        "11L": Perm((1, 0, 2)),
        "11R": Perm((0, 2, 1)),
        "111": Perm((0, 1, 2)),
        "112": Perm((2, 0, 1)),
        "113": Perm((0, 1, 2)),
        "114": Perm((1, 2, 0)),
        "12U": Perm((1, 2, 0)),
        "12D": Perm((2, 0, 1)),
        "12L": Perm((1, 2, 0)),
        "12R": Perm((2, 0, 1)),
        "121": Perm((1, 0, 2)),
        "122": Perm((2, 1, 0)),
        "123": Perm((0, 2, 1)),
        "124": Perm((2, 1, 0)),
        "13U": Perm((0, 2, 1)),
        "13D": Perm((1, 0, 2)),
        "13L": Perm((1, 0, 2)),
        "13R": Perm((0, 2, 1)),
        "131": Perm((0, 1, 2)),
        "132": Perm((2, 0, 1)),
        "133": Perm((0, 1, 2)),
        "134": Perm((1, 2, 0)),
        "14U": Perm((1, 2, 0)),
        "14D": Perm((2, 0, 1)),
        "14L": Perm((1, 2, 0)),
        "14R": Perm((2, 0, 1)),
        "141": Perm((1, 0, 2)),
        "142": Perm((2, 1, 0)),
        "143": Perm((0, 2, 1)),
        "144": Perm((2, 1, 0)),
        "2UL": Perm((1, 0, 2)),
        "2UR": Perm((0, 2, 1)),
        "2U1": Perm((0, 1, 2)),
        "2U2": Perm((2, 0, 1)),
        "2U3": Perm((0, 1, 2)),
        "2U4": Perm((1, 2, 0)),
        "2DL": Perm((1, 2, 0)),
        "2DR": Perm((2, 0, 1)),
        "2D1": Perm((1, 0, 2)),
        "2D2": Perm((2, 1, 0)),
        "2D3": Perm((0, 2, 1)),
        "2D4": Perm((2, 1, 0)),
        "2LU": Perm((0, 2, 1)),
        "2LD": Perm((1, 0, 2)),
        "2L1": Perm((0, 1, 2)),
        "2L2": Perm((2, 0, 1)),
        "2L3": Perm((0, 1, 2)),
        "2L4": Perm((1, 2, 0)),
        "2RU": Perm((1, 2, 0)),
        "2RD": Perm((2, 0, 1)),
        "2R1": Perm((1, 0, 2)),
        "2R2": Perm((2, 1, 0)),
        "2R3": Perm((0, 2, 1)),
        "2R4": Perm((2, 1, 0)),
        "21U": Perm((0, 2, 1)),
        "21D": Perm((1, 0, 2)),
        "21L": Perm((1, 0, 2)),
        "21R": Perm((0, 2, 1)),
        "211": Perm((0, 1, 2)),
        "212": Perm((2, 0, 1)),
        "213": Perm((0, 1, 2)),
        "214": Perm((1, 2, 0)),
        "22U": Perm((1, 2, 0)),
        "22D": Perm((2, 0, 1)),
        "22L": Perm((1, 2, 0)),
        "22R": Perm((2, 0, 1)),
        "221": Perm((1, 0, 2)),
        "222": Perm((2, 1, 0)),
        "223": Perm((0, 2, 1)),
        "224": Perm((2, 1, 0)),
        "23U": Perm((0, 2, 1)),
        "23D": Perm((1, 0, 2)),
        "23L": Perm((1, 0, 2)),
        "23R": Perm((0, 2, 1)),
        "231": Perm((0, 1, 2)),
        "232": Perm((2, 0, 1)),
        "233": Perm((0, 1, 2)),
        "234": Perm((1, 2, 0)),
        "24U": Perm((1, 2, 0)),
        "24D": Perm((2, 0, 1)),
        "24L": Perm((1, 2, 0)),
        "24R": Perm((2, 0, 1)),
        "241": Perm((1, 0, 2)),
        "242": Perm((2, 1, 0)),
        "243": Perm((0, 2, 1)),
        "244": Perm((2, 1, 0)),
        "3UL": Perm((1, 0, 2)),
        "3UR": Perm((0, 2, 1)),
        "3U1": Perm((0, 1, 2)),
        "3U2": Perm((2, 0, 1)),
        "3U3": Perm((0, 1, 2)),
        "3U4": Perm((1, 2, 0)),
        "3DL": Perm((1, 2, 0)),
        "3DR": Perm((2, 0, 1)),
        "3D1": Perm((1, 0, 2)),
        "3D2": Perm((2, 1, 0)),
        "3D3": Perm((0, 2, 1)),
        "3D4": Perm((2, 1, 0)),
        "3LU": Perm((1, 2, 0)),
        "3LD": Perm((2, 0, 1)),
        "3L1": Perm((1, 0, 2)),
        "3L2": Perm((2, 1, 0)),
        "3L3": Perm((0, 2, 1)),
        "3L4": Perm((2, 1, 0)),
        "3RU": Perm((0, 2, 1)),
        "3RD": Perm((1, 0, 2)),
        "3R1": Perm((0, 1, 2)),
        "3R2": Perm((2, 0, 1)),
        "3R3": Perm((0, 1, 2)),
        "3R4": Perm((1, 2, 0)),
        "31U": Perm((0, 2, 1)),
        "31D": Perm((1, 0, 2)),
        "31L": Perm((1, 0, 2)),
        "31R": Perm((0, 2, 1)),
        "311": Perm((0, 1, 2)),
        "312": Perm((2, 0, 1)),
        "313": Perm((0, 1, 2)),
        "314": Perm((1, 2, 0)),
        "32U": Perm((1, 2, 0)),
        "32D": Perm((2, 0, 1)),
        "32L": Perm((1, 2, 0)),
        "32R": Perm((2, 0, 1)),
        "321": Perm((1, 0, 2)),
        "322": Perm((2, 1, 0)),
        "323": Perm((0, 2, 1)),
        "324": Perm((2, 1, 0)),
        "33U": Perm((0, 2, 1)),
        "33D": Perm((1, 0, 2)),
        "33L": Perm((1, 0, 2)),
        "33R": Perm((0, 2, 1)),
        "331": Perm((0, 1, 2)),
        "332": Perm((2, 0, 1)),
        "333": Perm((0, 1, 2)),
        "334": Perm((1, 2, 0)),
        "34U": Perm((1, 2, 0)),
        "34D": Perm((2, 0, 1)),
        "34L": Perm((1, 2, 0)),
        "34R": Perm((2, 0, 1)),
        "341": Perm((1, 0, 2)),
        "342": Perm((2, 1, 0)),
        "343": Perm((0, 2, 1)),
        "344": Perm((2, 1, 0)),
        "4UL": Perm((1, 2, 0)),
        "4UR": Perm((2, 0, 1)),
        "4U1": Perm((1, 0, 2)),
        "4U2": Perm((2, 1, 0)),
        "4U3": Perm((0, 2, 1)),
        "4U4": Perm((2, 1, 0)),
        "4DL": Perm((1, 0, 2)),
        "4DR": Perm((0, 2, 1)),
        "4D1": Perm((0, 1, 2)),
        "4D2": Perm((2, 0, 1)),
        "4D3": Perm((0, 1, 2)),
        "4D4": Perm((1, 2, 0)),
        "4LU": Perm((1, 2, 0)),
        "4LD": Perm((2, 0, 1)),
        "4L1": Perm((1, 0, 2)),
        "4L2": Perm((2, 1, 0)),
        "4L3": Perm((0, 2, 1)),
        "4L4": Perm((2, 1, 0)),
        "4RU": Perm((0, 2, 1)),
        "4RD": Perm((1, 0, 2)),
        "4R1": Perm((0, 1, 2)),
        "4R2": Perm((2, 0, 1)),
        "4R3": Perm((0, 1, 2)),
        "4R4": Perm((1, 2, 0)),
        "41U": Perm((0, 2, 1)),
        "41D": Perm((1, 0, 2)),
        "41L": Perm((1, 0, 2)),
        "41R": Perm((0, 2, 1)),
        "411": Perm((0, 1, 2)),
        "412": Perm((2, 0, 1)),
        "413": Perm((0, 1, 2)),
        "414": Perm((1, 2, 0)),
        "42U": Perm((1, 2, 0)),
        "42D": Perm((2, 0, 1)),
        "42L": Perm((1, 2, 0)),
        "42R": Perm((2, 0, 1)),
        "421": Perm((1, 0, 2)),
        "422": Perm((2, 1, 0)),
        "423": Perm((0, 2, 1)),
        "424": Perm((2, 1, 0)),
        "43U": Perm((0, 2, 1)),
        "43D": Perm((1, 0, 2)),
        "43L": Perm((1, 0, 2)),
        "43R": Perm((0, 2, 1)),
        "431": Perm((0, 1, 2)),
        "432": Perm((2, 0, 1)),
        "433": Perm((0, 1, 2)),
        "434": Perm((1, 2, 0)),
        "44U": Perm((1, 2, 0)),
        "44D": Perm((2, 0, 1)),
        "44L": Perm((1, 2, 0)),
        "44R": Perm((2, 0, 1)),
        "441": Perm((1, 0, 2)),
        "442": Perm((2, 1, 0)),
        "443": Perm((0, 2, 1)),
        "444": Perm((2, 1, 0)),
    }
    assert PinWords.pinword_to_perm_mapping(4) == {
        "1ULU": Perm((1, 3, 2, 0)),
        "1ULD": Perm((2, 0, 3, 1)),
        "1UL1": Perm((1, 2, 0, 3)),
        "1UL2": Perm((3, 1, 2, 0)),
        "1UL3": Perm((0, 2, 3, 1)),
        "1UL4": Perm((2, 3, 1, 0)),
        "1URU": Perm((2, 0, 3, 1)),
        "1URD": Perm((3, 1, 0, 2)),
        "1UR1": Perm((2, 0, 1, 3)),
        "1UR2": Perm((3, 2, 0, 1)),
        "1UR3": Perm((0, 3, 1, 2)),
        "1UR4": Perm((3, 1, 2, 0)),
        "1U1U": Perm((1, 0, 3, 2)),
        "1U1D": Perm((2, 1, 0, 3)),
        "1U1L": Perm((2, 1, 0, 3)),
        "1U1R": Perm((1, 0, 3, 2)),
        "1U11": Perm((1, 0, 2, 3)),
        "1U12": Perm((3, 1, 0, 2)),
        "1U13": Perm((0, 2, 1, 3)),
        "1U14": Perm((2, 1, 3, 0)),
        "1U2U": Perm((2, 3, 1, 0)),
        "1U2D": Perm((3, 0, 2, 1)),
        "1U2L": Perm((2, 3, 1, 0)),
        "1U2R": Perm((3, 1, 0, 2)),
        "1U21": Perm((2, 1, 0, 3)),
        "1U22": Perm((3, 2, 1, 0)),
        "1U23": Perm((0, 3, 2, 1)),
        "1U24": Perm((3, 2, 1, 0)),
        "1U3U": Perm((0, 3, 2, 1)),
        "1U3D": Perm((1, 0, 3, 2)),
        "1U3L": Perm((1, 0, 3, 2)),
        "1U3R": Perm((0, 3, 2, 1)),
        "1U31": Perm((0, 2, 1, 3)),
        "1U32": Perm((3, 0, 2, 1)),
        "1U33": Perm((0, 1, 3, 2)),
        "1U34": Perm((1, 3, 2, 0)),
        "1U4U": Perm((2, 1, 3, 0)),
        "1U4D": Perm((3, 2, 0, 1)),
        "1U4L": Perm((1, 3, 2, 0)),
        "1U4R": Perm((3, 2, 0, 1)),
        "1U41": Perm((2, 1, 0, 3)),
        "1U42": Perm((3, 2, 1, 0)),
        "1U43": Perm((0, 3, 2, 1)),
        "1U44": Perm((3, 2, 1, 0)),
        "1DLU": Perm((1, 3, 0, 2)),
        "1DLD": Perm((2, 0, 1, 3)),
        "1DL1": Perm((1, 0, 2, 3)),
        "1DL2": Perm((3, 1, 0, 2)),
        "1DL3": Perm((0, 2, 1, 3)),
        "1DL4": Perm((2, 1, 3, 0)),
        "1DRU": Perm((0, 2, 3, 1)),
        "1DRD": Perm((1, 3, 0, 2)),
        "1DR1": Perm((0, 2, 1, 3)),
        "1DR2": Perm((3, 0, 2, 1)),
        "1DR3": Perm((0, 1, 3, 2)),
        "1DR4": Perm((1, 3, 2, 0)),
        "1D1U": Perm((0, 1, 3, 2)),
        "1D1D": Perm((1, 2, 0, 3)),
        "1D1L": Perm((2, 0, 1, 3)),
        "1D1R": Perm((0, 1, 3, 2)),
        "1D11": Perm((0, 1, 2, 3)),
        "1D12": Perm((3, 0, 1, 2)),
        "1D13": Perm((0, 1, 2, 3)),
        "1D14": Perm((1, 2, 3, 0)),
        "1D2U": Perm((2, 3, 0, 1)),
        "1D2D": Perm((3, 0, 1, 2)),
        "1D2L": Perm((2, 3, 0, 1)),
        "1D2R": Perm((3, 0, 1, 2)),
        "1D21": Perm((2, 0, 1, 3)),
        "1D22": Perm((3, 2, 0, 1)),
        "1D23": Perm((0, 3, 1, 2)),
        "1D24": Perm((3, 1, 2, 0)),
        "1D3U": Perm((0, 3, 1, 2)),
        "1D3D": Perm((1, 0, 2, 3)),
        "1D3L": Perm((1, 0, 2, 3)),
        "1D3R": Perm((0, 2, 3, 1)),
        "1D31": Perm((0, 1, 2, 3)),
        "1D32": Perm((3, 0, 1, 2)),
        "1D33": Perm((0, 1, 2, 3)),
        "1D34": Perm((1, 2, 3, 0)),
        "1D4U": Perm((1, 2, 3, 0)),
        "1D4D": Perm((2, 3, 0, 1)),
        "1D4L": Perm((1, 2, 3, 0)),
        "1D4R": Perm((2, 3, 0, 1)),
        "1D41": Perm((1, 2, 0, 3)),
        "1D42": Perm((3, 1, 2, 0)),
        "1D43": Perm((0, 2, 3, 1)),
        "1D44": Perm((2, 3, 1, 0)),
        "1LUL": Perm((2, 0, 3, 1)),
        "1LUR": Perm((0, 3, 1, 2)),
        "1LU1": Perm((0, 2, 1, 3)),
        "1LU2": Perm((3, 0, 2, 1)),
        "1LU3": Perm((0, 1, 3, 2)),
        "1LU4": Perm((1, 3, 2, 0)),
        "1LDL": Perm((1, 2, 0, 3)),
        "1LDR": Perm((2, 0, 3, 1)),
        "1LD1": Perm((1, 0, 2, 3)),
        "1LD2": Perm((3, 1, 0, 2)),
        "1LD3": Perm((0, 2, 1, 3)),
        "1LD4": Perm((2, 1, 3, 0)),
        "1L1U": Perm((0, 1, 3, 2)),
        "1L1D": Perm((1, 2, 0, 3)),
        "1L1L": Perm((2, 0, 1, 3)),
        "1L1R": Perm((0, 1, 3, 2)),
        "1L11": Perm((0, 1, 2, 3)),
        "1L12": Perm((3, 0, 1, 2)),
        "1L13": Perm((0, 1, 2, 3)),
        "1L14": Perm((1, 2, 3, 0)),
        "1L2U": Perm((2, 3, 0, 1)),
        "1L2D": Perm((3, 0, 1, 2)),
        "1L2L": Perm((2, 3, 0, 1)),
        "1L2R": Perm((3, 0, 1, 2)),
        "1L21": Perm((2, 0, 1, 3)),
        "1L22": Perm((3, 2, 0, 1)),
        "1L23": Perm((0, 3, 1, 2)),
        "1L24": Perm((3, 1, 2, 0)),
        "1L3U": Perm((0, 3, 1, 2)),
        "1L3D": Perm((1, 0, 2, 3)),
        "1L3L": Perm((1, 0, 2, 3)),
        "1L3R": Perm((0, 2, 3, 1)),
        "1L31": Perm((0, 1, 2, 3)),
        "1L32": Perm((3, 0, 1, 2)),
        "1L33": Perm((0, 1, 2, 3)),
        "1L34": Perm((1, 2, 3, 0)),
        "1L4U": Perm((1, 2, 3, 0)),
        "1L4D": Perm((2, 3, 0, 1)),
        "1L4L": Perm((1, 2, 3, 0)),
        "1L4R": Perm((2, 3, 0, 1)),
        "1L41": Perm((1, 2, 0, 3)),
        "1L42": Perm((3, 1, 2, 0)),
        "1L43": Perm((0, 2, 3, 1)),
        "1L44": Perm((2, 3, 1, 0)),
        "1RUL": Perm((2, 1, 3, 0)),
        "1RUR": Perm((1, 3, 0, 2)),
        "1RU1": Perm((1, 2, 0, 3)),
        "1RU2": Perm((3, 1, 2, 0)),
        "1RU3": Perm((0, 2, 3, 1)),
        "1RU4": Perm((2, 3, 1, 0)),
        "1RDL": Perm((1, 3, 0, 2)),
        "1RDR": Perm((3, 0, 2, 1)),
        "1RD1": Perm((2, 0, 1, 3)),
        "1RD2": Perm((3, 2, 0, 1)),
        "1RD3": Perm((0, 3, 1, 2)),
        "1RD4": Perm((3, 1, 2, 0)),
        "1R1U": Perm((1, 0, 3, 2)),
        "1R1D": Perm((2, 1, 0, 3)),
        "1R1L": Perm((2, 1, 0, 3)),
        "1R1R": Perm((1, 0, 3, 2)),
        "1R11": Perm((1, 0, 2, 3)),
        "1R12": Perm((3, 1, 0, 2)),
        "1R13": Perm((0, 2, 1, 3)),
        "1R14": Perm((2, 1, 3, 0)),
        "1R2U": Perm((2, 3, 1, 0)),
        "1R2D": Perm((3, 0, 2, 1)),
        "1R2L": Perm((2, 3, 1, 0)),
        "1R2R": Perm((3, 1, 0, 2)),
        "1R21": Perm((2, 1, 0, 3)),
        "1R22": Perm((3, 2, 1, 0)),
        "1R23": Perm((0, 3, 2, 1)),
        "1R24": Perm((3, 2, 1, 0)),
        "1R3U": Perm((0, 3, 2, 1)),
        "1R3D": Perm((1, 0, 3, 2)),
        "1R3L": Perm((1, 0, 3, 2)),
        "1R3R": Perm((0, 3, 2, 1)),
        "1R31": Perm((0, 2, 1, 3)),
        "1R32": Perm((3, 0, 2, 1)),
        "1R33": Perm((0, 1, 3, 2)),
        "1R34": Perm((1, 3, 2, 0)),
        "1R4U": Perm((2, 1, 3, 0)),
        "1R4D": Perm((3, 2, 0, 1)),
        "1R4L": Perm((1, 3, 2, 0)),
        "1R4R": Perm((3, 2, 0, 1)),
        "1R41": Perm((2, 1, 0, 3)),
        "1R42": Perm((3, 2, 1, 0)),
        "1R43": Perm((0, 3, 2, 1)),
        "1R44": Perm((3, 2, 1, 0)),
        "11UL": Perm((2, 0, 3, 1)),
        "11UR": Perm((0, 3, 1, 2)),
        "11U1": Perm((0, 2, 1, 3)),
        "11U2": Perm((3, 0, 2, 1)),
        "11U3": Perm((0, 1, 3, 2)),
        "11U4": Perm((1, 3, 2, 0)),
        "11DL": Perm((1, 2, 0, 3)),
        "11DR": Perm((2, 0, 3, 1)),
        "11D1": Perm((1, 0, 2, 3)),
        "11D2": Perm((3, 1, 0, 2)),
        "11D3": Perm((0, 2, 1, 3)),
        "11D4": Perm((2, 1, 3, 0)),
        "11LU": Perm((1, 3, 0, 2)),
        "11LD": Perm((2, 0, 1, 3)),
        "11L1": Perm((1, 0, 2, 3)),
        "11L2": Perm((3, 1, 0, 2)),
        "11L3": Perm((0, 2, 1, 3)),
        "11L4": Perm((2, 1, 3, 0)),
        "11RU": Perm((0, 2, 3, 1)),
        "11RD": Perm((1, 3, 0, 2)),
        "11R1": Perm((0, 2, 1, 3)),
        "11R2": Perm((3, 0, 2, 1)),
        "11R3": Perm((0, 1, 3, 2)),
        "11R4": Perm((1, 3, 2, 0)),
        "111U": Perm((0, 1, 3, 2)),
        "111D": Perm((1, 2, 0, 3)),
        "111L": Perm((2, 0, 1, 3)),
        "111R": Perm((0, 1, 3, 2)),
        "1111": Perm((0, 1, 2, 3)),
        "1112": Perm((3, 0, 1, 2)),
        "1113": Perm((0, 1, 2, 3)),
        "1114": Perm((1, 2, 3, 0)),
        "112U": Perm((2, 3, 0, 1)),
        "112D": Perm((3, 0, 1, 2)),
        "112L": Perm((2, 3, 0, 1)),
        "112R": Perm((3, 0, 1, 2)),
        "1121": Perm((2, 0, 1, 3)),
        "1122": Perm((3, 2, 0, 1)),
        "1123": Perm((0, 3, 1, 2)),
        "1124": Perm((3, 1, 2, 0)),
        "113U": Perm((0, 3, 1, 2)),
        "113D": Perm((1, 0, 2, 3)),
        "113L": Perm((1, 0, 2, 3)),
        "113R": Perm((0, 2, 3, 1)),
        "1131": Perm((0, 1, 2, 3)),
        "1132": Perm((3, 0, 1, 2)),
        "1133": Perm((0, 1, 2, 3)),
        "1134": Perm((1, 2, 3, 0)),
        "114U": Perm((1, 2, 3, 0)),
        "114D": Perm((2, 3, 0, 1)),
        "114L": Perm((1, 2, 3, 0)),
        "114R": Perm((2, 3, 0, 1)),
        "1141": Perm((1, 2, 0, 3)),
        "1142": Perm((3, 1, 2, 0)),
        "1143": Perm((0, 2, 3, 1)),
        "1144": Perm((2, 3, 1, 0)),
        "12UL": Perm((2, 1, 3, 0)),
        "12UR": Perm((1, 3, 0, 2)),
        "12U1": Perm((1, 2, 0, 3)),
        "12U2": Perm((3, 1, 2, 0)),
        "12U3": Perm((0, 2, 3, 1)),
        "12U4": Perm((2, 3, 1, 0)),
        "12DL": Perm((1, 3, 0, 2)),
        "12DR": Perm((3, 0, 2, 1)),
        "12D1": Perm((2, 0, 1, 3)),
        "12D2": Perm((3, 2, 0, 1)),
        "12D3": Perm((0, 3, 1, 2)),
        "12D4": Perm((3, 1, 2, 0)),
        "12LU": Perm((1, 3, 2, 0)),
        "12LD": Perm((2, 0, 3, 1)),
        "12L1": Perm((1, 2, 0, 3)),
        "12L2": Perm((3, 1, 2, 0)),
        "12L3": Perm((0, 2, 3, 1)),
        "12L4": Perm((2, 3, 1, 0)),
        "12RU": Perm((2, 0, 3, 1)),
        "12RD": Perm((3, 1, 0, 2)),
        "12R1": Perm((2, 0, 1, 3)),
        "12R2": Perm((3, 2, 0, 1)),
        "12R3": Perm((0, 3, 1, 2)),
        "12R4": Perm((3, 1, 2, 0)),
        "121U": Perm((1, 0, 3, 2)),
        "121D": Perm((2, 1, 0, 3)),
        "121L": Perm((2, 1, 0, 3)),
        "121R": Perm((1, 0, 3, 2)),
        "1211": Perm((1, 0, 2, 3)),
        "1212": Perm((3, 1, 0, 2)),
        "1213": Perm((0, 2, 1, 3)),
        "1214": Perm((2, 1, 3, 0)),
        "122U": Perm((2, 3, 1, 0)),
        "122D": Perm((3, 0, 2, 1)),
        "122L": Perm((2, 3, 1, 0)),
        "122R": Perm((3, 1, 0, 2)),
        "1221": Perm((2, 1, 0, 3)),
        "1222": Perm((3, 2, 1, 0)),
        "1223": Perm((0, 3, 2, 1)),
        "1224": Perm((3, 2, 1, 0)),
        "123U": Perm((0, 3, 2, 1)),
        "123D": Perm((1, 0, 3, 2)),
        "123L": Perm((1, 0, 3, 2)),
        "123R": Perm((0, 3, 2, 1)),
        "1231": Perm((0, 2, 1, 3)),
        "1232": Perm((3, 0, 2, 1)),
        "1233": Perm((0, 1, 3, 2)),
        "1234": Perm((1, 3, 2, 0)),
        "124U": Perm((2, 1, 3, 0)),
        "124D": Perm((3, 2, 0, 1)),
        "124L": Perm((1, 3, 2, 0)),
        "124R": Perm((3, 2, 0, 1)),
        "1241": Perm((2, 1, 0, 3)),
        "1242": Perm((3, 2, 1, 0)),
        "1243": Perm((0, 3, 2, 1)),
        "1244": Perm((3, 2, 1, 0)),
        "13UL": Perm((2, 0, 3, 1)),
        "13UR": Perm((0, 3, 1, 2)),
        "13U1": Perm((0, 2, 1, 3)),
        "13U2": Perm((3, 0, 2, 1)),
        "13U3": Perm((0, 1, 3, 2)),
        "13U4": Perm((1, 3, 2, 0)),
        "13DL": Perm((1, 2, 0, 3)),
        "13DR": Perm((2, 0, 3, 1)),
        "13D1": Perm((1, 0, 2, 3)),
        "13D2": Perm((3, 1, 0, 2)),
        "13D3": Perm((0, 2, 1, 3)),
        "13D4": Perm((2, 1, 3, 0)),
        "13LU": Perm((1, 3, 0, 2)),
        "13LD": Perm((2, 0, 1, 3)),
        "13L1": Perm((1, 0, 2, 3)),
        "13L2": Perm((3, 1, 0, 2)),
        "13L3": Perm((0, 2, 1, 3)),
        "13L4": Perm((2, 1, 3, 0)),
        "13RU": Perm((0, 2, 3, 1)),
        "13RD": Perm((1, 3, 0, 2)),
        "13R1": Perm((0, 2, 1, 3)),
        "13R2": Perm((3, 0, 2, 1)),
        "13R3": Perm((0, 1, 3, 2)),
        "13R4": Perm((1, 3, 2, 0)),
        "131U": Perm((0, 1, 3, 2)),
        "131D": Perm((1, 2, 0, 3)),
        "131L": Perm((2, 0, 1, 3)),
        "131R": Perm((0, 1, 3, 2)),
        "1311": Perm((0, 1, 2, 3)),
        "1312": Perm((3, 0, 1, 2)),
        "1313": Perm((0, 1, 2, 3)),
        "1314": Perm((1, 2, 3, 0)),
        "132U": Perm((2, 3, 0, 1)),
        "132D": Perm((3, 0, 1, 2)),
        "132L": Perm((2, 3, 0, 1)),
        "132R": Perm((3, 0, 1, 2)),
        "1321": Perm((2, 0, 1, 3)),
        "1322": Perm((3, 2, 0, 1)),
        "1323": Perm((0, 3, 1, 2)),
        "1324": Perm((3, 1, 2, 0)),
        "133U": Perm((0, 3, 1, 2)),
        "133D": Perm((1, 0, 2, 3)),
        "133L": Perm((1, 0, 2, 3)),
        "133R": Perm((0, 2, 3, 1)),
        "1331": Perm((0, 1, 2, 3)),
        "1332": Perm((3, 0, 1, 2)),
        "1333": Perm((0, 1, 2, 3)),
        "1334": Perm((1, 2, 3, 0)),
        "134U": Perm((1, 2, 3, 0)),
        "134D": Perm((2, 3, 0, 1)),
        "134L": Perm((1, 2, 3, 0)),
        "134R": Perm((2, 3, 0, 1)),
        "1341": Perm((1, 2, 0, 3)),
        "1342": Perm((3, 1, 2, 0)),
        "1343": Perm((0, 2, 3, 1)),
        "1344": Perm((2, 3, 1, 0)),
        "14UL": Perm((2, 1, 3, 0)),
        "14UR": Perm((1, 3, 0, 2)),
        "14U1": Perm((1, 2, 0, 3)),
        "14U2": Perm((3, 1, 2, 0)),
        "14U3": Perm((0, 2, 3, 1)),
        "14U4": Perm((2, 3, 1, 0)),
        "14DL": Perm((1, 3, 0, 2)),
        "14DR": Perm((3, 0, 2, 1)),
        "14D1": Perm((2, 0, 1, 3)),
        "14D2": Perm((3, 2, 0, 1)),
        "14D3": Perm((0, 3, 1, 2)),
        "14D4": Perm((3, 1, 2, 0)),
        "14LU": Perm((1, 3, 2, 0)),
        "14LD": Perm((2, 0, 3, 1)),
        "14L1": Perm((1, 2, 0, 3)),
        "14L2": Perm((3, 1, 2, 0)),
        "14L3": Perm((0, 2, 3, 1)),
        "14L4": Perm((2, 3, 1, 0)),
        "14RU": Perm((2, 0, 3, 1)),
        "14RD": Perm((3, 1, 0, 2)),
        "14R1": Perm((2, 0, 1, 3)),
        "14R2": Perm((3, 2, 0, 1)),
        "14R3": Perm((0, 3, 1, 2)),
        "14R4": Perm((3, 1, 2, 0)),
        "141U": Perm((1, 0, 3, 2)),
        "141D": Perm((2, 1, 0, 3)),
        "141L": Perm((2, 1, 0, 3)),
        "141R": Perm((1, 0, 3, 2)),
        "1411": Perm((1, 0, 2, 3)),
        "1412": Perm((3, 1, 0, 2)),
        "1413": Perm((0, 2, 1, 3)),
        "1414": Perm((2, 1, 3, 0)),
        "142U": Perm((2, 3, 1, 0)),
        "142D": Perm((3, 0, 2, 1)),
        "142L": Perm((2, 3, 1, 0)),
        "142R": Perm((3, 1, 0, 2)),
        "1421": Perm((2, 1, 0, 3)),
        "1422": Perm((3, 2, 1, 0)),
        "1423": Perm((0, 3, 2, 1)),
        "1424": Perm((3, 2, 1, 0)),
        "143U": Perm((0, 3, 2, 1)),
        "143D": Perm((1, 0, 3, 2)),
        "143L": Perm((1, 0, 3, 2)),
        "143R": Perm((0, 3, 2, 1)),
        "1431": Perm((0, 2, 1, 3)),
        "1432": Perm((3, 0, 2, 1)),
        "1433": Perm((0, 1, 3, 2)),
        "1434": Perm((1, 3, 2, 0)),
        "144U": Perm((2, 1, 3, 0)),
        "144D": Perm((3, 2, 0, 1)),
        "144L": Perm((1, 3, 2, 0)),
        "144R": Perm((3, 2, 0, 1)),
        "1441": Perm((2, 1, 0, 3)),
        "1442": Perm((3, 2, 1, 0)),
        "1443": Perm((0, 3, 2, 1)),
        "1444": Perm((3, 2, 1, 0)),
        "2ULU": Perm((1, 3, 0, 2)),
        "2ULD": Perm((2, 0, 1, 3)),
        "2UL1": Perm((1, 0, 2, 3)),
        "2UL2": Perm((3, 1, 0, 2)),
        "2UL3": Perm((0, 2, 1, 3)),
        "2UL4": Perm((2, 1, 3, 0)),
        "2URU": Perm((0, 2, 3, 1)),
        "2URD": Perm((1, 3, 0, 2)),
        "2UR1": Perm((0, 2, 1, 3)),
        "2UR2": Perm((3, 0, 2, 1)),
        "2UR3": Perm((0, 1, 3, 2)),
        "2UR4": Perm((1, 3, 2, 0)),
        "2U1U": Perm((0, 1, 3, 2)),
        "2U1D": Perm((1, 2, 0, 3)),
        "2U1L": Perm((2, 0, 1, 3)),
        "2U1R": Perm((0, 1, 3, 2)),
        "2U11": Perm((0, 1, 2, 3)),
        "2U12": Perm((3, 0, 1, 2)),
        "2U13": Perm((0, 1, 2, 3)),
        "2U14": Perm((1, 2, 3, 0)),
        "2U2U": Perm((2, 3, 0, 1)),
        "2U2D": Perm((3, 0, 1, 2)),
        "2U2L": Perm((2, 3, 0, 1)),
        "2U2R": Perm((3, 0, 1, 2)),
        "2U21": Perm((2, 0, 1, 3)),
        "2U22": Perm((3, 2, 0, 1)),
        "2U23": Perm((0, 3, 1, 2)),
        "2U24": Perm((3, 1, 2, 0)),
        "2U3U": Perm((0, 3, 1, 2)),
        "2U3D": Perm((1, 0, 2, 3)),
        "2U3L": Perm((1, 0, 2, 3)),
        "2U3R": Perm((0, 2, 3, 1)),
        "2U31": Perm((0, 1, 2, 3)),
        "2U32": Perm((3, 0, 1, 2)),
        "2U33": Perm((0, 1, 2, 3)),
        "2U34": Perm((1, 2, 3, 0)),
        "2U4U": Perm((1, 2, 3, 0)),
        "2U4D": Perm((2, 3, 0, 1)),
        "2U4L": Perm((1, 2, 3, 0)),
        "2U4R": Perm((2, 3, 0, 1)),
        "2U41": Perm((1, 2, 0, 3)),
        "2U42": Perm((3, 1, 2, 0)),
        "2U43": Perm((0, 2, 3, 1)),
        "2U44": Perm((2, 3, 1, 0)),
        "2DLU": Perm((1, 3, 2, 0)),
        "2DLD": Perm((2, 0, 3, 1)),
        "2DL1": Perm((1, 2, 0, 3)),
        "2DL2": Perm((3, 1, 2, 0)),
        "2DL3": Perm((0, 2, 3, 1)),
        "2DL4": Perm((2, 3, 1, 0)),
        "2DRU": Perm((2, 0, 3, 1)),
        "2DRD": Perm((3, 1, 0, 2)),
        "2DR1": Perm((2, 0, 1, 3)),
        "2DR2": Perm((3, 2, 0, 1)),
        "2DR3": Perm((0, 3, 1, 2)),
        "2DR4": Perm((3, 1, 2, 0)),
        "2D1U": Perm((1, 0, 3, 2)),
        "2D1D": Perm((2, 1, 0, 3)),
        "2D1L": Perm((2, 1, 0, 3)),
        "2D1R": Perm((1, 0, 3, 2)),
        "2D11": Perm((1, 0, 2, 3)),
        "2D12": Perm((3, 1, 0, 2)),
        "2D13": Perm((0, 2, 1, 3)),
        "2D14": Perm((2, 1, 3, 0)),
        "2D2U": Perm((2, 3, 1, 0)),
        "2D2D": Perm((3, 0, 2, 1)),
        "2D2L": Perm((2, 3, 1, 0)),
        "2D2R": Perm((3, 1, 0, 2)),
        "2D21": Perm((2, 1, 0, 3)),
        "2D22": Perm((3, 2, 1, 0)),
        "2D23": Perm((0, 3, 2, 1)),
        "2D24": Perm((3, 2, 1, 0)),
        "2D3U": Perm((0, 3, 2, 1)),
        "2D3D": Perm((1, 0, 3, 2)),
        "2D3L": Perm((1, 0, 3, 2)),
        "2D3R": Perm((0, 3, 2, 1)),
        "2D31": Perm((0, 2, 1, 3)),
        "2D32": Perm((3, 0, 2, 1)),
        "2D33": Perm((0, 1, 3, 2)),
        "2D34": Perm((1, 3, 2, 0)),
        "2D4U": Perm((2, 1, 3, 0)),
        "2D4D": Perm((3, 2, 0, 1)),
        "2D4L": Perm((1, 3, 2, 0)),
        "2D4R": Perm((3, 2, 0, 1)),
        "2D41": Perm((2, 1, 0, 3)),
        "2D42": Perm((3, 2, 1, 0)),
        "2D43": Perm((0, 3, 2, 1)),
        "2D44": Perm((3, 2, 1, 0)),
        "2LUL": Perm((2, 0, 3, 1)),
        "2LUR": Perm((0, 3, 1, 2)),
        "2LU1": Perm((0, 2, 1, 3)),
        "2LU2": Perm((3, 0, 2, 1)),
        "2LU3": Perm((0, 1, 3, 2)),
        "2LU4": Perm((1, 3, 2, 0)),
        "2LDL": Perm((1, 2, 0, 3)),
        "2LDR": Perm((2, 0, 3, 1)),
        "2LD1": Perm((1, 0, 2, 3)),
        "2LD2": Perm((3, 1, 0, 2)),
        "2LD3": Perm((0, 2, 1, 3)),
        "2LD4": Perm((2, 1, 3, 0)),
        "2L1U": Perm((0, 1, 3, 2)),
        "2L1D": Perm((1, 2, 0, 3)),
        "2L1L": Perm((2, 0, 1, 3)),
        "2L1R": Perm((0, 1, 3, 2)),
        "2L11": Perm((0, 1, 2, 3)),
        "2L12": Perm((3, 0, 1, 2)),
        "2L13": Perm((0, 1, 2, 3)),
        "2L14": Perm((1, 2, 3, 0)),
        "2L2U": Perm((2, 3, 0, 1)),
        "2L2D": Perm((3, 0, 1, 2)),
        "2L2L": Perm((2, 3, 0, 1)),
        "2L2R": Perm((3, 0, 1, 2)),
        "2L21": Perm((2, 0, 1, 3)),
        "2L22": Perm((3, 2, 0, 1)),
        "2L23": Perm((0, 3, 1, 2)),
        "2L24": Perm((3, 1, 2, 0)),
        "2L3U": Perm((0, 3, 1, 2)),
        "2L3D": Perm((1, 0, 2, 3)),
        "2L3L": Perm((1, 0, 2, 3)),
        "2L3R": Perm((0, 2, 3, 1)),
        "2L31": Perm((0, 1, 2, 3)),
        "2L32": Perm((3, 0, 1, 2)),
        "2L33": Perm((0, 1, 2, 3)),
        "2L34": Perm((1, 2, 3, 0)),
        "2L4U": Perm((1, 2, 3, 0)),
        "2L4D": Perm((2, 3, 0, 1)),
        "2L4L": Perm((1, 2, 3, 0)),
        "2L4R": Perm((2, 3, 0, 1)),
        "2L41": Perm((1, 2, 0, 3)),
        "2L42": Perm((3, 1, 2, 0)),
        "2L43": Perm((0, 2, 3, 1)),
        "2L44": Perm((2, 3, 1, 0)),
        "2RUL": Perm((2, 1, 3, 0)),
        "2RUR": Perm((1, 3, 0, 2)),
        "2RU1": Perm((1, 2, 0, 3)),
        "2RU2": Perm((3, 1, 2, 0)),
        "2RU3": Perm((0, 2, 3, 1)),
        "2RU4": Perm((2, 3, 1, 0)),
        "2RDL": Perm((1, 3, 0, 2)),
        "2RDR": Perm((3, 0, 2, 1)),
        "2RD1": Perm((2, 0, 1, 3)),
        "2RD2": Perm((3, 2, 0, 1)),
        "2RD3": Perm((0, 3, 1, 2)),
        "2RD4": Perm((3, 1, 2, 0)),
        "2R1U": Perm((1, 0, 3, 2)),
        "2R1D": Perm((2, 1, 0, 3)),
        "2R1L": Perm((2, 1, 0, 3)),
        "2R1R": Perm((1, 0, 3, 2)),
        "2R11": Perm((1, 0, 2, 3)),
        "2R12": Perm((3, 1, 0, 2)),
        "2R13": Perm((0, 2, 1, 3)),
        "2R14": Perm((2, 1, 3, 0)),
        "2R2U": Perm((2, 3, 1, 0)),
        "2R2D": Perm((3, 0, 2, 1)),
        "2R2L": Perm((2, 3, 1, 0)),
        "2R2R": Perm((3, 1, 0, 2)),
        "2R21": Perm((2, 1, 0, 3)),
        "2R22": Perm((3, 2, 1, 0)),
        "2R23": Perm((0, 3, 2, 1)),
        "2R24": Perm((3, 2, 1, 0)),
        "2R3U": Perm((0, 3, 2, 1)),
        "2R3D": Perm((1, 0, 3, 2)),
        "2R3L": Perm((1, 0, 3, 2)),
        "2R3R": Perm((0, 3, 2, 1)),
        "2R31": Perm((0, 2, 1, 3)),
        "2R32": Perm((3, 0, 2, 1)),
        "2R33": Perm((0, 1, 3, 2)),
        "2R34": Perm((1, 3, 2, 0)),
        "2R4U": Perm((2, 1, 3, 0)),
        "2R4D": Perm((3, 2, 0, 1)),
        "2R4L": Perm((1, 3, 2, 0)),
        "2R4R": Perm((3, 2, 0, 1)),
        "2R41": Perm((2, 1, 0, 3)),
        "2R42": Perm((3, 2, 1, 0)),
        "2R43": Perm((0, 3, 2, 1)),
        "2R44": Perm((3, 2, 1, 0)),
        "21UL": Perm((2, 0, 3, 1)),
        "21UR": Perm((0, 3, 1, 2)),
        "21U1": Perm((0, 2, 1, 3)),
        "21U2": Perm((3, 0, 2, 1)),
        "21U3": Perm((0, 1, 3, 2)),
        "21U4": Perm((1, 3, 2, 0)),
        "21DL": Perm((1, 2, 0, 3)),
        "21DR": Perm((2, 0, 3, 1)),
        "21D1": Perm((1, 0, 2, 3)),
        "21D2": Perm((3, 1, 0, 2)),
        "21D3": Perm((0, 2, 1, 3)),
        "21D4": Perm((2, 1, 3, 0)),
        "21LU": Perm((1, 3, 0, 2)),
        "21LD": Perm((2, 0, 1, 3)),
        "21L1": Perm((1, 0, 2, 3)),
        "21L2": Perm((3, 1, 0, 2)),
        "21L3": Perm((0, 2, 1, 3)),
        "21L4": Perm((2, 1, 3, 0)),
        "21RU": Perm((0, 2, 3, 1)),
        "21RD": Perm((1, 3, 0, 2)),
        "21R1": Perm((0, 2, 1, 3)),
        "21R2": Perm((3, 0, 2, 1)),
        "21R3": Perm((0, 1, 3, 2)),
        "21R4": Perm((1, 3, 2, 0)),
        "211U": Perm((0, 1, 3, 2)),
        "211D": Perm((1, 2, 0, 3)),
        "211L": Perm((2, 0, 1, 3)),
        "211R": Perm((0, 1, 3, 2)),
        "2111": Perm((0, 1, 2, 3)),
        "2112": Perm((3, 0, 1, 2)),
        "2113": Perm((0, 1, 2, 3)),
        "2114": Perm((1, 2, 3, 0)),
        "212U": Perm((2, 3, 0, 1)),
        "212D": Perm((3, 0, 1, 2)),
        "212L": Perm((2, 3, 0, 1)),
        "212R": Perm((3, 0, 1, 2)),
        "2121": Perm((2, 0, 1, 3)),
        "2122": Perm((3, 2, 0, 1)),
        "2123": Perm((0, 3, 1, 2)),
        "2124": Perm((3, 1, 2, 0)),
        "213U": Perm((0, 3, 1, 2)),
        "213D": Perm((1, 0, 2, 3)),
        "213L": Perm((1, 0, 2, 3)),
        "213R": Perm((0, 2, 3, 1)),
        "2131": Perm((0, 1, 2, 3)),
        "2132": Perm((3, 0, 1, 2)),
        "2133": Perm((0, 1, 2, 3)),
        "2134": Perm((1, 2, 3, 0)),
        "214U": Perm((1, 2, 3, 0)),
        "214D": Perm((2, 3, 0, 1)),
        "214L": Perm((1, 2, 3, 0)),
        "214R": Perm((2, 3, 0, 1)),
        "2141": Perm((1, 2, 0, 3)),
        "2142": Perm((3, 1, 2, 0)),
        "2143": Perm((0, 2, 3, 1)),
        "2144": Perm((2, 3, 1, 0)),
        "22UL": Perm((2, 1, 3, 0)),
        "22UR": Perm((1, 3, 0, 2)),
        "22U1": Perm((1, 2, 0, 3)),
        "22U2": Perm((3, 1, 2, 0)),
        "22U3": Perm((0, 2, 3, 1)),
        "22U4": Perm((2, 3, 1, 0)),
        "22DL": Perm((1, 3, 0, 2)),
        "22DR": Perm((3, 0, 2, 1)),
        "22D1": Perm((2, 0, 1, 3)),
        "22D2": Perm((3, 2, 0, 1)),
        "22D3": Perm((0, 3, 1, 2)),
        "22D4": Perm((3, 1, 2, 0)),
        "22LU": Perm((1, 3, 2, 0)),
        "22LD": Perm((2, 0, 3, 1)),
        "22L1": Perm((1, 2, 0, 3)),
        "22L2": Perm((3, 1, 2, 0)),
        "22L3": Perm((0, 2, 3, 1)),
        "22L4": Perm((2, 3, 1, 0)),
        "22RU": Perm((2, 0, 3, 1)),
        "22RD": Perm((3, 1, 0, 2)),
        "22R1": Perm((2, 0, 1, 3)),
        "22R2": Perm((3, 2, 0, 1)),
        "22R3": Perm((0, 3, 1, 2)),
        "22R4": Perm((3, 1, 2, 0)),
        "221U": Perm((1, 0, 3, 2)),
        "221D": Perm((2, 1, 0, 3)),
        "221L": Perm((2, 1, 0, 3)),
        "221R": Perm((1, 0, 3, 2)),
        "2211": Perm((1, 0, 2, 3)),
        "2212": Perm((3, 1, 0, 2)),
        "2213": Perm((0, 2, 1, 3)),
        "2214": Perm((2, 1, 3, 0)),
        "222U": Perm((2, 3, 1, 0)),
        "222D": Perm((3, 0, 2, 1)),
        "222L": Perm((2, 3, 1, 0)),
        "222R": Perm((3, 1, 0, 2)),
        "2221": Perm((2, 1, 0, 3)),
        "2222": Perm((3, 2, 1, 0)),
        "2223": Perm((0, 3, 2, 1)),
        "2224": Perm((3, 2, 1, 0)),
        "223U": Perm((0, 3, 2, 1)),
        "223D": Perm((1, 0, 3, 2)),
        "223L": Perm((1, 0, 3, 2)),
        "223R": Perm((0, 3, 2, 1)),
        "2231": Perm((0, 2, 1, 3)),
        "2232": Perm((3, 0, 2, 1)),
        "2233": Perm((0, 1, 3, 2)),
        "2234": Perm((1, 3, 2, 0)),
        "224U": Perm((2, 1, 3, 0)),
        "224D": Perm((3, 2, 0, 1)),
        "224L": Perm((1, 3, 2, 0)),
        "224R": Perm((3, 2, 0, 1)),
        "2241": Perm((2, 1, 0, 3)),
        "2242": Perm((3, 2, 1, 0)),
        "2243": Perm((0, 3, 2, 1)),
        "2244": Perm((3, 2, 1, 0)),
        "23UL": Perm((2, 0, 3, 1)),
        "23UR": Perm((0, 3, 1, 2)),
        "23U1": Perm((0, 2, 1, 3)),
        "23U2": Perm((3, 0, 2, 1)),
        "23U3": Perm((0, 1, 3, 2)),
        "23U4": Perm((1, 3, 2, 0)),
        "23DL": Perm((1, 2, 0, 3)),
        "23DR": Perm((2, 0, 3, 1)),
        "23D1": Perm((1, 0, 2, 3)),
        "23D2": Perm((3, 1, 0, 2)),
        "23D3": Perm((0, 2, 1, 3)),
        "23D4": Perm((2, 1, 3, 0)),
        "23LU": Perm((1, 3, 0, 2)),
        "23LD": Perm((2, 0, 1, 3)),
        "23L1": Perm((1, 0, 2, 3)),
        "23L2": Perm((3, 1, 0, 2)),
        "23L3": Perm((0, 2, 1, 3)),
        "23L4": Perm((2, 1, 3, 0)),
        "23RU": Perm((0, 2, 3, 1)),
        "23RD": Perm((1, 3, 0, 2)),
        "23R1": Perm((0, 2, 1, 3)),
        "23R2": Perm((3, 0, 2, 1)),
        "23R3": Perm((0, 1, 3, 2)),
        "23R4": Perm((1, 3, 2, 0)),
        "231U": Perm((0, 1, 3, 2)),
        "231D": Perm((1, 2, 0, 3)),
        "231L": Perm((2, 0, 1, 3)),
        "231R": Perm((0, 1, 3, 2)),
        "2311": Perm((0, 1, 2, 3)),
        "2312": Perm((3, 0, 1, 2)),
        "2313": Perm((0, 1, 2, 3)),
        "2314": Perm((1, 2, 3, 0)),
        "232U": Perm((2, 3, 0, 1)),
        "232D": Perm((3, 0, 1, 2)),
        "232L": Perm((2, 3, 0, 1)),
        "232R": Perm((3, 0, 1, 2)),
        "2321": Perm((2, 0, 1, 3)),
        "2322": Perm((3, 2, 0, 1)),
        "2323": Perm((0, 3, 1, 2)),
        "2324": Perm((3, 1, 2, 0)),
        "233U": Perm((0, 3, 1, 2)),
        "233D": Perm((1, 0, 2, 3)),
        "233L": Perm((1, 0, 2, 3)),
        "233R": Perm((0, 2, 3, 1)),
        "2331": Perm((0, 1, 2, 3)),
        "2332": Perm((3, 0, 1, 2)),
        "2333": Perm((0, 1, 2, 3)),
        "2334": Perm((1, 2, 3, 0)),
        "234U": Perm((1, 2, 3, 0)),
        "234D": Perm((2, 3, 0, 1)),
        "234L": Perm((1, 2, 3, 0)),
        "234R": Perm((2, 3, 0, 1)),
        "2341": Perm((1, 2, 0, 3)),
        "2342": Perm((3, 1, 2, 0)),
        "2343": Perm((0, 2, 3, 1)),
        "2344": Perm((2, 3, 1, 0)),
        "24UL": Perm((2, 1, 3, 0)),
        "24UR": Perm((1, 3, 0, 2)),
        "24U1": Perm((1, 2, 0, 3)),
        "24U2": Perm((3, 1, 2, 0)),
        "24U3": Perm((0, 2, 3, 1)),
        "24U4": Perm((2, 3, 1, 0)),
        "24DL": Perm((1, 3, 0, 2)),
        "24DR": Perm((3, 0, 2, 1)),
        "24D1": Perm((2, 0, 1, 3)),
        "24D2": Perm((3, 2, 0, 1)),
        "24D3": Perm((0, 3, 1, 2)),
        "24D4": Perm((3, 1, 2, 0)),
        "24LU": Perm((1, 3, 2, 0)),
        "24LD": Perm((2, 0, 3, 1)),
        "24L1": Perm((1, 2, 0, 3)),
        "24L2": Perm((3, 1, 2, 0)),
        "24L3": Perm((0, 2, 3, 1)),
        "24L4": Perm((2, 3, 1, 0)),
        "24RU": Perm((2, 0, 3, 1)),
        "24RD": Perm((3, 1, 0, 2)),
        "24R1": Perm((2, 0, 1, 3)),
        "24R2": Perm((3, 2, 0, 1)),
        "24R3": Perm((0, 3, 1, 2)),
        "24R4": Perm((3, 1, 2, 0)),
        "241U": Perm((1, 0, 3, 2)),
        "241D": Perm((2, 1, 0, 3)),
        "241L": Perm((2, 1, 0, 3)),
        "241R": Perm((1, 0, 3, 2)),
        "2411": Perm((1, 0, 2, 3)),
        "2412": Perm((3, 1, 0, 2)),
        "2413": Perm((0, 2, 1, 3)),
        "2414": Perm((2, 1, 3, 0)),
        "242U": Perm((2, 3, 1, 0)),
        "242D": Perm((3, 0, 2, 1)),
        "242L": Perm((2, 3, 1, 0)),
        "242R": Perm((3, 1, 0, 2)),
        "2421": Perm((2, 1, 0, 3)),
        "2422": Perm((3, 2, 1, 0)),
        "2423": Perm((0, 3, 2, 1)),
        "2424": Perm((3, 2, 1, 0)),
        "243U": Perm((0, 3, 2, 1)),
        "243D": Perm((1, 0, 3, 2)),
        "243L": Perm((1, 0, 3, 2)),
        "243R": Perm((0, 3, 2, 1)),
        "2431": Perm((0, 2, 1, 3)),
        "2432": Perm((3, 0, 2, 1)),
        "2433": Perm((0, 1, 3, 2)),
        "2434": Perm((1, 3, 2, 0)),
        "244U": Perm((2, 1, 3, 0)),
        "244D": Perm((3, 2, 0, 1)),
        "244L": Perm((1, 3, 2, 0)),
        "244R": Perm((3, 2, 0, 1)),
        "2441": Perm((2, 1, 0, 3)),
        "2442": Perm((3, 2, 1, 0)),
        "2443": Perm((0, 3, 2, 1)),
        "2444": Perm((3, 2, 1, 0)),
        "3ULU": Perm((1, 3, 0, 2)),
        "3ULD": Perm((2, 0, 1, 3)),
        "3UL1": Perm((1, 0, 2, 3)),
        "3UL2": Perm((3, 1, 0, 2)),
        "3UL3": Perm((0, 2, 1, 3)),
        "3UL4": Perm((2, 1, 3, 0)),
        "3URU": Perm((0, 2, 3, 1)),
        "3URD": Perm((1, 3, 0, 2)),
        "3UR1": Perm((0, 2, 1, 3)),
        "3UR2": Perm((3, 0, 2, 1)),
        "3UR3": Perm((0, 1, 3, 2)),
        "3UR4": Perm((1, 3, 2, 0)),
        "3U1U": Perm((0, 1, 3, 2)),
        "3U1D": Perm((1, 2, 0, 3)),
        "3U1L": Perm((2, 0, 1, 3)),
        "3U1R": Perm((0, 1, 3, 2)),
        "3U11": Perm((0, 1, 2, 3)),
        "3U12": Perm((3, 0, 1, 2)),
        "3U13": Perm((0, 1, 2, 3)),
        "3U14": Perm((1, 2, 3, 0)),
        "3U2U": Perm((2, 3, 0, 1)),
        "3U2D": Perm((3, 0, 1, 2)),
        "3U2L": Perm((2, 3, 0, 1)),
        "3U2R": Perm((3, 0, 1, 2)),
        "3U21": Perm((2, 0, 1, 3)),
        "3U22": Perm((3, 2, 0, 1)),
        "3U23": Perm((0, 3, 1, 2)),
        "3U24": Perm((3, 1, 2, 0)),
        "3U3U": Perm((0, 3, 1, 2)),
        "3U3D": Perm((1, 0, 2, 3)),
        "3U3L": Perm((1, 0, 2, 3)),
        "3U3R": Perm((0, 2, 3, 1)),
        "3U31": Perm((0, 1, 2, 3)),
        "3U32": Perm((3, 0, 1, 2)),
        "3U33": Perm((0, 1, 2, 3)),
        "3U34": Perm((1, 2, 3, 0)),
        "3U4U": Perm((1, 2, 3, 0)),
        "3U4D": Perm((2, 3, 0, 1)),
        "3U4L": Perm((1, 2, 3, 0)),
        "3U4R": Perm((2, 3, 0, 1)),
        "3U41": Perm((1, 2, 0, 3)),
        "3U42": Perm((3, 1, 2, 0)),
        "3U43": Perm((0, 2, 3, 1)),
        "3U44": Perm((2, 3, 1, 0)),
        "3DLU": Perm((1, 3, 2, 0)),
        "3DLD": Perm((2, 0, 3, 1)),
        "3DL1": Perm((1, 2, 0, 3)),
        "3DL2": Perm((3, 1, 2, 0)),
        "3DL3": Perm((0, 2, 3, 1)),
        "3DL4": Perm((2, 3, 1, 0)),
        "3DRU": Perm((2, 0, 3, 1)),
        "3DRD": Perm((3, 1, 0, 2)),
        "3DR1": Perm((2, 0, 1, 3)),
        "3DR2": Perm((3, 2, 0, 1)),
        "3DR3": Perm((0, 3, 1, 2)),
        "3DR4": Perm((3, 1, 2, 0)),
        "3D1U": Perm((1, 0, 3, 2)),
        "3D1D": Perm((2, 1, 0, 3)),
        "3D1L": Perm((2, 1, 0, 3)),
        "3D1R": Perm((1, 0, 3, 2)),
        "3D11": Perm((1, 0, 2, 3)),
        "3D12": Perm((3, 1, 0, 2)),
        "3D13": Perm((0, 2, 1, 3)),
        "3D14": Perm((2, 1, 3, 0)),
        "3D2U": Perm((2, 3, 1, 0)),
        "3D2D": Perm((3, 0, 2, 1)),
        "3D2L": Perm((2, 3, 1, 0)),
        "3D2R": Perm((3, 1, 0, 2)),
        "3D21": Perm((2, 1, 0, 3)),
        "3D22": Perm((3, 2, 1, 0)),
        "3D23": Perm((0, 3, 2, 1)),
        "3D24": Perm((3, 2, 1, 0)),
        "3D3U": Perm((0, 3, 2, 1)),
        "3D3D": Perm((1, 0, 3, 2)),
        "3D3L": Perm((1, 0, 3, 2)),
        "3D3R": Perm((0, 3, 2, 1)),
        "3D31": Perm((0, 2, 1, 3)),
        "3D32": Perm((3, 0, 2, 1)),
        "3D33": Perm((0, 1, 3, 2)),
        "3D34": Perm((1, 3, 2, 0)),
        "3D4U": Perm((2, 1, 3, 0)),
        "3D4D": Perm((3, 2, 0, 1)),
        "3D4L": Perm((1, 3, 2, 0)),
        "3D4R": Perm((3, 2, 0, 1)),
        "3D41": Perm((2, 1, 0, 3)),
        "3D42": Perm((3, 2, 1, 0)),
        "3D43": Perm((0, 3, 2, 1)),
        "3D44": Perm((3, 2, 1, 0)),
        "3LUL": Perm((2, 1, 3, 0)),
        "3LUR": Perm((1, 3, 0, 2)),
        "3LU1": Perm((1, 2, 0, 3)),
        "3LU2": Perm((3, 1, 2, 0)),
        "3LU3": Perm((0, 2, 3, 1)),
        "3LU4": Perm((2, 3, 1, 0)),
        "3LDL": Perm((1, 3, 0, 2)),
        "3LDR": Perm((3, 0, 2, 1)),
        "3LD1": Perm((2, 0, 1, 3)),
        "3LD2": Perm((3, 2, 0, 1)),
        "3LD3": Perm((0, 3, 1, 2)),
        "3LD4": Perm((3, 1, 2, 0)),
        "3L1U": Perm((1, 0, 3, 2)),
        "3L1D": Perm((2, 1, 0, 3)),
        "3L1L": Perm((2, 1, 0, 3)),
        "3L1R": Perm((1, 0, 3, 2)),
        "3L11": Perm((1, 0, 2, 3)),
        "3L12": Perm((3, 1, 0, 2)),
        "3L13": Perm((0, 2, 1, 3)),
        "3L14": Perm((2, 1, 3, 0)),
        "3L2U": Perm((2, 3, 1, 0)),
        "3L2D": Perm((3, 0, 2, 1)),
        "3L2L": Perm((2, 3, 1, 0)),
        "3L2R": Perm((3, 1, 0, 2)),
        "3L21": Perm((2, 1, 0, 3)),
        "3L22": Perm((3, 2, 1, 0)),
        "3L23": Perm((0, 3, 2, 1)),
        "3L24": Perm((3, 2, 1, 0)),
        "3L3U": Perm((0, 3, 2, 1)),
        "3L3D": Perm((1, 0, 3, 2)),
        "3L3L": Perm((1, 0, 3, 2)),
        "3L3R": Perm((0, 3, 2, 1)),
        "3L31": Perm((0, 2, 1, 3)),
        "3L32": Perm((3, 0, 2, 1)),
        "3L33": Perm((0, 1, 3, 2)),
        "3L34": Perm((1, 3, 2, 0)),
        "3L4U": Perm((2, 1, 3, 0)),
        "3L4D": Perm((3, 2, 0, 1)),
        "3L4L": Perm((1, 3, 2, 0)),
        "3L4R": Perm((3, 2, 0, 1)),
        "3L41": Perm((2, 1, 0, 3)),
        "3L42": Perm((3, 2, 1, 0)),
        "3L43": Perm((0, 3, 2, 1)),
        "3L44": Perm((3, 2, 1, 0)),
        "3RUL": Perm((2, 0, 3, 1)),
        "3RUR": Perm((0, 3, 1, 2)),
        "3RU1": Perm((0, 2, 1, 3)),
        "3RU2": Perm((3, 0, 2, 1)),
        "3RU3": Perm((0, 1, 3, 2)),
        "3RU4": Perm((1, 3, 2, 0)),
        "3RDL": Perm((1, 2, 0, 3)),
        "3RDR": Perm((2, 0, 3, 1)),
        "3RD1": Perm((1, 0, 2, 3)),
        "3RD2": Perm((3, 1, 0, 2)),
        "3RD3": Perm((0, 2, 1, 3)),
        "3RD4": Perm((2, 1, 3, 0)),
        "3R1U": Perm((0, 1, 3, 2)),
        "3R1D": Perm((1, 2, 0, 3)),
        "3R1L": Perm((2, 0, 1, 3)),
        "3R1R": Perm((0, 1, 3, 2)),
        "3R11": Perm((0, 1, 2, 3)),
        "3R12": Perm((3, 0, 1, 2)),
        "3R13": Perm((0, 1, 2, 3)),
        "3R14": Perm((1, 2, 3, 0)),
        "3R2U": Perm((2, 3, 0, 1)),
        "3R2D": Perm((3, 0, 1, 2)),
        "3R2L": Perm((2, 3, 0, 1)),
        "3R2R": Perm((3, 0, 1, 2)),
        "3R21": Perm((2, 0, 1, 3)),
        "3R22": Perm((3, 2, 0, 1)),
        "3R23": Perm((0, 3, 1, 2)),
        "3R24": Perm((3, 1, 2, 0)),
        "3R3U": Perm((0, 3, 1, 2)),
        "3R3D": Perm((1, 0, 2, 3)),
        "3R3L": Perm((1, 0, 2, 3)),
        "3R3R": Perm((0, 2, 3, 1)),
        "3R31": Perm((0, 1, 2, 3)),
        "3R32": Perm((3, 0, 1, 2)),
        "3R33": Perm((0, 1, 2, 3)),
        "3R34": Perm((1, 2, 3, 0)),
        "3R4U": Perm((1, 2, 3, 0)),
        "3R4D": Perm((2, 3, 0, 1)),
        "3R4L": Perm((1, 2, 3, 0)),
        "3R4R": Perm((2, 3, 0, 1)),
        "3R41": Perm((1, 2, 0, 3)),
        "3R42": Perm((3, 1, 2, 0)),
        "3R43": Perm((0, 2, 3, 1)),
        "3R44": Perm((2, 3, 1, 0)),
        "31UL": Perm((2, 0, 3, 1)),
        "31UR": Perm((0, 3, 1, 2)),
        "31U1": Perm((0, 2, 1, 3)),
        "31U2": Perm((3, 0, 2, 1)),
        "31U3": Perm((0, 1, 3, 2)),
        "31U4": Perm((1, 3, 2, 0)),
        "31DL": Perm((1, 2, 0, 3)),
        "31DR": Perm((2, 0, 3, 1)),
        "31D1": Perm((1, 0, 2, 3)),
        "31D2": Perm((3, 1, 0, 2)),
        "31D3": Perm((0, 2, 1, 3)),
        "31D4": Perm((2, 1, 3, 0)),
        "31LU": Perm((1, 3, 0, 2)),
        "31LD": Perm((2, 0, 1, 3)),
        "31L1": Perm((1, 0, 2, 3)),
        "31L2": Perm((3, 1, 0, 2)),
        "31L3": Perm((0, 2, 1, 3)),
        "31L4": Perm((2, 1, 3, 0)),
        "31RU": Perm((0, 2, 3, 1)),
        "31RD": Perm((1, 3, 0, 2)),
        "31R1": Perm((0, 2, 1, 3)),
        "31R2": Perm((3, 0, 2, 1)),
        "31R3": Perm((0, 1, 3, 2)),
        "31R4": Perm((1, 3, 2, 0)),
        "311U": Perm((0, 1, 3, 2)),
        "311D": Perm((1, 2, 0, 3)),
        "311L": Perm((2, 0, 1, 3)),
        "311R": Perm((0, 1, 3, 2)),
        "3111": Perm((0, 1, 2, 3)),
        "3112": Perm((3, 0, 1, 2)),
        "3113": Perm((0, 1, 2, 3)),
        "3114": Perm((1, 2, 3, 0)),
        "312U": Perm((2, 3, 0, 1)),
        "312D": Perm((3, 0, 1, 2)),
        "312L": Perm((2, 3, 0, 1)),
        "312R": Perm((3, 0, 1, 2)),
        "3121": Perm((2, 0, 1, 3)),
        "3122": Perm((3, 2, 0, 1)),
        "3123": Perm((0, 3, 1, 2)),
        "3124": Perm((3, 1, 2, 0)),
        "313U": Perm((0, 3, 1, 2)),
        "313D": Perm((1, 0, 2, 3)),
        "313L": Perm((1, 0, 2, 3)),
        "313R": Perm((0, 2, 3, 1)),
        "3131": Perm((0, 1, 2, 3)),
        "3132": Perm((3, 0, 1, 2)),
        "3133": Perm((0, 1, 2, 3)),
        "3134": Perm((1, 2, 3, 0)),
        "314U": Perm((1, 2, 3, 0)),
        "314D": Perm((2, 3, 0, 1)),
        "314L": Perm((1, 2, 3, 0)),
        "314R": Perm((2, 3, 0, 1)),
        "3141": Perm((1, 2, 0, 3)),
        "3142": Perm((3, 1, 2, 0)),
        "3143": Perm((0, 2, 3, 1)),
        "3144": Perm((2, 3, 1, 0)),
        "32UL": Perm((2, 1, 3, 0)),
        "32UR": Perm((1, 3, 0, 2)),
        "32U1": Perm((1, 2, 0, 3)),
        "32U2": Perm((3, 1, 2, 0)),
        "32U3": Perm((0, 2, 3, 1)),
        "32U4": Perm((2, 3, 1, 0)),
        "32DL": Perm((1, 3, 0, 2)),
        "32DR": Perm((3, 0, 2, 1)),
        "32D1": Perm((2, 0, 1, 3)),
        "32D2": Perm((3, 2, 0, 1)),
        "32D3": Perm((0, 3, 1, 2)),
        "32D4": Perm((3, 1, 2, 0)),
        "32LU": Perm((1, 3, 2, 0)),
        "32LD": Perm((2, 0, 3, 1)),
        "32L1": Perm((1, 2, 0, 3)),
        "32L2": Perm((3, 1, 2, 0)),
        "32L3": Perm((0, 2, 3, 1)),
        "32L4": Perm((2, 3, 1, 0)),
        "32RU": Perm((2, 0, 3, 1)),
        "32RD": Perm((3, 1, 0, 2)),
        "32R1": Perm((2, 0, 1, 3)),
        "32R2": Perm((3, 2, 0, 1)),
        "32R3": Perm((0, 3, 1, 2)),
        "32R4": Perm((3, 1, 2, 0)),
        "321U": Perm((1, 0, 3, 2)),
        "321D": Perm((2, 1, 0, 3)),
        "321L": Perm((2, 1, 0, 3)),
        "321R": Perm((1, 0, 3, 2)),
        "3211": Perm((1, 0, 2, 3)),
        "3212": Perm((3, 1, 0, 2)),
        "3213": Perm((0, 2, 1, 3)),
        "3214": Perm((2, 1, 3, 0)),
        "322U": Perm((2, 3, 1, 0)),
        "322D": Perm((3, 0, 2, 1)),
        "322L": Perm((2, 3, 1, 0)),
        "322R": Perm((3, 1, 0, 2)),
        "3221": Perm((2, 1, 0, 3)),
        "3222": Perm((3, 2, 1, 0)),
        "3223": Perm((0, 3, 2, 1)),
        "3224": Perm((3, 2, 1, 0)),
        "323U": Perm((0, 3, 2, 1)),
        "323D": Perm((1, 0, 3, 2)),
        "323L": Perm((1, 0, 3, 2)),
        "323R": Perm((0, 3, 2, 1)),
        "3231": Perm((0, 2, 1, 3)),
        "3232": Perm((3, 0, 2, 1)),
        "3233": Perm((0, 1, 3, 2)),
        "3234": Perm((1, 3, 2, 0)),
        "324U": Perm((2, 1, 3, 0)),
        "324D": Perm((3, 2, 0, 1)),
        "324L": Perm((1, 3, 2, 0)),
        "324R": Perm((3, 2, 0, 1)),
        "3241": Perm((2, 1, 0, 3)),
        "3242": Perm((3, 2, 1, 0)),
        "3243": Perm((0, 3, 2, 1)),
        "3244": Perm((3, 2, 1, 0)),
        "33UL": Perm((2, 0, 3, 1)),
        "33UR": Perm((0, 3, 1, 2)),
        "33U1": Perm((0, 2, 1, 3)),
        "33U2": Perm((3, 0, 2, 1)),
        "33U3": Perm((0, 1, 3, 2)),
        "33U4": Perm((1, 3, 2, 0)),
        "33DL": Perm((1, 2, 0, 3)),
        "33DR": Perm((2, 0, 3, 1)),
        "33D1": Perm((1, 0, 2, 3)),
        "33D2": Perm((3, 1, 0, 2)),
        "33D3": Perm((0, 2, 1, 3)),
        "33D4": Perm((2, 1, 3, 0)),
        "33LU": Perm((1, 3, 0, 2)),
        "33LD": Perm((2, 0, 1, 3)),
        "33L1": Perm((1, 0, 2, 3)),
        "33L2": Perm((3, 1, 0, 2)),
        "33L3": Perm((0, 2, 1, 3)),
        "33L4": Perm((2, 1, 3, 0)),
        "33RU": Perm((0, 2, 3, 1)),
        "33RD": Perm((1, 3, 0, 2)),
        "33R1": Perm((0, 2, 1, 3)),
        "33R2": Perm((3, 0, 2, 1)),
        "33R3": Perm((0, 1, 3, 2)),
        "33R4": Perm((1, 3, 2, 0)),
        "331U": Perm((0, 1, 3, 2)),
        "331D": Perm((1, 2, 0, 3)),
        "331L": Perm((2, 0, 1, 3)),
        "331R": Perm((0, 1, 3, 2)),
        "3311": Perm((0, 1, 2, 3)),
        "3312": Perm((3, 0, 1, 2)),
        "3313": Perm((0, 1, 2, 3)),
        "3314": Perm((1, 2, 3, 0)),
        "332U": Perm((2, 3, 0, 1)),
        "332D": Perm((3, 0, 1, 2)),
        "332L": Perm((2, 3, 0, 1)),
        "332R": Perm((3, 0, 1, 2)),
        "3321": Perm((2, 0, 1, 3)),
        "3322": Perm((3, 2, 0, 1)),
        "3323": Perm((0, 3, 1, 2)),
        "3324": Perm((3, 1, 2, 0)),
        "333U": Perm((0, 3, 1, 2)),
        "333D": Perm((1, 0, 2, 3)),
        "333L": Perm((1, 0, 2, 3)),
        "333R": Perm((0, 2, 3, 1)),
        "3331": Perm((0, 1, 2, 3)),
        "3332": Perm((3, 0, 1, 2)),
        "3333": Perm((0, 1, 2, 3)),
        "3334": Perm((1, 2, 3, 0)),
        "334U": Perm((1, 2, 3, 0)),
        "334D": Perm((2, 3, 0, 1)),
        "334L": Perm((1, 2, 3, 0)),
        "334R": Perm((2, 3, 0, 1)),
        "3341": Perm((1, 2, 0, 3)),
        "3342": Perm((3, 1, 2, 0)),
        "3343": Perm((0, 2, 3, 1)),
        "3344": Perm((2, 3, 1, 0)),
        "34UL": Perm((2, 1, 3, 0)),
        "34UR": Perm((1, 3, 0, 2)),
        "34U1": Perm((1, 2, 0, 3)),
        "34U2": Perm((3, 1, 2, 0)),
        "34U3": Perm((0, 2, 3, 1)),
        "34U4": Perm((2, 3, 1, 0)),
        "34DL": Perm((1, 3, 0, 2)),
        "34DR": Perm((3, 0, 2, 1)),
        "34D1": Perm((2, 0, 1, 3)),
        "34D2": Perm((3, 2, 0, 1)),
        "34D3": Perm((0, 3, 1, 2)),
        "34D4": Perm((3, 1, 2, 0)),
        "34LU": Perm((1, 3, 2, 0)),
        "34LD": Perm((2, 0, 3, 1)),
        "34L1": Perm((1, 2, 0, 3)),
        "34L2": Perm((3, 1, 2, 0)),
        "34L3": Perm((0, 2, 3, 1)),
        "34L4": Perm((2, 3, 1, 0)),
        "34RU": Perm((2, 0, 3, 1)),
        "34RD": Perm((3, 1, 0, 2)),
        "34R1": Perm((2, 0, 1, 3)),
        "34R2": Perm((3, 2, 0, 1)),
        "34R3": Perm((0, 3, 1, 2)),
        "34R4": Perm((3, 1, 2, 0)),
        "341U": Perm((1, 0, 3, 2)),
        "341D": Perm((2, 1, 0, 3)),
        "341L": Perm((2, 1, 0, 3)),
        "341R": Perm((1, 0, 3, 2)),
        "3411": Perm((1, 0, 2, 3)),
        "3412": Perm((3, 1, 0, 2)),
        "3413": Perm((0, 2, 1, 3)),
        "3414": Perm((2, 1, 3, 0)),
        "342U": Perm((2, 3, 1, 0)),
        "342D": Perm((3, 0, 2, 1)),
        "342L": Perm((2, 3, 1, 0)),
        "342R": Perm((3, 1, 0, 2)),
        "3421": Perm((2, 1, 0, 3)),
        "3422": Perm((3, 2, 1, 0)),
        "3423": Perm((0, 3, 2, 1)),
        "3424": Perm((3, 2, 1, 0)),
        "343U": Perm((0, 3, 2, 1)),
        "343D": Perm((1, 0, 3, 2)),
        "343L": Perm((1, 0, 3, 2)),
        "343R": Perm((0, 3, 2, 1)),
        "3431": Perm((0, 2, 1, 3)),
        "3432": Perm((3, 0, 2, 1)),
        "3433": Perm((0, 1, 3, 2)),
        "3434": Perm((1, 3, 2, 0)),
        "344U": Perm((2, 1, 3, 0)),
        "344D": Perm((3, 2, 0, 1)),
        "344L": Perm((1, 3, 2, 0)),
        "344R": Perm((3, 2, 0, 1)),
        "3441": Perm((2, 1, 0, 3)),
        "3442": Perm((3, 2, 1, 0)),
        "3443": Perm((0, 3, 2, 1)),
        "3444": Perm((3, 2, 1, 0)),
        "4ULU": Perm((1, 3, 2, 0)),
        "4ULD": Perm((2, 0, 3, 1)),
        "4UL1": Perm((1, 2, 0, 3)),
        "4UL2": Perm((3, 1, 2, 0)),
        "4UL3": Perm((0, 2, 3, 1)),
        "4UL4": Perm((2, 3, 1, 0)),
        "4URU": Perm((2, 0, 3, 1)),
        "4URD": Perm((3, 1, 0, 2)),
        "4UR1": Perm((2, 0, 1, 3)),
        "4UR2": Perm((3, 2, 0, 1)),
        "4UR3": Perm((0, 3, 1, 2)),
        "4UR4": Perm((3, 1, 2, 0)),
        "4U1U": Perm((1, 0, 3, 2)),
        "4U1D": Perm((2, 1, 0, 3)),
        "4U1L": Perm((2, 1, 0, 3)),
        "4U1R": Perm((1, 0, 3, 2)),
        "4U11": Perm((1, 0, 2, 3)),
        "4U12": Perm((3, 1, 0, 2)),
        "4U13": Perm((0, 2, 1, 3)),
        "4U14": Perm((2, 1, 3, 0)),
        "4U2U": Perm((2, 3, 1, 0)),
        "4U2D": Perm((3, 0, 2, 1)),
        "4U2L": Perm((2, 3, 1, 0)),
        "4U2R": Perm((3, 1, 0, 2)),
        "4U21": Perm((2, 1, 0, 3)),
        "4U22": Perm((3, 2, 1, 0)),
        "4U23": Perm((0, 3, 2, 1)),
        "4U24": Perm((3, 2, 1, 0)),
        "4U3U": Perm((0, 3, 2, 1)),
        "4U3D": Perm((1, 0, 3, 2)),
        "4U3L": Perm((1, 0, 3, 2)),
        "4U3R": Perm((0, 3, 2, 1)),
        "4U31": Perm((0, 2, 1, 3)),
        "4U32": Perm((3, 0, 2, 1)),
        "4U33": Perm((0, 1, 3, 2)),
        "4U34": Perm((1, 3, 2, 0)),
        "4U4U": Perm((2, 1, 3, 0)),
        "4U4D": Perm((3, 2, 0, 1)),
        "4U4L": Perm((1, 3, 2, 0)),
        "4U4R": Perm((3, 2, 0, 1)),
        "4U41": Perm((2, 1, 0, 3)),
        "4U42": Perm((3, 2, 1, 0)),
        "4U43": Perm((0, 3, 2, 1)),
        "4U44": Perm((3, 2, 1, 0)),
        "4DLU": Perm((1, 3, 0, 2)),
        "4DLD": Perm((2, 0, 1, 3)),
        "4DL1": Perm((1, 0, 2, 3)),
        "4DL2": Perm((3, 1, 0, 2)),
        "4DL3": Perm((0, 2, 1, 3)),
        "4DL4": Perm((2, 1, 3, 0)),
        "4DRU": Perm((0, 2, 3, 1)),
        "4DRD": Perm((1, 3, 0, 2)),
        "4DR1": Perm((0, 2, 1, 3)),
        "4DR2": Perm((3, 0, 2, 1)),
        "4DR3": Perm((0, 1, 3, 2)),
        "4DR4": Perm((1, 3, 2, 0)),
        "4D1U": Perm((0, 1, 3, 2)),
        "4D1D": Perm((1, 2, 0, 3)),
        "4D1L": Perm((2, 0, 1, 3)),
        "4D1R": Perm((0, 1, 3, 2)),
        "4D11": Perm((0, 1, 2, 3)),
        "4D12": Perm((3, 0, 1, 2)),
        "4D13": Perm((0, 1, 2, 3)),
        "4D14": Perm((1, 2, 3, 0)),
        "4D2U": Perm((2, 3, 0, 1)),
        "4D2D": Perm((3, 0, 1, 2)),
        "4D2L": Perm((2, 3, 0, 1)),
        "4D2R": Perm((3, 0, 1, 2)),
        "4D21": Perm((2, 0, 1, 3)),
        "4D22": Perm((3, 2, 0, 1)),
        "4D23": Perm((0, 3, 1, 2)),
        "4D24": Perm((3, 1, 2, 0)),
        "4D3U": Perm((0, 3, 1, 2)),
        "4D3D": Perm((1, 0, 2, 3)),
        "4D3L": Perm((1, 0, 2, 3)),
        "4D3R": Perm((0, 2, 3, 1)),
        "4D31": Perm((0, 1, 2, 3)),
        "4D32": Perm((3, 0, 1, 2)),
        "4D33": Perm((0, 1, 2, 3)),
        "4D34": Perm((1, 2, 3, 0)),
        "4D4U": Perm((1, 2, 3, 0)),
        "4D4D": Perm((2, 3, 0, 1)),
        "4D4L": Perm((1, 2, 3, 0)),
        "4D4R": Perm((2, 3, 0, 1)),
        "4D41": Perm((1, 2, 0, 3)),
        "4D42": Perm((3, 1, 2, 0)),
        "4D43": Perm((0, 2, 3, 1)),
        "4D44": Perm((2, 3, 1, 0)),
        "4LUL": Perm((2, 1, 3, 0)),
        "4LUR": Perm((1, 3, 0, 2)),
        "4LU1": Perm((1, 2, 0, 3)),
        "4LU2": Perm((3, 1, 2, 0)),
        "4LU3": Perm((0, 2, 3, 1)),
        "4LU4": Perm((2, 3, 1, 0)),
        "4LDL": Perm((1, 3, 0, 2)),
        "4LDR": Perm((3, 0, 2, 1)),
        "4LD1": Perm((2, 0, 1, 3)),
        "4LD2": Perm((3, 2, 0, 1)),
        "4LD3": Perm((0, 3, 1, 2)),
        "4LD4": Perm((3, 1, 2, 0)),
        "4L1U": Perm((1, 0, 3, 2)),
        "4L1D": Perm((2, 1, 0, 3)),
        "4L1L": Perm((2, 1, 0, 3)),
        "4L1R": Perm((1, 0, 3, 2)),
        "4L11": Perm((1, 0, 2, 3)),
        "4L12": Perm((3, 1, 0, 2)),
        "4L13": Perm((0, 2, 1, 3)),
        "4L14": Perm((2, 1, 3, 0)),
        "4L2U": Perm((2, 3, 1, 0)),
        "4L2D": Perm((3, 0, 2, 1)),
        "4L2L": Perm((2, 3, 1, 0)),
        "4L2R": Perm((3, 1, 0, 2)),
        "4L21": Perm((2, 1, 0, 3)),
        "4L22": Perm((3, 2, 1, 0)),
        "4L23": Perm((0, 3, 2, 1)),
        "4L24": Perm((3, 2, 1, 0)),
        "4L3U": Perm((0, 3, 2, 1)),
        "4L3D": Perm((1, 0, 3, 2)),
        "4L3L": Perm((1, 0, 3, 2)),
        "4L3R": Perm((0, 3, 2, 1)),
        "4L31": Perm((0, 2, 1, 3)),
        "4L32": Perm((3, 0, 2, 1)),
        "4L33": Perm((0, 1, 3, 2)),
        "4L34": Perm((1, 3, 2, 0)),
        "4L4U": Perm((2, 1, 3, 0)),
        "4L4D": Perm((3, 2, 0, 1)),
        "4L4L": Perm((1, 3, 2, 0)),
        "4L4R": Perm((3, 2, 0, 1)),
        "4L41": Perm((2, 1, 0, 3)),
        "4L42": Perm((3, 2, 1, 0)),
        "4L43": Perm((0, 3, 2, 1)),
        "4L44": Perm((3, 2, 1, 0)),
        "4RUL": Perm((2, 0, 3, 1)),
        "4RUR": Perm((0, 3, 1, 2)),
        "4RU1": Perm((0, 2, 1, 3)),
        "4RU2": Perm((3, 0, 2, 1)),
        "4RU3": Perm((0, 1, 3, 2)),
        "4RU4": Perm((1, 3, 2, 0)),
        "4RDL": Perm((1, 2, 0, 3)),
        "4RDR": Perm((2, 0, 3, 1)),
        "4RD1": Perm((1, 0, 2, 3)),
        "4RD2": Perm((3, 1, 0, 2)),
        "4RD3": Perm((0, 2, 1, 3)),
        "4RD4": Perm((2, 1, 3, 0)),
        "4R1U": Perm((0, 1, 3, 2)),
        "4R1D": Perm((1, 2, 0, 3)),
        "4R1L": Perm((2, 0, 1, 3)),
        "4R1R": Perm((0, 1, 3, 2)),
        "4R11": Perm((0, 1, 2, 3)),
        "4R12": Perm((3, 0, 1, 2)),
        "4R13": Perm((0, 1, 2, 3)),
        "4R14": Perm((1, 2, 3, 0)),
        "4R2U": Perm((2, 3, 0, 1)),
        "4R2D": Perm((3, 0, 1, 2)),
        "4R2L": Perm((2, 3, 0, 1)),
        "4R2R": Perm((3, 0, 1, 2)),
        "4R21": Perm((2, 0, 1, 3)),
        "4R22": Perm((3, 2, 0, 1)),
        "4R23": Perm((0, 3, 1, 2)),
        "4R24": Perm((3, 1, 2, 0)),
        "4R3U": Perm((0, 3, 1, 2)),
        "4R3D": Perm((1, 0, 2, 3)),
        "4R3L": Perm((1, 0, 2, 3)),
        "4R3R": Perm((0, 2, 3, 1)),
        "4R31": Perm((0, 1, 2, 3)),
        "4R32": Perm((3, 0, 1, 2)),
        "4R33": Perm((0, 1, 2, 3)),
        "4R34": Perm((1, 2, 3, 0)),
        "4R4U": Perm((1, 2, 3, 0)),
        "4R4D": Perm((2, 3, 0, 1)),
        "4R4L": Perm((1, 2, 3, 0)),
        "4R4R": Perm((2, 3, 0, 1)),
        "4R41": Perm((1, 2, 0, 3)),
        "4R42": Perm((3, 1, 2, 0)),
        "4R43": Perm((0, 2, 3, 1)),
        "4R44": Perm((2, 3, 1, 0)),
        "41UL": Perm((2, 0, 3, 1)),
        "41UR": Perm((0, 3, 1, 2)),
        "41U1": Perm((0, 2, 1, 3)),
        "41U2": Perm((3, 0, 2, 1)),
        "41U3": Perm((0, 1, 3, 2)),
        "41U4": Perm((1, 3, 2, 0)),
        "41DL": Perm((1, 2, 0, 3)),
        "41DR": Perm((2, 0, 3, 1)),
        "41D1": Perm((1, 0, 2, 3)),
        "41D2": Perm((3, 1, 0, 2)),
        "41D3": Perm((0, 2, 1, 3)),
        "41D4": Perm((2, 1, 3, 0)),
        "41LU": Perm((1, 3, 0, 2)),
        "41LD": Perm((2, 0, 1, 3)),
        "41L1": Perm((1, 0, 2, 3)),
        "41L2": Perm((3, 1, 0, 2)),
        "41L3": Perm((0, 2, 1, 3)),
        "41L4": Perm((2, 1, 3, 0)),
        "41RU": Perm((0, 2, 3, 1)),
        "41RD": Perm((1, 3, 0, 2)),
        "41R1": Perm((0, 2, 1, 3)),
        "41R2": Perm((3, 0, 2, 1)),
        "41R3": Perm((0, 1, 3, 2)),
        "41R4": Perm((1, 3, 2, 0)),
        "411U": Perm((0, 1, 3, 2)),
        "411D": Perm((1, 2, 0, 3)),
        "411L": Perm((2, 0, 1, 3)),
        "411R": Perm((0, 1, 3, 2)),
        "4111": Perm((0, 1, 2, 3)),
        "4112": Perm((3, 0, 1, 2)),
        "4113": Perm((0, 1, 2, 3)),
        "4114": Perm((1, 2, 3, 0)),
        "412U": Perm((2, 3, 0, 1)),
        "412D": Perm((3, 0, 1, 2)),
        "412L": Perm((2, 3, 0, 1)),
        "412R": Perm((3, 0, 1, 2)),
        "4121": Perm((2, 0, 1, 3)),
        "4122": Perm((3, 2, 0, 1)),
        "4123": Perm((0, 3, 1, 2)),
        "4124": Perm((3, 1, 2, 0)),
        "413U": Perm((0, 3, 1, 2)),
        "413D": Perm((1, 0, 2, 3)),
        "413L": Perm((1, 0, 2, 3)),
        "413R": Perm((0, 2, 3, 1)),
        "4131": Perm((0, 1, 2, 3)),
        "4132": Perm((3, 0, 1, 2)),
        "4133": Perm((0, 1, 2, 3)),
        "4134": Perm((1, 2, 3, 0)),
        "414U": Perm((1, 2, 3, 0)),
        "414D": Perm((2, 3, 0, 1)),
        "414L": Perm((1, 2, 3, 0)),
        "414R": Perm((2, 3, 0, 1)),
        "4141": Perm((1, 2, 0, 3)),
        "4142": Perm((3, 1, 2, 0)),
        "4143": Perm((0, 2, 3, 1)),
        "4144": Perm((2, 3, 1, 0)),
        "42UL": Perm((2, 1, 3, 0)),
        "42UR": Perm((1, 3, 0, 2)),
        "42U1": Perm((1, 2, 0, 3)),
        "42U2": Perm((3, 1, 2, 0)),
        "42U3": Perm((0, 2, 3, 1)),
        "42U4": Perm((2, 3, 1, 0)),
        "42DL": Perm((1, 3, 0, 2)),
        "42DR": Perm((3, 0, 2, 1)),
        "42D1": Perm((2, 0, 1, 3)),
        "42D2": Perm((3, 2, 0, 1)),
        "42D3": Perm((0, 3, 1, 2)),
        "42D4": Perm((3, 1, 2, 0)),
        "42LU": Perm((1, 3, 2, 0)),
        "42LD": Perm((2, 0, 3, 1)),
        "42L1": Perm((1, 2, 0, 3)),
        "42L2": Perm((3, 1, 2, 0)),
        "42L3": Perm((0, 2, 3, 1)),
        "42L4": Perm((2, 3, 1, 0)),
        "42RU": Perm((2, 0, 3, 1)),
        "42RD": Perm((3, 1, 0, 2)),
        "42R1": Perm((2, 0, 1, 3)),
        "42R2": Perm((3, 2, 0, 1)),
        "42R3": Perm((0, 3, 1, 2)),
        "42R4": Perm((3, 1, 2, 0)),
        "421U": Perm((1, 0, 3, 2)),
        "421D": Perm((2, 1, 0, 3)),
        "421L": Perm((2, 1, 0, 3)),
        "421R": Perm((1, 0, 3, 2)),
        "4211": Perm((1, 0, 2, 3)),
        "4212": Perm((3, 1, 0, 2)),
        "4213": Perm((0, 2, 1, 3)),
        "4214": Perm((2, 1, 3, 0)),
        "422U": Perm((2, 3, 1, 0)),
        "422D": Perm((3, 0, 2, 1)),
        "422L": Perm((2, 3, 1, 0)),
        "422R": Perm((3, 1, 0, 2)),
        "4221": Perm((2, 1, 0, 3)),
        "4222": Perm((3, 2, 1, 0)),
        "4223": Perm((0, 3, 2, 1)),
        "4224": Perm((3, 2, 1, 0)),
        "423U": Perm((0, 3, 2, 1)),
        "423D": Perm((1, 0, 3, 2)),
        "423L": Perm((1, 0, 3, 2)),
        "423R": Perm((0, 3, 2, 1)),
        "4231": Perm((0, 2, 1, 3)),
        "4232": Perm((3, 0, 2, 1)),
        "4233": Perm((0, 1, 3, 2)),
        "4234": Perm((1, 3, 2, 0)),
        "424U": Perm((2, 1, 3, 0)),
        "424D": Perm((3, 2, 0, 1)),
        "424L": Perm((1, 3, 2, 0)),
        "424R": Perm((3, 2, 0, 1)),
        "4241": Perm((2, 1, 0, 3)),
        "4242": Perm((3, 2, 1, 0)),
        "4243": Perm((0, 3, 2, 1)),
        "4244": Perm((3, 2, 1, 0)),
        "43UL": Perm((2, 0, 3, 1)),
        "43UR": Perm((0, 3, 1, 2)),
        "43U1": Perm((0, 2, 1, 3)),
        "43U2": Perm((3, 0, 2, 1)),
        "43U3": Perm((0, 1, 3, 2)),
        "43U4": Perm((1, 3, 2, 0)),
        "43DL": Perm((1, 2, 0, 3)),
        "43DR": Perm((2, 0, 3, 1)),
        "43D1": Perm((1, 0, 2, 3)),
        "43D2": Perm((3, 1, 0, 2)),
        "43D3": Perm((0, 2, 1, 3)),
        "43D4": Perm((2, 1, 3, 0)),
        "43LU": Perm((1, 3, 0, 2)),
        "43LD": Perm((2, 0, 1, 3)),
        "43L1": Perm((1, 0, 2, 3)),
        "43L2": Perm((3, 1, 0, 2)),
        "43L3": Perm((0, 2, 1, 3)),
        "43L4": Perm((2, 1, 3, 0)),
        "43RU": Perm((0, 2, 3, 1)),
        "43RD": Perm((1, 3, 0, 2)),
        "43R1": Perm((0, 2, 1, 3)),
        "43R2": Perm((3, 0, 2, 1)),
        "43R3": Perm((0, 1, 3, 2)),
        "43R4": Perm((1, 3, 2, 0)),
        "431U": Perm((0, 1, 3, 2)),
        "431D": Perm((1, 2, 0, 3)),
        "431L": Perm((2, 0, 1, 3)),
        "431R": Perm((0, 1, 3, 2)),
        "4311": Perm((0, 1, 2, 3)),
        "4312": Perm((3, 0, 1, 2)),
        "4313": Perm((0, 1, 2, 3)),
        "4314": Perm((1, 2, 3, 0)),
        "432U": Perm((2, 3, 0, 1)),
        "432D": Perm((3, 0, 1, 2)),
        "432L": Perm((2, 3, 0, 1)),
        "432R": Perm((3, 0, 1, 2)),
        "4321": Perm((2, 0, 1, 3)),
        "4322": Perm((3, 2, 0, 1)),
        "4323": Perm((0, 3, 1, 2)),
        "4324": Perm((3, 1, 2, 0)),
        "433U": Perm((0, 3, 1, 2)),
        "433D": Perm((1, 0, 2, 3)),
        "433L": Perm((1, 0, 2, 3)),
        "433R": Perm((0, 2, 3, 1)),
        "4331": Perm((0, 1, 2, 3)),
        "4332": Perm((3, 0, 1, 2)),
        "4333": Perm((0, 1, 2, 3)),
        "4334": Perm((1, 2, 3, 0)),
        "434U": Perm((1, 2, 3, 0)),
        "434D": Perm((2, 3, 0, 1)),
        "434L": Perm((1, 2, 3, 0)),
        "434R": Perm((2, 3, 0, 1)),
        "4341": Perm((1, 2, 0, 3)),
        "4342": Perm((3, 1, 2, 0)),
        "4343": Perm((0, 2, 3, 1)),
        "4344": Perm((2, 3, 1, 0)),
        "44UL": Perm((2, 1, 3, 0)),
        "44UR": Perm((1, 3, 0, 2)),
        "44U1": Perm((1, 2, 0, 3)),
        "44U2": Perm((3, 1, 2, 0)),
        "44U3": Perm((0, 2, 3, 1)),
        "44U4": Perm((2, 3, 1, 0)),
        "44DL": Perm((1, 3, 0, 2)),
        "44DR": Perm((3, 0, 2, 1)),
        "44D1": Perm((2, 0, 1, 3)),
        "44D2": Perm((3, 2, 0, 1)),
        "44D3": Perm((0, 3, 1, 2)),
        "44D4": Perm((3, 1, 2, 0)),
        "44LU": Perm((1, 3, 2, 0)),
        "44LD": Perm((2, 0, 3, 1)),
        "44L1": Perm((1, 2, 0, 3)),
        "44L2": Perm((3, 1, 2, 0)),
        "44L3": Perm((0, 2, 3, 1)),
        "44L4": Perm((2, 3, 1, 0)),
        "44RU": Perm((2, 0, 3, 1)),
        "44RD": Perm((3, 1, 0, 2)),
        "44R1": Perm((2, 0, 1, 3)),
        "44R2": Perm((3, 2, 0, 1)),
        "44R3": Perm((0, 3, 1, 2)),
        "44R4": Perm((3, 1, 2, 0)),
        "441U": Perm((1, 0, 3, 2)),
        "441D": Perm((2, 1, 0, 3)),
        "441L": Perm((2, 1, 0, 3)),
        "441R": Perm((1, 0, 3, 2)),
        "4411": Perm((1, 0, 2, 3)),
        "4412": Perm((3, 1, 0, 2)),
        "4413": Perm((0, 2, 1, 3)),
        "4414": Perm((2, 1, 3, 0)),
        "442U": Perm((2, 3, 1, 0)),
        "442D": Perm((3, 0, 2, 1)),
        "442L": Perm((2, 3, 1, 0)),
        "442R": Perm((3, 1, 0, 2)),
        "4421": Perm((2, 1, 0, 3)),
        "4422": Perm((3, 2, 1, 0)),
        "4423": Perm((0, 3, 2, 1)),
        "4424": Perm((3, 2, 1, 0)),
        "443U": Perm((0, 3, 2, 1)),
        "443D": Perm((1, 0, 3, 2)),
        "443L": Perm((1, 0, 3, 2)),
        "443R": Perm((0, 3, 2, 1)),
        "4431": Perm((0, 2, 1, 3)),
        "4432": Perm((3, 0, 2, 1)),
        "4433": Perm((0, 1, 3, 2)),
        "4434": Perm((1, 3, 2, 0)),
        "444U": Perm((2, 1, 3, 0)),
        "444D": Perm((3, 2, 0, 1)),
        "444L": Perm((1, 3, 2, 0)),
        "444R": Perm((3, 2, 0, 1)),
        "4441": Perm((2, 1, 0, 3)),
        "4442": Perm((3, 2, 1, 0)),
        "4443": Perm((0, 3, 2, 1)),
        "4444": Perm((3, 2, 1, 0)),
    }


def test_perm_to_pinword_mapping():
    assert PinWords.perm_to_pinword_mapping(0) == {Perm(()): {""}}
    assert PinWords.perm_to_pinword_mapping(1) == {Perm((0,)): {"1", "2", "3", "4"}}
    assert PinWords.perm_to_pinword_mapping(2) == {
        Perm((1, 0)): {
            "4L",
            "12",
            "24",
            "3L",
            "42",
            "2D",
            "34",
            "32",
            "44",
            "1U",
            "22",
            "2R",
            "4U",
            "14",
            "1R",
            "3D",
        },
        Perm((0, 1)): {
            "43",
            "23",
            "2U",
            "4R",
            "13",
            "3U",
            "3R",
            "11",
            "41",
            "21",
            "1D",
            "1L",
            "2L",
            "31",
            "33",
            "4D",
        },
    }
    assert PinWords.perm_to_pinword_mapping(3) == {
        Perm((1, 2, 0)): {
            "4LU",
            "44U",
            "14U",
            "12L",
            "2DL",
            "1RU",
            "14L",
            "1UL",
            "3DL",
            "4R4",
            "22L",
            "214",
            "114",
            "4D4",
            "32L",
            "32U",
            "34U",
            "22U",
            "12U",
            "24U",
            "3R4",
            "34L",
            "4UL",
            "234",
            "2U4",
            "434",
            "2L4",
            "1L4",
            "2RU",
            "414",
            "44L",
            "334",
            "42L",
            "24L",
            "3LU",
            "134",
            "42U",
            "3U4",
            "1D4",
            "314",
        },
        Perm((2, 0, 1)): {
            "24R",
            "32R",
            "4UR",
            "1L2",
            "1UR",
            "42D",
            "3R2",
            "42R",
            "2U2",
            "44D",
            "4LD",
            "132",
            "2L2",
            "312",
            "22D",
            "3DR",
            "232",
            "12D",
            "34D",
            "44R",
            "12R",
            "212",
            "432",
            "14R",
            "32D",
            "4D2",
            "332",
            "24D",
            "1D2",
            "34R",
            "412",
            "4R2",
            "112",
            "14D",
            "2RD",
            "1RD",
            "22R",
            "3LD",
            "3U2",
            "2DR",
        },
        Perm((1, 0, 2)): {
            "1DL",
            "1R1",
            "2D1",
            "13D",
            "3UL",
            "11D",
            "13L",
            "31D",
            "21D",
            "2LD",
            "2R1",
            "1LD",
            "241",
            "3RD",
            "43D",
            "321",
            "221",
            "43L",
            "3L1",
            "1U1",
            "33L",
            "23L",
            "4L1",
            "421",
            "31L",
            "121",
            "41L",
            "11L",
            "23D",
            "4RD",
            "441",
            "341",
            "21L",
            "3D1",
            "33D",
            "4U1",
            "2UL",
            "141",
            "41D",
            "4DL",
        },
        Perm((2, 1, 0)): {
            "322",
            "4L4",
            "424",
            "2R2",
            "422",
            "1U4",
            "124",
            "142",
            "344",
            "122",
            "4U2",
            "4L2",
            "3L2",
            "3D4",
            "1R2",
            "1R4",
            "244",
            "324",
            "342",
            "222",
            "442",
            "242",
            "3L4",
            "224",
            "2R4",
            "1U2",
            "4U4",
            "2D2",
            "144",
            "444",
            "2D4",
            "3D2",
        },
        Perm((0, 2, 1)): {
            "2LU",
            "143",
            "4DR",
            "41R",
            "41U",
            "423",
            "1R3",
            "33R",
            "43U",
            "2UR",
            "31R",
            "1LU",
            "243",
            "21R",
            "443",
            "31U",
            "123",
            "33U",
            "4RU",
            "23R",
            "343",
            "11R",
            "13R",
            "4U3",
            "2D3",
            "1DR",
            "323",
            "43R",
            "3UR",
            "13U",
            "3L3",
            "2R3",
            "21U",
            "3RU",
            "4L3",
            "3D3",
            "11U",
            "1U3",
            "223",
            "23U",
        },
        Perm((0, 1, 2)): {
            "4D3",
            "413",
            "4D1",
            "3U3",
            "2U1",
            "233",
            "231",
            "1L3",
            "111",
            "113",
            "213",
            "313",
            "4R3",
            "411",
            "3R3",
            "1D3",
            "431",
            "3U1",
            "3R1",
            "311",
            "433",
            "211",
            "131",
            "1D1",
            "4R1",
            "2L3",
            "333",
            "2L1",
            "331",
            "2U3",
            "133",
            "1L1",
        },
    }
    assert PinWords.perm_to_pinword_mapping(4) == {
        Perm((1, 3, 2, 0)): {
            "144L",
            "14LU",
            "13U4",
            "3D34",
            "2LU4",
            "24LU",
            "2DLU",
            "2R4L",
            "41U4",
            "33R4",
            "2D34",
            "2234",
            "34LU",
            "4ULU",
            "2D4L",
            "4U4L",
            "42LU",
            "11U4",
            "3UR4",
            "344L",
            "3D4L",
            "3L34",
            "33U4",
            "2434",
            "1U34",
            "21R4",
            "444L",
            "124L",
            "3434",
            "12LU",
            "4L34",
            "424L",
            "1234",
            "11R4",
            "224L",
            "4RU4",
            "4434",
            "1DR4",
            "244L",
            "3RU4",
            "31R4",
            "3L4L",
            "4L4L",
            "44LU",
            "43U4",
            "3234",
            "22LU",
            "4DR4",
            "21U4",
            "2UR4",
            "23U4",
            "2R34",
            "3DLU",
            "1ULU",
            "1R4L",
            "4234",
            "1U4L",
            "31U4",
            "324L",
            "41R4",
            "13R4",
            "1LU4",
            "1R34",
            "32LU",
            "4U34",
            "23R4",
            "43R4",
            "1434",
        },
        Perm((2, 0, 3, 1)): {
            "2LDR",
            "1LUL",
            "1ULD",
            "2LUL",
            "22RU",
            "21UL",
            "3DRU",
            "3RUL",
            "32RU",
            "42RU",
            "44RU",
            "1LDR",
            "32LD",
            "4RUL",
            "23UL",
            "2DRU",
            "33UL",
            "44LD",
            "31DR",
            "11UL",
            "4RDR",
            "41DR",
            "2DLD",
            "12LD",
            "14RU",
            "34RU",
            "3RDR",
            "1URU",
            "31UL",
            "42LD",
            "43DR",
            "21DR",
            "24LD",
            "22LD",
            "34LD",
            "12RU",
            "11DR",
            "23DR",
            "41UL",
            "13DR",
            "3DLD",
            "33DR",
            "14LD",
            "4ULD",
            "43UL",
            "24RU",
            "13UL",
            "4URU",
        },
        Perm((1, 2, 0, 3)): {
            "1D1D",
            "3DL1",
            "1LDL",
            "22U1",
            "3141",
            "42L1",
            "1L41",
            "1341",
            "2RU1",
            "24U1",
            "32L1",
            "3U1D",
            "4R1D",
            "1D41",
            "34L1",
            "23DL",
            "1L1D",
            "4341",
            "2L1D",
            "3RDL",
            "13DL",
            "2L41",
            "231D",
            "32U1",
            "331D",
            "44L1",
            "2341",
            "211D",
            "311D",
            "2DL1",
            "31DL",
            "1141",
            "21DL",
            "4D1D",
            "4D41",
            "4RDL",
            "3LU1",
            "2U41",
            "12U1",
            "3R41",
            "22L1",
            "33DL",
            "431D",
            "411D",
            "1UL1",
            "24L1",
            "2U1D",
            "2LDL",
            "3341",
            "4LU1",
            "43DL",
            "3U41",
            "3R1D",
            "34U1",
            "4R41",
            "4141",
            "12L1",
            "14U1",
            "111D",
            "2141",
            "42U1",
            "44U1",
            "14L1",
            "11DL",
            "41DL",
            "4UL1",
            "1RU1",
            "131D",
        },
        Perm((3, 1, 2, 0)): {
            "1UR4",
            "4124",
            "3R24",
            "42D4",
            "1L24",
            "2DR4",
            "12U2",
            "24D4",
            "14D4",
            "2RD4",
            "1L42",
            "14U2",
            "1RU2",
            "4324",
            "2DL2",
            "2142",
            "12L2",
            "3DR4",
            "2RU2",
            "4142",
            "24R4",
            "44D4",
            "3324",
            "1D24",
            "3LU2",
            "44U2",
            "3U24",
            "3LD4",
            "2324",
            "2L24",
            "2342",
            "42L2",
            "32D4",
            "34L2",
            "3R42",
            "2L42",
            "24U2",
            "42U2",
            "1342",
            "3124",
            "1RD4",
            "34D4",
            "34U2",
            "44R4",
            "3DL2",
            "2U24",
            "2U42",
            "22R4",
            "4342",
            "24L2",
            "3U42",
            "22L2",
            "32R4",
            "1D42",
            "1UL2",
            "3142",
            "4D24",
            "34R4",
            "32L2",
            "4UL2",
            "1142",
            "42R4",
            "44L2",
            "3342",
            "14L2",
            "12R4",
            "22D4",
            "12D4",
            "1124",
            "4R42",
            "14R4",
            "22U2",
            "1324",
            "4LU2",
            "4LD4",
            "2124",
            "32U2",
            "4UR4",
            "4D42",
            "4R24",
        },
        Perm((0, 2, 3, 1)): {
            "1L43",
            "1UL3",
            "4DRU",
            "3R3R",
            "34U3",
            "24U3",
            "2DL3",
            "23RU",
            "32L3",
            "4343",
            "41RU",
            "12U3",
            "12L3",
            "1343",
            "13RU",
            "2U3R",
            "31RU",
            "34L3",
            "2L3R",
            "22U3",
            "313R",
            "233R",
            "42U3",
            "1DRU",
            "14L3",
            "2U43",
            "4LU3",
            "3U3R",
            "413R",
            "433R",
            "3U43",
            "133R",
            "3URU",
            "333R",
            "4R43",
            "4143",
            "43RU",
            "2RU3",
            "113R",
            "2URU",
            "2L43",
            "3R43",
            "44U3",
            "3DL3",
            "11RU",
            "4D43",
            "2343",
            "3343",
            "32U3",
            "1L3R",
            "1D3R",
            "4UL3",
            "3143",
            "21RU",
            "1D43",
            "3LU3",
            "213R",
            "4D3R",
            "1RU3",
            "14U3",
            "44L3",
            "1143",
            "4R3R",
            "42L3",
            "22L3",
            "2143",
            "24L3",
            "33RU",
        },
        Perm((2, 3, 1, 0)): {
            "1344",
            "1U2U",
            "3U44",
            "32L4",
            "44U4",
            "1U2L",
            "22U4",
            "34L4",
            "342U",
            "322U",
            "3L2U",
            "4LU4",
            "2DL4",
            "3L2L",
            "2344",
            "4U2U",
            "3144",
            "142U",
            "1R2L",
            "44L4",
            "1144",
            "242U",
            "3DL4",
            "4UL4",
            "4D44",
            "2D2L",
            "4344",
            "442U",
            "12L4",
            "2144",
            "122L",
            "1D44",
            "1R2U",
            "2R2U",
            "2U44",
            "1UL4",
            "2R2L",
            "24U4",
            "4U2L",
            "3D2U",
            "322L",
            "422U",
            "4R44",
            "3D2L",
            "242L",
            "342L",
            "4L2U",
            "442L",
            "3LU4",
            "14L4",
            "24L4",
            "4144",
            "422L",
            "2D2U",
            "1RU4",
            "3R44",
            "42U4",
            "2L44",
            "42L4",
            "1L44",
            "14U4",
            "222U",
            "12U4",
            "32U4",
            "142L",
            "34U4",
            "22L4",
            "4L2L",
            "2RU4",
            "122U",
            "3344",
            "222L",
        },
        Perm((3, 1, 0, 2)): {
            "1R12",
            "142R",
            "1LD2",
            "322R",
            "4L12",
            "3D2R",
            "44RD",
            "21D2",
            "2212",
            "13L2",
            "3L2R",
            "3RD2",
            "41D2",
            "1URD",
            "21L2",
            "33L2",
            "43D2",
            "1U2R",
            "34RD",
            "32RD",
            "1R2R",
            "2412",
            "1U12",
            "31L2",
            "12RD",
            "2LD2",
            "2R2R",
            "24RD",
            "242R",
            "3412",
            "4RD2",
            "422R",
            "122R",
            "2D12",
            "11D2",
            "4U2R",
            "22RD",
            "3L12",
            "4212",
            "3UL2",
            "2UL2",
            "11L2",
            "2R12",
            "4U12",
            "2DRD",
            "4L2R",
            "442R",
            "13D2",
            "3212",
            "4DL2",
            "43L2",
            "4412",
            "2D2R",
            "33D2",
            "42RD",
            "1212",
            "1DL2",
            "222R",
            "14RD",
            "1412",
            "3D12",
            "342R",
            "31D2",
            "41L2",
            "23L2",
            "3DRD",
            "23D2",
            "4URD",
        },
        Perm((2, 0, 1, 3)): {
            "41LD",
            "1D1L",
            "1121",
            "131L",
            "2U1L",
            "431L",
            "12R1",
            "1D21",
            "14D1",
            "2ULD",
            "1L21",
            "1UR1",
            "42D1",
            "1321",
            "34D1",
            "1L1L",
            "4R21",
            "11LD",
            "2121",
            "2321",
            "21LD",
            "3R1L",
            "2L1L",
            "22R1",
            "32D1",
            "4UR1",
            "4DLD",
            "231L",
            "3ULD",
            "3U21",
            "111L",
            "4R1L",
            "2U21",
            "44D1",
            "22D1",
            "23LD",
            "2RD1",
            "31LD",
            "33LD",
            "3R21",
            "34R1",
            "2DR1",
            "14R1",
            "4121",
            "311L",
            "32R1",
            "1DLD",
            "411L",
            "4321",
            "13LD",
            "3LD1",
            "3121",
            "43LD",
            "12D1",
            "3U1L",
            "24D1",
            "4D1L",
            "44R1",
            "1RD1",
            "211L",
            "331L",
            "2L21",
            "42R1",
            "24R1",
            "3DR1",
            "3321",
            "4LD1",
            "4D21",
        },
        Perm((3, 2, 0, 1)): {
            "3L4D",
            "2DR2",
            "2122",
            "3D4D",
            "4R22",
            "14R2",
            "22D2",
            "24D2",
            "2R4R",
            "344R",
            "24R2",
            "444D",
            "1U4R",
            "4D22",
            "4U4R",
            "3LD2",
            "42R2",
            "3322",
            "4322",
            "4L4R",
            "4UR2",
            "224R",
            "3122",
            "4U4D",
            "12R2",
            "3L4R",
            "12D2",
            "124D",
            "3DR2",
            "2U22",
            "1R4D",
            "2R4D",
            "2RD2",
            "324D",
            "4LD2",
            "144D",
            "344D",
            "1322",
            "2D4D",
            "42D2",
            "1D22",
            "144R",
            "22R2",
            "34D2",
            "44R2",
            "32D2",
            "34R2",
            "1RD2",
            "4L4D",
            "1122",
            "1R4R",
            "124R",
            "2L22",
            "3U22",
            "32R2",
            "44D2",
            "14D2",
            "1L22",
            "224D",
            "424R",
            "424D",
            "244R",
            "1U4D",
            "244D",
            "444R",
            "3R22",
            "2D4R",
            "1UR2",
            "3D4R",
            "4122",
            "2322",
            "324R",
        },
        Perm((0, 3, 1, 2)): {
            "3DR3",
            "34R3",
            "12D3",
            "3R3U",
            "3123",
            "13UR",
            "233U",
            "33UR",
            "44R3",
            "23UR",
            "2U3U",
            "22D3",
            "1123",
            "3R23",
            "22R3",
            "2U23",
            "2323",
            "2L3U",
            "11UR",
            "41UR",
            "3LD3",
            "3323",
            "43UR",
            "3U23",
            "14R3",
            "1RD3",
            "44D3",
            "1L3U",
            "34D3",
            "32R3",
            "24R3",
            "413U",
            "4323",
            "14D3",
            "12R3",
            "133U",
            "1D3U",
            "1323",
            "2DR3",
            "2LUR",
            "21UR",
            "4123",
            "2L23",
            "2RD3",
            "32D3",
            "1L23",
            "4RUR",
            "433U",
            "333U",
            "31UR",
            "42D3",
            "4UR3",
            "4D23",
            "113U",
            "1D23",
            "1UR3",
            "1LUR",
            "213U",
            "4LD3",
            "4R23",
            "313U",
            "4D3U",
            "24D3",
            "42R3",
            "4R3U",
            "3U3U",
            "2123",
            "3RUR",
        },
        Perm((1, 0, 3, 2)): {
            "2D1R",
            "3D3D",
            "321U",
            "4U1U",
            "4U3D",
            "343D",
            "243L",
            "4U3L",
            "141U",
            "4L3D",
            "3L3L",
            "1U3L",
            "123D",
            "2R3L",
            "3L1R",
            "341R",
            "421U",
            "123L",
            "441R",
            "443L",
            "343L",
            "4L3L",
            "3D1R",
            "221R",
            "3D1U",
            "223L",
            "223D",
            "423L",
            "2R1R",
            "441U",
            "143D",
            "141R",
            "121U",
            "143L",
            "1R1R",
            "1U1R",
            "241R",
            "3D3L",
            "321R",
            "1U3D",
            "4L1U",
            "1R3L",
            "3L1U",
            "1R3D",
            "341U",
            "421R",
            "423D",
            "2D3L",
            "241U",
            "221U",
            "1R1U",
            "243D",
            "3L3D",
            "2D3D",
            "2R3D",
            "2R1U",
            "323D",
            "121R",
            "2D1U",
            "443D",
            "1U1U",
            "323L",
            "4L1R",
            "4U1R",
        },
        Perm((2, 1, 0, 3)): {
            "221L",
            "2R21",
            "4U1D",
            "1221",
            "1421",
            "2R41",
            "4L1D",
            "2R1D",
            "1U1L",
            "1U21",
            "341L",
            "3D1D",
            "4241",
            "341D",
            "4421",
            "121D",
            "2421",
            "3421",
            "4U41",
            "421D",
            "4L41",
            "2D41",
            "321D",
            "3441",
            "321L",
            "4441",
            "3D41",
            "3241",
            "2241",
            "421L",
            "2221",
            "241L",
            "1U1D",
            "441D",
            "1R41",
            "2D1L",
            "2441",
            "1441",
            "3221",
            "1R1L",
            "221D",
            "241D",
            "2D21",
            "1U41",
            "121L",
            "3L21",
            "4L21",
            "441L",
            "3L1L",
            "3L41",
            "141L",
            "4L1L",
            "3L1D",
            "3D1L",
            "1241",
            "2R1L",
            "1R1D",
            "2D1D",
            "4U21",
            "1R21",
            "4221",
            "3D21",
            "4U1L",
            "141D",
        },
        Perm((1, 0, 2, 3)): {
            "4RD1",
            "43L1",
            "11L1",
            "2L3D",
            "4211",
            "1L3L",
            "31L1",
            "133D",
            "31D1",
            "3R3D",
            "4U11",
            "113D",
            "2D11",
            "13L1",
            "33L1",
            "4D3D",
            "2R11",
            "2211",
            "233L",
            "4D3L",
            "21D1",
            "433D",
            "4DL1",
            "4R3L",
            "4L11",
            "13D1",
            "2U3D",
            "2U3L",
            "3U3L",
            "113L",
            "3L11",
            "3U3D",
            "11D1",
            "23L1",
            "313L",
            "41L1",
            "23D1",
            "413D",
            "43D1",
            "2UL1",
            "1D3L",
            "1R11",
            "1L3D",
            "1411",
            "3UL1",
            "133L",
            "3R3L",
            "1D3D",
            "33D1",
            "313D",
            "413L",
            "433L",
            "1LD1",
            "2LD1",
            "3211",
            "1211",
            "213L",
            "2L3L",
            "233D",
            "2411",
            "4R3D",
            "4411",
            "1U11",
            "21L1",
            "3411",
            "41D1",
            "213D",
            "3RD1",
            "1DL1",
            "333D",
            "3D11",
            "333L",
        },
        Perm((0, 2, 1, 3)): {
            "2R13",
            "1LD3",
            "1DR1",
            "4DR1",
            "33R1",
            "4RD3",
            "2213",
            "31R1",
            "31L3",
            "41D3",
            "1U13",
            "3RD3",
            "1R13",
            "4413",
            "3413",
            "1231",
            "41U1",
            "3L13",
            "2231",
            "4DL3",
            "4231",
            "3RU1",
            "4213",
            "11U1",
            "23D3",
            "4RU1",
            "4U31",
            "2D31",
            "2D13",
            "1413",
            "43L3",
            "3231",
            "11D3",
            "4L13",
            "33L3",
            "31U1",
            "2LU1",
            "3D13",
            "3UL3",
            "13R1",
            "21L3",
            "2431",
            "21R1",
            "2R31",
            "23R1",
            "41L3",
            "1431",
            "23L3",
            "43U1",
            "1U31",
            "4L31",
            "13U1",
            "21D3",
            "2413",
            "33U1",
            "4431",
            "3UR1",
            "33D3",
            "23U1",
            "4U13",
            "3D31",
            "3431",
            "3L31",
            "13D3",
            "13L3",
            "2LD3",
            "1LU1",
            "21U1",
            "11R1",
            "1213",
            "11L3",
            "2UL3",
            "2UR1",
            "31D3",
            "1R31",
            "1DL3",
            "43R1",
            "3213",
            "41R1",
            "43D3",
        },
        Perm((2, 1, 3, 0)): {
            "244U",
            "13D4",
            "21D4",
            "32UL",
            "4U4U",
            "1414",
            "31L4",
            "2R4U",
            "11L4",
            "2214",
            "3RD4",
            "4DL4",
            "13L4",
            "3D4U",
            "4L14",
            "23D4",
            "22UL",
            "33D4",
            "424U",
            "4214",
            "4414",
            "1U14",
            "144U",
            "1LD4",
            "124U",
            "21L4",
            "1DL4",
            "3L14",
            "324U",
            "3214",
            "44UL",
            "33L4",
            "43L4",
            "1RUL",
            "224U",
            "1R4U",
            "1U4U",
            "24UL",
            "2414",
            "3D14",
            "344U",
            "41D4",
            "2RUL",
            "3414",
            "2D14",
            "4RD4",
            "42UL",
            "2UL4",
            "31D4",
            "14UL",
            "43D4",
            "4U14",
            "4LUL",
            "4L4U",
            "3L4U",
            "2D4U",
            "2R14",
            "41L4",
            "3UL4",
            "1R14",
            "1214",
            "23L4",
            "34UL",
            "444U",
            "11D4",
            "2LD4",
            "12UL",
            "3LUL",
        },
        Perm((3, 0, 2, 1)): {
            "1U2D",
            "1R2D",
            "3D32",
            "322D",
            "4232",
            "22DR",
            "3UR2",
            "41U2",
            "32DR",
            "4LDR",
            "2R32",
            "2232",
            "43U2",
            "422D",
            "1RDR",
            "12DR",
            "14DR",
            "13R2",
            "21R2",
            "41R2",
            "23U2",
            "2D32",
            "1U32",
            "4L2D",
            "31R2",
            "44DR",
            "4DR2",
            "33U2",
            "11R2",
            "4RU2",
            "2R2D",
            "342D",
            "23R2",
            "442D",
            "2D2D",
            "11U2",
            "3L2D",
            "1DR2",
            "34DR",
            "1432",
            "4U32",
            "3432",
            "4L32",
            "3LDR",
            "1R32",
            "1232",
            "2RDR",
            "42DR",
            "4U2D",
            "31U2",
            "222D",
            "2432",
            "13U2",
            "3D2D",
            "2UR2",
            "3232",
            "43R2",
            "3RU2",
            "24DR",
            "242D",
            "122D",
            "21U2",
            "3L32",
            "1LU2",
            "4432",
            "2LU2",
            "142D",
            "33R2",
        },
        Perm((3, 2, 1, 0)): {
            "1422",
            "3D44",
            "1R22",
            "3442",
            "2D22",
            "3444",
            "1222",
            "2222",
            "3L42",
            "3244",
            "4U42",
            "4444",
            "4L42",
            "4244",
            "1U22",
            "2R44",
            "2444",
            "3424",
            "4U22",
            "1242",
            "2R24",
            "3L44",
            "3D22",
            "1R24",
            "2D24",
            "3422",
            "3L22",
            "4242",
            "1442",
            "2224",
            "2442",
            "4224",
            "1224",
            "2D42",
            "3242",
            "1U42",
            "2422",
            "3D24",
            "1244",
            "4422",
            "4424",
            "1U24",
            "3224",
            "1424",
            "3222",
            "4L22",
            "1R42",
            "1U44",
            "2242",
            "4U44",
            "4L24",
            "3D42",
            "2R22",
            "3L24",
            "1R44",
            "4442",
            "4U24",
            "2R42",
            "2D44",
            "2424",
            "4L44",
            "4222",
            "2244",
            "1444",
        },
        Perm((0, 3, 2, 1)): {
            "1R3U",
            "4423",
            "423U",
            "243U",
            "1R23",
            "3D3U",
            "4U43",
            "4L3U",
            "1443",
            "1U43",
            "343U",
            "2R23",
            "4L43",
            "1U23",
            "4443",
            "2223",
            "243R",
            "3D23",
            "3L3U",
            "2D3R",
            "2R43",
            "2443",
            "4U3U",
            "3L3R",
            "2D3U",
            "1223",
            "1423",
            "2243",
            "3243",
            "443U",
            "123U",
            "4243",
            "1U3U",
            "123R",
            "143U",
            "3L23",
            "443R",
            "1243",
            "223U",
            "3L43",
            "1R43",
            "143R",
            "2R3U",
            "4L3R",
            "3D3R",
            "3443",
            "323U",
            "343R",
            "4U3R",
            "423R",
            "4223",
            "4U23",
            "1R3R",
            "2D43",
            "2R3R",
            "2423",
            "2D23",
            "3D43",
            "323R",
            "4L23",
            "3223",
            "1U3R",
            "223R",
            "3423",
        },
        Perm((0, 1, 3, 2)): {
            "2U1R",
            "211R",
            "2U1U",
            "11U3",
            "3L33",
            "1D1U",
            "31U3",
            "331U",
            "331R",
            "111U",
            "211U",
            "43R3",
            "3433",
            "4D1R",
            "23U3",
            "411U",
            "3UR3",
            "111R",
            "4L33",
            "3D33",
            "3U1R",
            "2433",
            "31R3",
            "1LU3",
            "41U3",
            "311U",
            "231R",
            "33U3",
            "131U",
            "3RU3",
            "411R",
            "2L1R",
            "21R3",
            "431U",
            "13U3",
            "2LU3",
            "21U3",
            "131R",
            "2L1U",
            "3U1U",
            "4R1U",
            "1D1R",
            "4233",
            "431R",
            "4433",
            "1L1R",
            "2233",
            "33R3",
            "3R1R",
            "11R3",
            "2UR3",
            "311R",
            "1L1U",
            "2R33",
            "4D1U",
            "1DR3",
            "1R33",
            "231U",
            "4U33",
            "23R3",
            "4R1R",
            "1U33",
            "43U3",
            "1233",
            "3233",
            "41R3",
            "4DR3",
            "1433",
            "4RU3",
            "2D33",
            "3R1U",
            "13R3",
        },
        Perm((1, 3, 0, 2)): {
            "11RD",
            "4LUR",
            "22DL",
            "2URD",
            "4LDL",
            "11LU",
            "2ULU",
            "44DL",
            "3URD",
            "41RD",
            "24UR",
            "43LU",
            "34UR",
            "33LU",
            "21RD",
            "33RD",
            "21LU",
            "34DL",
            "42UR",
            "42DL",
            "32DL",
            "24DL",
            "14DL",
            "1DLU",
            "31LU",
            "22UR",
            "12DL",
            "3ULU",
            "3LDL",
            "13RD",
            "31RD",
            "41LU",
            "43RD",
            "2RDL",
            "4DLU",
            "4DRD",
            "14UR",
            "23RD",
            "23LU",
            "3LUR",
            "13LU",
            "1DRD",
            "1RDL",
            "1RUR",
            "44UR",
            "2RUR",
            "32UR",
            "12UR",
        },
        Perm((0, 1, 2, 3)): {
            "2U13",
            "3R13",
            "1111",
            "1D11",
            "2L11",
            "1311",
            "2311",
            "3U13",
            "4311",
            "2313",
            "4D31",
            "2L13",
            "4R11",
            "3R11",
            "3331",
            "1313",
            "2113",
            "2111",
            "3111",
            "2U33",
            "2331",
            "3313",
            "3333",
            "4R31",
            "4111",
            "1L11",
            "3U31",
            "4133",
            "3311",
            "3R33",
            "1D13",
            "1L31",
            "2U31",
            "1113",
            "1333",
            "4R33",
            "1133",
            "2L33",
            "4131",
            "1L13",
            "1L33",
            "1D33",
            "3113",
            "4R13",
            "4313",
            "3U33",
            "4333",
            "1131",
            "1331",
            "1D31",
            "2L31",
            "3U11",
            "2133",
            "3R31",
            "3131",
            "4D33",
            "4331",
            "4113",
            "4D13",
            "2333",
            "4D11",
            "3133",
            "2U11",
            "2131",
        },
        Perm((3, 0, 1, 2)): {
            "1L2D",
            "1D12",
            "3U2D",
            "4332",
            "1D32",
            "4D32",
            "3U12",
            "132R",
            "112D",
            "3R12",
            "2U2R",
            "4R2R",
            "3R32",
            "1D2D",
            "1332",
            "332D",
            "1112",
            "332R",
            "1132",
            "4312",
            "4132",
            "3R2D",
            "4R32",
            "4R12",
            "4112",
            "3U32",
            "2132",
            "3U2R",
            "1312",
            "112R",
            "212D",
            "2312",
            "1L2R",
            "2L2R",
            "3332",
            "1D2R",
            "3R2R",
            "2112",
            "3312",
            "3132",
            "4D2R",
            "2U2D",
            "2L32",
            "1L12",
            "2U12",
            "312R",
            "2L12",
            "2332",
            "3112",
            "2U32",
            "4D12",
            "432R",
            "2L2D",
            "312D",
            "1L32",
            "232D",
            "232R",
            "412R",
            "4D2D",
            "432D",
            "412D",
            "132D",
            "212R",
            "4R2D",
        },
        Perm((1, 2, 3, 0)): {
            "314L",
            "2L34",
            "134U",
            "4D34",
            "4314",
            "3134",
            "414U",
            "1114",
            "3U4L",
            "4334",
            "3U4U",
            "1134",
            "3R34",
            "334U",
            "1D14",
            "4D4U",
            "1D4U",
            "1314",
            "434U",
            "434L",
            "2114",
            "1D34",
            "2U4L",
            "214U",
            "2134",
            "234L",
            "4D4L",
            "1L34",
            "4114",
            "4134",
            "2314",
            "2U14",
            "2L4U",
            "3R4L",
            "114U",
            "2U34",
            "234U",
            "4D14",
            "2334",
            "334L",
            "1L4L",
            "414L",
            "4R4U",
            "1L14",
            "3334",
            "4R4L",
            "314U",
            "114L",
            "1L4U",
            "3U34",
            "134L",
            "3314",
            "214L",
            "3U14",
            "4R34",
            "2L14",
            "1334",
            "1D4L",
            "2L4L",
            "3114",
            "2U4U",
            "4R14",
            "3R4U",
            "3R14",
        },
        Perm((2, 3, 0, 1)): {
            "134D",
            "412U",
            "112U",
            "132L",
            "414D",
            "1D4R",
            "432L",
            "314D",
            "3R4R",
            "412L",
            "1D2U",
            "134R",
            "334D",
            "232L",
            "4D2U",
            "3R4D",
            "4D4D",
            "2U4R",
            "114D",
            "1L2U",
            "332U",
            "1D4D",
            "2U2L",
            "3U2U",
            "4D2L",
            "3R2U",
            "132U",
            "1L2L",
            "212U",
            "3U2L",
            "2L4D",
            "4R2L",
            "2L4R",
            "4R4D",
            "414R",
            "234D",
            "332L",
            "2L2U",
            "114R",
            "2U2U",
            "232U",
            "4R4R",
            "2U4D",
            "434R",
            "434D",
            "212L",
            "112L",
            "3U4D",
            "214D",
            "334R",
            "312U",
            "3U4R",
            "432U",
            "4R2U",
            "234R",
            "2L2L",
            "1L4D",
            "312L",
            "1L4R",
            "3R2L",
            "314R",
            "214R",
            "1D2L",
            "4D4R",
        },
    }


def test_is_strict_pinword():
    assert PinWords.is_strict_pinword("") is True
    assert PinWords.is_strict_pinword("1") is True
    assert PinWords.is_strict_pinword("2") is True
    assert PinWords.is_strict_pinword("3") is True
    assert PinWords.is_strict_pinword("4") is True
    assert PinWords.is_strict_pinword("1U") is True
    assert PinWords.is_strict_pinword("1D") is True
    assert PinWords.is_strict_pinword("1L") is True
    assert PinWords.is_strict_pinword("1R") is True
    assert PinWords.is_strict_pinword("11") is False
    assert PinWords.is_strict_pinword("12") is False
    assert PinWords.is_strict_pinword("13") is False
    assert PinWords.is_strict_pinword("14") is False
    assert PinWords.is_strict_pinword("2U") is True
    assert PinWords.is_strict_pinword("2D") is True
    assert PinWords.is_strict_pinword("2L") is True
    assert PinWords.is_strict_pinword("2R") is True
    assert PinWords.is_strict_pinword("21") is False
    assert PinWords.is_strict_pinword("22") is False
    assert PinWords.is_strict_pinword("23") is False
    assert PinWords.is_strict_pinword("24") is False
    assert PinWords.is_strict_pinword("3U") is True
    assert PinWords.is_strict_pinword("3D") is True
    assert PinWords.is_strict_pinword("3L") is True
    assert PinWords.is_strict_pinword("3R") is True
    assert PinWords.is_strict_pinword("31") is False
    assert PinWords.is_strict_pinword("32") is False
    assert PinWords.is_strict_pinword("33") is False
    assert PinWords.is_strict_pinword("34") is False
    assert PinWords.is_strict_pinword("4U") is True
    assert PinWords.is_strict_pinword("4D") is True
    assert PinWords.is_strict_pinword("4L") is True
    assert PinWords.is_strict_pinword("4R") is True
    assert PinWords.is_strict_pinword("41") is False
    assert PinWords.is_strict_pinword("42") is False
    assert PinWords.is_strict_pinword("43") is False
    assert PinWords.is_strict_pinword("44") is False
    assert PinWords.is_strict_pinword("434") is False
    assert PinWords.is_strict_pinword("2D1") is False
    assert PinWords.is_strict_pinword("3U3") is False
    assert PinWords.is_strict_pinword("34R") is False
    assert PinWords.is_strict_pinword("24D") is False
    assert PinWords.is_strict_pinword("43U") is False
    assert PinWords.is_strict_pinword("4LD") is True
    assert PinWords.is_strict_pinword("3U4") is False
    assert PinWords.is_strict_pinword("33U") is False
    assert PinWords.is_strict_pinword("34U") is False
    assert PinWords.is_strict_pinword("3L4") is False
    assert PinWords.is_strict_pinword("214") is False
    assert PinWords.is_strict_pinword("2UR") is True
    assert PinWords.is_strict_pinword("3D3D") is False
    assert PinWords.is_strict_pinword("3U3R") is False
    assert PinWords.is_strict_pinword("21UL") is False
    assert PinWords.is_strict_pinword("2RD2") is False
    assert PinWords.is_strict_pinword("4R4D") is False
    assert PinWords.is_strict_pinword("113R") is False
    assert PinWords.is_strict_pinword("2L14") is False
    assert PinWords.is_strict_pinword("33LD") is False
    assert PinWords.is_strict_pinword("44UL") is False
    assert PinWords.is_strict_pinword("224D") is False
    assert PinWords.is_strict_pinword("3D3R") is False
    assert PinWords.is_strict_pinword("3423") is False
    assert PinWords.is_strict_pinword("21RU") is False
    assert PinWords.is_strict_pinword("1ULU") is True
    assert PinWords.is_strict_pinword("411R") is False
    assert PinWords.is_strict_pinword("43L2") is False


def test_stict_pinwords_of_length():
    assert list(PinWords.strict_pinwords_of_length(0)) == [""]
    assert list(PinWords.strict_pinwords_of_length(1)) == ["1", "2", "3", "4"]
    assert list(PinWords.strict_pinwords_of_length(2)) == [
        "1U",
        "1D",
        "1L",
        "1R",
        "2U",
        "2D",
        "2L",
        "2R",
        "3U",
        "3D",
        "3L",
        "3R",
        "4U",
        "4D",
        "4L",
        "4R",
    ]
    assert list(PinWords.strict_pinwords_of_length(3)) == [
        "1UL",
        "1UR",
        "1DL",
        "1DR",
        "1LU",
        "1LD",
        "1RU",
        "1RD",
        "2UL",
        "2UR",
        "2DL",
        "2DR",
        "2LU",
        "2LD",
        "2RU",
        "2RD",
        "3UL",
        "3UR",
        "3DL",
        "3DR",
        "3LU",
        "3LD",
        "3RU",
        "3RD",
        "4UL",
        "4UR",
        "4DL",
        "4DR",
        "4LU",
        "4LD",
        "4RU",
        "4RD",
    ]
    assert list(PinWords.strict_pinwords_of_length(4)) == [
        "1ULU",
        "1ULD",
        "1URU",
        "1URD",
        "1DLU",
        "1DLD",
        "1DRU",
        "1DRD",
        "1LUL",
        "1LUR",
        "1LDL",
        "1LDR",
        "1RUL",
        "1RUR",
        "1RDL",
        "1RDR",
        "2ULU",
        "2ULD",
        "2URU",
        "2URD",
        "2DLU",
        "2DLD",
        "2DRU",
        "2DRD",
        "2LUL",
        "2LUR",
        "2LDL",
        "2LDR",
        "2RUL",
        "2RUR",
        "2RDL",
        "2RDR",
        "3ULU",
        "3ULD",
        "3URU",
        "3URD",
        "3DLU",
        "3DLD",
        "3DRU",
        "3DRD",
        "3LUL",
        "3LUR",
        "3LDL",
        "3LDR",
        "3RUL",
        "3RUR",
        "3RDL",
        "3RDR",
        "4ULU",
        "4ULD",
        "4URU",
        "4URD",
        "4DLU",
        "4DLD",
        "4DRU",
        "4DRD",
        "4LUL",
        "4LUR",
        "4LDL",
        "4LDR",
        "4RUL",
        "4RUR",
        "4RDL",
        "4RDR",
    ]
    assert list(PinWords.strict_pinwords_of_length(5)) == [
        "1ULUL",
        "1ULUR",
        "1ULDL",
        "1ULDR",
        "1URUL",
        "1URUR",
        "1URDL",
        "1URDR",
        "1DLUL",
        "1DLUR",
        "1DLDL",
        "1DLDR",
        "1DRUL",
        "1DRUR",
        "1DRDL",
        "1DRDR",
        "1LULU",
        "1LULD",
        "1LURU",
        "1LURD",
        "1LDLU",
        "1LDLD",
        "1LDRU",
        "1LDRD",
        "1RULU",
        "1RULD",
        "1RURU",
        "1RURD",
        "1RDLU",
        "1RDLD",
        "1RDRU",
        "1RDRD",
        "2ULUL",
        "2ULUR",
        "2ULDL",
        "2ULDR",
        "2URUL",
        "2URUR",
        "2URDL",
        "2URDR",
        "2DLUL",
        "2DLUR",
        "2DLDL",
        "2DLDR",
        "2DRUL",
        "2DRUR",
        "2DRDL",
        "2DRDR",
        "2LULU",
        "2LULD",
        "2LURU",
        "2LURD",
        "2LDLU",
        "2LDLD",
        "2LDRU",
        "2LDRD",
        "2RULU",
        "2RULD",
        "2RURU",
        "2RURD",
        "2RDLU",
        "2RDLD",
        "2RDRU",
        "2RDRD",
        "3ULUL",
        "3ULUR",
        "3ULDL",
        "3ULDR",
        "3URUL",
        "3URUR",
        "3URDL",
        "3URDR",
        "3DLUL",
        "3DLUR",
        "3DLDL",
        "3DLDR",
        "3DRUL",
        "3DRUR",
        "3DRDL",
        "3DRDR",
        "3LULU",
        "3LULD",
        "3LURU",
        "3LURD",
        "3LDLU",
        "3LDLD",
        "3LDRU",
        "3LDRD",
        "3RULU",
        "3RULD",
        "3RURU",
        "3RURD",
        "3RDLU",
        "3RDLD",
        "3RDRU",
        "3RDRD",
        "4ULUL",
        "4ULUR",
        "4ULDL",
        "4ULDR",
        "4URUL",
        "4URUR",
        "4URDL",
        "4URDR",
        "4DLUL",
        "4DLUR",
        "4DLDL",
        "4DLDR",
        "4DRUL",
        "4DRUR",
        "4DRDL",
        "4DRDR",
        "4LULU",
        "4LULD",
        "4LURU",
        "4LURD",
        "4LDLU",
        "4LDLD",
        "4LDRU",
        "4LDRD",
        "4RULU",
        "4RULD",
        "4RURU",
        "4RURD",
        "4RDLU",
        "4RDLD",
        "4RDRU",
        "4RDRD",
    ]


def test_perm_to_strict_pinword_mapping():
    assert PinWords.perm_to_strict_pinword_mapping(0) == {Perm(()): {""}}
    assert PinWords.perm_to_strict_pinword_mapping(1) == {
        Perm((0,)): {"3", "2", "4", "1"}
    }
    assert PinWords.perm_to_strict_pinword_mapping(2) == {
        Perm((1, 0)): {"3D", "3L", "4U", "2R", "2D", "1U", "4L", "1R"},
        Perm((0, 1)): {"2U", "2L", "3U", "4R", "1D", "4D", "1L", "3R"},
    }
    assert PinWords.perm_to_strict_pinword_mapping(3) == {
        Perm((1, 2, 0)): {"4LU", "2DL", "3DL", "1UL", "4UL", "2RU", "3LU", "1RU"},
        Perm((2, 0, 1)): {"2DR", "4LD", "4UR", "3LD", "2RD", "3DR", "1RD", "1UR"},
        Perm((1, 0, 2)): {"2UL", "2LD", "4DL", "4RD", "1DL", "3RD", "3UL", "1LD"},
        Perm((2, 1, 0)): set(),
        Perm((0, 2, 1)): {"3UR", "2LU", "4RU", "1DR", "1LU", "4DR", "3RU", "2UR"},
        Perm((0, 1, 2)): set(),
    }
    assert PinWords.perm_to_strict_pinword_mapping(4) == {
        Perm((1, 3, 2, 0)): {"1ULU", "2DLU", "4ULU", "3DLU"},
        Perm((2, 0, 3, 1)): {
            "3RUL",
            "4RDR",
            "4URU",
            "3DRU",
            "3RDR",
            "1ULD",
            "4ULD",
            "1URU",
            "3DLD",
            "1LDR",
            "2DRU",
            "1LUL",
            "2DLD",
            "4RUL",
            "2LDR",
            "2LUL",
        },
        Perm((1, 2, 0, 3)): {"4RDL", "2LDL", "1LDL", "3RDL"},
        Perm((3, 1, 2, 0)): set(),
        Perm((0, 2, 3, 1)): {"4DRU", "3URU", "1DRU", "2URU"},
        Perm((2, 3, 1, 0)): set(),
        Perm((3, 1, 0, 2)): {"2DRD", "3DRD", "1URD", "4URD"},
        Perm((2, 0, 1, 3)): {"3ULD", "2ULD", "1DLD", "4DLD"},
        Perm((3, 2, 0, 1)): set(),
        Perm((0, 3, 1, 2)): {"4RUR", "1LUR", "3RUR", "2LUR"},
        Perm((1, 0, 3, 2)): set(),
        Perm((2, 1, 0, 3)): set(),
        Perm((1, 0, 2, 3)): set(),
        Perm((0, 2, 1, 3)): set(),
        Perm((2, 1, 3, 0)): {"1RUL", "4LUL", "3LUL", "2RUL"},
        Perm((3, 0, 2, 1)): {"3LDR", "4LDR", "1RDR", "2RDR"},
        Perm((3, 2, 1, 0)): set(),
        Perm((0, 3, 2, 1)): set(),
        Perm((0, 1, 3, 2)): set(),
        Perm((1, 3, 0, 2)): {
            "4DLU",
            "4DRD",
            "4LUR",
            "4LDL",
            "1DLU",
            "3URD",
            "3LDL",
            "2RUR",
            "1RDL",
            "2ULU",
            "2URD",
            "1DRD",
            "2RDL",
            "1RUR",
            "3LUR",
            "3ULU",
        },
        Perm((0, 1, 2, 3)): set(),
        Perm((3, 0, 1, 2)): set(),
        Perm((1, 2, 3, 0)): set(),
        Perm((2, 3, 0, 1)): set(),
    }
    assert PinWords.perm_to_strict_pinword_mapping(5) == {
        Perm((3, 1, 4, 2, 0)): {"1ULUL", "2DLUL", "3DLUL", "4ULUL"},
        Perm((1, 4, 2, 0, 3)): {
            "4RURD",
            "2LDLU",
            "1URDL",
            "3RDLU",
            "1LDLU",
            "2LURD",
            "3RURD",
            "4ULUR",
            "3DLUR",
            "4URDL",
            "4RDLU",
            "1LURD",
            "2DRDL",
            "1ULUR",
            "3DRDL",
            "2DLUR",
        },
        Perm((1, 3, 2, 0, 4)): set(),
        Perm((4, 1, 3, 2, 0)): set(),
        Perm((0, 2, 4, 3, 1)): set(),
        Perm((2, 4, 3, 1, 0)): set(),
        Perm((1, 3, 0, 4, 2)): {
            "2DLDL",
            "1RURU",
            "3DLDL",
            "4LURU",
            "2RURU",
            "4ULDL",
            "1ULDL",
            "3LURU",
        },
        Perm((3, 0, 4, 2, 1)): {"1ULDR", "4ULDR", "2DLDR", "3DLDR"},
        Perm((2, 0, 3, 1, 4)): {"1LDLD", "2LDLD", "4RDLD", "3RDLD"},
        Perm((4, 2, 0, 3, 1)): {"3DRDR", "4URDR", "2DRDR", "1URDR"},
        Perm((0, 3, 1, 4, 2)): {"1LURU", "4RURU", "2LURU", "3RURU"},
        Perm((1, 2, 0, 4, 3)): set(),
        Perm((2, 3, 1, 0, 4)): set(),
        Perm((3, 1, 2, 0, 4)): set(),
        Perm((1, 2, 0, 3, 4)): set(),
        Perm((4, 1, 2, 0, 3)): set(),
        Perm((0, 2, 3, 1, 4)): set(),
        Perm((2, 3, 1, 4, 0)): set(),
        Perm((3, 4, 1, 2, 0)): set(),
        Perm((4, 0, 2, 3, 1)): set(),
        Perm((4, 3, 1, 2, 0)): set(),
        Perm((0, 4, 2, 3, 1)): set(),
        Perm((4, 2, 3, 1, 0)): set(),
        Perm((1, 0, 3, 4, 2)): set(),
        Perm((0, 3, 4, 2, 1)): set(),
        Perm((0, 1, 3, 4, 2)): set(),
        Perm((1, 3, 4, 2, 0)): set(),
        Perm((3, 4, 2, 0, 1)): set(),
        Perm((3, 4, 2, 1, 0)): set(),
        Perm((3, 2, 0, 4, 1)): {"3DRUL", "4URUL", "1URUL", "2DRUL"},
        Perm((2, 0, 4, 1, 3)): {
            "3LDLD",
            "4LDLD",
            "4URUR",
            "1URUR",
            "2DRUR",
            "1RDLD",
            "2RDLD",
            "3DRUR",
        },
        Perm((3, 1, 0, 2, 4)): set(),
        Perm((4, 3, 1, 0, 2)): set(),
        Perm((0, 4, 2, 1, 3)): set(),
        Perm((4, 2, 1, 3, 0)): set(),
        Perm((2, 0, 1, 4, 3)): set(),
        Perm((3, 2, 0, 1, 4)): set(),
        Perm((2, 0, 1, 3, 4)): set(),
        Perm((4, 2, 0, 1, 3)): set(),
        Perm((0, 3, 1, 2, 4)): set(),
        Perm((3, 1, 2, 4, 0)): set(),
        Perm((4, 0, 3, 1, 2)): set(),
        Perm((4, 3, 2, 0, 1)): set(),
        Perm((0, 4, 3, 1, 2)): set(),
        Perm((1, 0, 4, 2, 3)): set(),
        Perm((0, 1, 4, 2, 3)): set(),
        Perm((1, 4, 2, 3, 0)): set(),
        Perm((4, 2, 3, 0, 1)): set(),
        Perm((3, 1, 0, 4, 2)): set(),
        Perm((1, 0, 3, 2, 4)): set(),
        Perm((4, 1, 0, 3, 2)): set(),
        Perm((0, 2, 1, 4, 3)): set(),
        Perm((2, 1, 4, 3, 0)): set(),
        Perm((2, 1, 0, 3, 4)): set(),
        Perm((4, 2, 1, 0, 3)): set(),
        Perm((0, 3, 2, 1, 4)): set(),
        Perm((3, 2, 1, 4, 0)): set(),
        Perm((2, 4, 1, 0, 3)): {"1RURD", "3LURD", "2RURD", "4LURD"},
        Perm((3, 0, 2, 1, 4)): set(),
        Perm((2, 1, 4, 0, 3)): set(),
        Perm((1, 0, 2, 4, 3)): set(),
        Perm((2, 1, 3, 0, 4)): set(),
        Perm((1, 0, 2, 3, 4)): set(),
        Perm((4, 1, 0, 2, 3)): set(),
        Perm((0, 2, 1, 3, 4)): set(),
        Perm((2, 1, 3, 4, 0)): set(),
        Perm((3, 4, 1, 0, 2)): set(),
        Perm((4, 0, 2, 1, 3)): set(),
        Perm((0, 3, 2, 4, 1)): set(),
        Perm((0, 1, 3, 2, 4)): set(),
        Perm((1, 3, 2, 4, 0)): set(),
        Perm((3, 2, 4, 0, 1)): set(),
        Perm((3, 2, 4, 1, 0)): set(),
        Perm((1, 4, 0, 3, 2)): set(),
        Perm((4, 0, 3, 2, 1)): set(),
        Perm((4, 3, 0, 2, 1)): set(),
        Perm((0, 4, 1, 3, 2)): set(),
        Perm((2, 1, 0, 4, 3)): set(),
        Perm((3, 2, 1, 0, 4)): set(),
        Perm((4, 3, 2, 1, 0)): set(),
        Perm((0, 4, 3, 2, 1)): set(),
        Perm((1, 0, 4, 3, 2)): set(),
        Perm((0, 1, 4, 3, 2)): set(),
        Perm((1, 4, 3, 2, 0)): set(),
        Perm((2, 0, 4, 3, 1)): set(),
        Perm((1, 4, 3, 0, 2)): {"4LDLU", "3LDLU", "1RDLU", "2RDLU"},
        Perm((3, 4, 0, 2, 1)): set(),
        Perm((4, 0, 1, 3, 2)): set(),
        Perm((0, 1, 2, 4, 3)): set(),
        Perm((1, 2, 4, 3, 0)): set(),
        Perm((2, 4, 3, 0, 1)): set(),
        Perm((3, 1, 4, 0, 2)): {
            "1DLUL",
            "1LDRD",
            "3ULUL",
            "4DLUL",
            "2ULUL",
            "3RDRD",
            "4RDRD",
            "2LDRD",
        },
        Perm((1, 4, 0, 2, 3)): {"4DLUR", "2ULUR", "1DLUR", "3ULUR"},
        Perm((1, 3, 0, 2, 4)): {"2ULDL", "1DLDL", "3ULDL", "4DLDL"},
        Perm((4, 1, 3, 0, 2)): {"4LDRD", "2RDRD", "1RDRD", "3LDRD"},
        Perm((0, 2, 4, 1, 3)): {"3URUR", "2URUR", "1DRUR", "4DRUR"},
        Perm((2, 4, 1, 3, 0)): {"2RULU", "3LULU", "4LULU", "1RULU"},
        Perm((3, 0, 2, 4, 1)): {
            "4LDRU",
            "1DLDR",
            "1RULD",
            "2ULDR",
            "4DRUL",
            "2RULD",
            "1RDRU",
            "1DRUL",
            "4LULD",
            "3LDRU",
            "3LULD",
            "3ULDR",
            "3URUL",
            "4DLDR",
            "2RDRU",
            "2URUL",
        },
        Perm((1, 2, 4, 0, 3)): {"4DRDL", "1DRDL", "3URDL", "2URDL"},
        Perm((2, 4, 0, 3, 1)): {
            "4RULU",
            "2URDR",
            "4DRDR",
            "3RULU",
            "3URDR",
            "1DRDR",
            "2LULU",
            "1LULU",
        },
        Perm((3, 0, 1, 4, 2)): {"1LULD", "2LULD", "4RULD", "3RULD"},
        Perm((1, 2, 3, 0, 4)): set(),
        Perm((2, 3, 0, 4, 1)): set(),
        Perm((2, 4, 0, 1, 3)): set(),
        Perm((3, 0, 1, 2, 4)): set(),
        Perm((0, 1, 2, 3, 4)): set(),
        Perm((4, 0, 1, 2, 3)): set(),
        Perm((1, 2, 3, 4, 0)): set(),
        Perm((3, 4, 0, 1, 2)): set(),
        Perm((4, 3, 0, 1, 2)): set(),
        Perm((0, 4, 1, 2, 3)): set(),
        Perm((4, 1, 2, 3, 0)): set(),
        Perm((0, 2, 3, 4, 1)): set(),
        Perm((2, 3, 4, 0, 1)): set(),
        Perm((2, 3, 4, 1, 0)): set(),
        Perm((2, 3, 0, 1, 4)): set(),
        Perm((0, 3, 4, 1, 2)): set(),
        Perm((3, 0, 4, 1, 2)): set(),
        Perm((2, 0, 3, 4, 1)): {"1LDRU", "4RDRU", "2LDRU", "3RDRU"},
        Perm((1, 3, 4, 0, 2)): set(),
    }


def test_factor_pinword():
    assert PinWords.factor_pinword("") == []
    assert PinWords.factor_pinword("1") == ["1"]
    assert PinWords.factor_pinword("2") == ["2"]
    assert PinWords.factor_pinword("3") == ["3"]
    assert PinWords.factor_pinword("4") == ["4"]
    assert PinWords.factor_pinword("1U") == ["1U"]
    assert PinWords.factor_pinword("1D") == ["1D"]
    assert PinWords.factor_pinword("1L") == ["1L"]
    assert PinWords.factor_pinword("1R") == ["1R"]
    assert PinWords.factor_pinword("11") == ["1", "1"]
    assert PinWords.factor_pinword("12") == ["1", "2"]
    assert PinWords.factor_pinword("13") == ["1", "3"]
    assert PinWords.factor_pinword("14") == ["1", "4"]
    assert PinWords.factor_pinword("2U") == ["2U"]
    assert PinWords.factor_pinword("2D") == ["2D"]
    assert PinWords.factor_pinword("2L") == ["2L"]
    assert PinWords.factor_pinword("2R") == ["2R"]
    assert PinWords.factor_pinword("21") == ["2", "1"]
    assert PinWords.factor_pinword("22") == ["2", "2"]
    assert PinWords.factor_pinword("23") == ["2", "3"]
    assert PinWords.factor_pinword("24") == ["2", "4"]
    assert PinWords.factor_pinword("3U") == ["3U"]
    assert PinWords.factor_pinword("3D") == ["3D"]
    assert PinWords.factor_pinword("3L") == ["3L"]
    assert PinWords.factor_pinword("3R") == ["3R"]
    assert PinWords.factor_pinword("31") == ["3", "1"]
    assert PinWords.factor_pinword("32") == ["3", "2"]
    assert PinWords.factor_pinword("33") == ["3", "3"]
    assert PinWords.factor_pinword("34") == ["3", "4"]
    assert PinWords.factor_pinword("4U") == ["4U"]
    assert PinWords.factor_pinword("4D") == ["4D"]
    assert PinWords.factor_pinword("4L") == ["4L"]
    assert PinWords.factor_pinword("4R") == ["4R"]
    assert PinWords.factor_pinword("41") == ["4", "1"]
    assert PinWords.factor_pinword("42") == ["4", "2"]
    assert PinWords.factor_pinword("43") == ["4", "3"]
    assert PinWords.factor_pinword("44") == ["4", "4"]
    assert PinWords.factor_pinword("44U") == ["4", "4U"]
    assert PinWords.factor_pinword("1R4") == ["1R", "4"]
    assert PinWords.factor_pinword("3U3") == ["3U", "3"]
    assert PinWords.factor_pinword("434") == ["4", "3", "4"]
    assert PinWords.factor_pinword("114") == ["1", "1", "4"]
    assert PinWords.factor_pinword("313") == ["3", "1", "3"]
    assert PinWords.factor_pinword("3R1") == ["3R", "1"]
    assert PinWords.factor_pinword("31R") == ["3", "1R"]
    assert PinWords.factor_pinword("4D1") == ["4D", "1"]
    assert PinWords.factor_pinword("42R") == ["4", "2R"]
    assert PinWords.factor_pinword("4LU") == ["4LU"]
    assert PinWords.factor_pinword("13D") == ["1", "3D"]
    assert PinWords.factor_pinword("2U4") == ["2U", "4"]
    assert PinWords.factor_pinword("3DR") == ["3DR"]
    assert PinWords.factor_pinword("441") == ["4", "4", "1"]
    assert PinWords.factor_pinword("33U") == ["3", "3U"]
    assert PinWords.factor_pinword("331") == ["3", "3", "1"]
    assert PinWords.factor_pinword("341") == ["3", "4", "1"]
    assert PinWords.factor_pinword("132") == ["1", "3", "2"]
    assert PinWords.factor_pinword("1L1") == ["1L", "1"]
    assert PinWords.factor_pinword("311R") == ["3", "1", "1R"]
    assert PinWords.factor_pinword("244L") == ["2", "4", "4L"]
    assert PinWords.factor_pinword("14RD") == ["1", "4RD"]
    assert PinWords.factor_pinword("1R4L") == ["1R", "4L"]
    assert PinWords.factor_pinword("43R4") == ["4", "3R", "4"]
    assert PinWords.factor_pinword("41D1") == ["4", "1D", "1"]
    assert PinWords.factor_pinword("42RD") == ["4", "2RD"]
    assert PinWords.factor_pinword("3D41") == ["3D", "4", "1"]
    assert PinWords.factor_pinword("42D1") == ["4", "2D", "1"]
    assert PinWords.factor_pinword("1LD2") == ["1LD", "2"]
    assert PinWords.factor_pinword("3R1L") == ["3R", "1L"]
    assert PinWords.factor_pinword("344D") == ["3", "4", "4D"]
    assert PinWords.factor_pinword("2DL1") == ["2DL", "1"]
    assert PinWords.factor_pinword("1242") == ["1", "2", "4", "2"]
    assert PinWords.factor_pinword("3R3L") == ["3R", "3L"]
    assert PinWords.factor_pinword("1D42") == ["1D", "4", "2"]
    assert PinWords.factor_pinword("1431") == ["1", "4", "3", "1"]
    assert PinWords.factor_pinword("42U2") == ["4", "2U", "2"]
    assert PinWords.factor_pinword("2D11") == ["2D", "1", "1"]
    assert PinWords.factor_pinword("2UR2") == ["2UR", "2"]
    assert PinWords.factor_pinword("323L1") == ["3", "2", "3L", "1"]
    assert PinWords.factor_pinword("1313L") == ["1", "3", "1", "3L"]
    assert PinWords.factor_pinword("434UL") == ["4", "3", "4UL"]
    assert PinWords.factor_pinword("1UL23") == ["1UL", "2", "3"]
    assert PinWords.factor_pinword("4U31R") == ["4U", "3", "1R"]
    assert PinWords.factor_pinword("3L1RD") == ["3L", "1RD"]
    assert PinWords.factor_pinword("22LD4") == ["2", "2LD", "4"]
    assert PinWords.factor_pinword("2R412") == ["2R", "4", "1", "2"]
    assert PinWords.factor_pinword("1ULD3") == ["1ULD", "3"]
    assert PinWords.factor_pinword("42433") == ["4", "2", "4", "3", "3"]
    assert PinWords.factor_pinword("12213") == ["1", "2", "2", "1", "3"]
    assert PinWords.factor_pinword("2U3L1") == ["2U", "3L", "1"]
    assert PinWords.factor_pinword("4D31U") == ["4D", "3", "1U"]
    assert PinWords.factor_pinword("13RU2") == ["1", "3RU", "2"]
    assert PinWords.factor_pinword("33R13") == ["3", "3R", "1", "3"]
    assert PinWords.factor_pinword("2U23R") == ["2U", "2", "3R"]
    assert PinWords.factor_pinword("34ULU") == ["3", "4ULU"]
    assert PinWords.factor_pinword("333L3") == ["3", "3", "3L", "3"]
    assert PinWords.factor_pinword("24U1U") == ["2", "4U", "1U"]
    assert PinWords.factor_pinword("2R2U3") == ["2R", "2U", "3"]
    assert PinWords.factor_pinword("12U132") == ["1", "2U", "1", "3", "2"]
    assert PinWords.factor_pinword("1UR24L") == ["1UR", "2", "4L"]
    assert PinWords.factor_pinword("323R23") == ["3", "2", "3R", "2", "3"]
    assert PinWords.factor_pinword("31UL22") == ["3", "1UL", "2", "2"]
    assert PinWords.factor_pinword("44R242") == ["4", "4R", "2", "4", "2"]
    assert PinWords.factor_pinword("22D3U3") == ["2", "2D", "3U", "3"]
    assert PinWords.factor_pinword("1U4RD3") == ["1U", "4RD", "3"]
    assert PinWords.factor_pinword("1R3D13") == ["1R", "3D", "1", "3"]
    assert PinWords.factor_pinword("1D31L2") == ["1D", "3", "1L", "2"]
    assert PinWords.factor_pinword("224L3R") == ["2", "2", "4L", "3R"]
    assert PinWords.factor_pinword("31U4UL") == ["3", "1U", "4UL"]
    assert PinWords.factor_pinword("2URD32") == ["2URD", "3", "2"]
    assert PinWords.factor_pinword("1U1U23") == ["1U", "1U", "2", "3"]
    assert PinWords.factor_pinword("31L233") == ["3", "1L", "2", "3", "3"]
    assert PinWords.factor_pinword("322UL4") == ["3", "2", "2UL", "4"]
    assert PinWords.factor_pinword("2341R4") == ["2", "3", "4", "1R", "4"]
    assert PinWords.factor_pinword("4131U3") == ["4", "1", "3", "1U", "3"]
    assert PinWords.factor_pinword("3UL24D") == ["3UL", "2", "4D"]
    assert PinWords.factor_pinword("22U244") == ["2", "2U", "2", "4", "4"]
    assert PinWords.factor_pinword("24LD42") == ["2", "4LD", "4", "2"]
    assert PinWords.factor_pinword("4LU1UL3") == ["4LU", "1UL", "3"]
    assert PinWords.factor_pinword("4D33DR1") == ["4D", "3", "3DR", "1"]
    assert PinWords.factor_pinword("4UR1D24") == ["4UR", "1D", "2", "4"]
    assert PinWords.factor_pinword("1U1U4L3") == ["1U", "1U", "4L", "3"]
    assert PinWords.factor_pinword("1R12434") == ["1R", "1", "2", "4", "3", "4"]
    assert PinWords.factor_pinword("3RD4U4D") == ["3RD", "4U", "4D"]
    assert PinWords.factor_pinword("2U2D2R2") == ["2U", "2D", "2R", "2"]
    assert PinWords.factor_pinword("1D43U31") == ["1D", "4", "3U", "3", "1"]
    assert PinWords.factor_pinword("14D2U22") == ["1", "4D", "2U", "2", "2"]
    assert PinWords.factor_pinword("3421R3R") == ["3", "4", "2", "1R", "3R"]
    assert PinWords.factor_pinword("4U41D1D") == ["4U", "4", "1D", "1D"]
    assert PinWords.factor_pinword("412L113") == ["4", "1", "2L", "1", "1", "3"]
    assert PinWords.factor_pinword("1L1LU34") == ["1L", "1LU", "3", "4"]
    assert PinWords.factor_pinword("2UL332D") == ["2UL", "3", "3", "2D"]
    assert PinWords.factor_pinword("32344RU") == ["3", "2", "3", "4", "4RU"]
    assert PinWords.factor_pinword("21U4LUR") == ["2", "1U", "4LUR"]
    assert PinWords.factor_pinword("3L1LD11") == ["3L", "1LD", "1", "1"]
    assert PinWords.factor_pinword("14ULU33") == ["1", "4ULU", "3", "3"]
    assert PinWords.factor_pinword("442D2D3") == ["4", "4", "2D", "2D", "3"]
    assert PinWords.factor_pinword("4RD333R") == ["4RD", "3", "3", "3R"]


def test_sp_to_m():
    assert PinWords.sp_to_m("") == ("",)
    assert PinWords.sp_to_m("1") == ("RU", "UR")
    assert PinWords.sp_to_m("2") == ("LU", "UL")
    assert PinWords.sp_to_m("3") == ("LD", "DL")
    assert PinWords.sp_to_m("4") == ("RD", "DR")
    assert PinWords.sp_to_m("1U") == ("URU",)
    assert PinWords.sp_to_m("1D") == ("URD",)
    assert PinWords.sp_to_m("1L") == ("RUL",)
    assert PinWords.sp_to_m("1R") == ("RUR",)
    assert PinWords.sp_to_m("2U") == ("ULU",)
    assert PinWords.sp_to_m("2D") == ("ULD",)
    assert PinWords.sp_to_m("2L") == ("LUL",)
    assert PinWords.sp_to_m("2R") == ("LUR",)
    assert PinWords.sp_to_m("3U") == ("DLU",)
    assert PinWords.sp_to_m("3D") == ("DLD",)
    assert PinWords.sp_to_m("3L") == ("LDL",)
    assert PinWords.sp_to_m("3R") == ("LDR",)
    assert PinWords.sp_to_m("4U") == ("DRU",)
    assert PinWords.sp_to_m("4D") == ("DRD",)
    assert PinWords.sp_to_m("4L") == ("RDL",)
    assert PinWords.sp_to_m("4R") == ("RDR",)
    assert PinWords.sp_to_m("1UL") == ("URUL",)
    assert PinWords.sp_to_m("1UR") == ("URUR",)
    assert PinWords.sp_to_m("1DL") == ("URDL",)
    assert PinWords.sp_to_m("1DR") == ("URDR",)
    assert PinWords.sp_to_m("1LU") == ("RULU",)
    assert PinWords.sp_to_m("1LD") == ("RULD",)
    assert PinWords.sp_to_m("1RU") == ("RURU",)
    assert PinWords.sp_to_m("1RD") == ("RURD",)
    assert PinWords.sp_to_m("2UL") == ("ULUL",)
    assert PinWords.sp_to_m("2UR") == ("ULUR",)
    assert PinWords.sp_to_m("2DL") == ("ULDL",)
    assert PinWords.sp_to_m("2DR") == ("ULDR",)
    assert PinWords.sp_to_m("2LU") == ("LULU",)
    assert PinWords.sp_to_m("2LD") == ("LULD",)
    assert PinWords.sp_to_m("2RU") == ("LURU",)
    assert PinWords.sp_to_m("2RD") == ("LURD",)
    assert PinWords.sp_to_m("3UL") == ("DLUL",)
    assert PinWords.sp_to_m("3UR") == ("DLUR",)
    assert PinWords.sp_to_m("3DL") == ("DLDL",)
    assert PinWords.sp_to_m("3DR") == ("DLDR",)
    assert PinWords.sp_to_m("3LU") == ("LDLU",)
    assert PinWords.sp_to_m("3LD") == ("LDLD",)
    assert PinWords.sp_to_m("3RU") == ("LDRU",)
    assert PinWords.sp_to_m("3RD") == ("LDRD",)
    assert PinWords.sp_to_m("4UL") == ("DRUL",)
    assert PinWords.sp_to_m("4UR") == ("DRUR",)
    assert PinWords.sp_to_m("4DL") == ("DRDL",)
    assert PinWords.sp_to_m("4DR") == ("DRDR",)
    assert PinWords.sp_to_m("4LU") == ("RDLU",)
    assert PinWords.sp_to_m("4LD") == ("RDLD",)
    assert PinWords.sp_to_m("4RU") == ("RDRU",)
    assert PinWords.sp_to_m("4RD") == ("RDRD",)
    assert PinWords.sp_to_m("1LDR") == ("RULDR",)
    assert PinWords.sp_to_m("2URU") == ("ULURU",)
    assert PinWords.sp_to_m("3RDR") == ("LDRDR",)
    assert PinWords.sp_to_m("2LUL") == ("LULUL",)
    assert PinWords.sp_to_m("1DRU") == ("URDRU",)
    assert PinWords.sp_to_m("3ULD") == ("DLULD",)
    assert PinWords.sp_to_m("3RDL") == ("LDRDL",)
    assert PinWords.sp_to_m("3DRU") == ("DLDRU",)
    assert PinWords.sp_to_m("2LDR") == ("LULDR",)
    assert PinWords.sp_to_m("3DRD") == ("DLDRD",)
    assert PinWords.sp_to_m("4DRUL") == ("DRDRUL",)
    assert PinWords.sp_to_m("2LDLD") == ("LULDLD",)
    assert PinWords.sp_to_m("4DRDL") == ("DRDRDL",)
    assert PinWords.sp_to_m("1ULUL") == ("URULUL",)
    assert PinWords.sp_to_m("2LDLD") == ("LULDLD",)
    assert PinWords.sp_to_m("4DRDL") == ("DRDRDL",)
    assert PinWords.sp_to_m("3ULUL") == ("DLULUL",)
    assert PinWords.sp_to_m("4DRUR") == ("DRDRUR",)
    assert PinWords.sp_to_m("1RULU") == ("RURULU",)
    assert PinWords.sp_to_m("1RURU") == ("RURURU",)
    assert PinWords.sp_to_m("3DRULD") == ("DLDRULD",)
    assert PinWords.sp_to_m("3RDLUR") == ("LDRDLUR",)
    assert PinWords.sp_to_m("1LDLDL") == ("RULDLDL",)
    assert PinWords.sp_to_m("1LURUR") == ("RULURUR",)
    assert PinWords.sp_to_m("1RULUL") == ("RURULUL",)
    assert PinWords.sp_to_m("1DLDLD") == ("URDLDLD",)
    assert PinWords.sp_to_m("4URULU") == ("DRURULU",)
    assert PinWords.sp_to_m("3RDRDL") == ("LDRDRDL",)
    assert PinWords.sp_to_m("2ULDLU") == ("ULULDLU",)
    assert PinWords.sp_to_m("2DLURD") == ("ULDLURD",)


def test_m_to_sp():
    assert PinWords.m_to_sp("LUR") == "2R"
    assert PinWords.m_to_sp("LD") == "3"
    assert PinWords.m_to_sp("RUL") == "1L"
    assert PinWords.m_to_sp("DL") == "3"
    assert PinWords.m_to_sp("DRU") == "4U"
    assert PinWords.m_to_sp("DRDL") == "4DL"
    assert PinWords.m_to_sp("RUR") == "1R"
    assert PinWords.m_to_sp("RDL") == "4L"
    assert PinWords.m_to_sp("DLD") == "3D"
    assert PinWords.m_to_sp("URU") == "1U"
    assert PinWords.m_to_sp("RDR") == "4R"
    assert PinWords.m_to_sp("ULU") == "2U"
    assert PinWords.m_to_sp("LDL") == "3L"
    assert PinWords.m_to_sp("LDRUL") == "3RUL"
    assert PinWords.m_to_sp("ULD") == "2D"
    assert PinWords.m_to_sp("URUR") == "1UR"


def test_quadrant():
    assert PinWords.quadrant("1", 0) == "1"
    assert PinWords.quadrant("2", 0) == "2"
    assert PinWords.quadrant("3", 0) == "3"
    assert PinWords.quadrant("4", 0) == "4"
    assert PinWords.quadrant("1U", 0) == "1"
    assert PinWords.quadrant("1U", 1) == "1"
    assert PinWords.quadrant("1D", 0) == "1"
    assert PinWords.quadrant("1D", 1) == "4"
    assert PinWords.quadrant("1L", 0) == "1"
    assert PinWords.quadrant("1L", 1) == "2"
    assert PinWords.quadrant("1R", 0) == "1"
    assert PinWords.quadrant("1R", 1) == "1"
    assert PinWords.quadrant("11", 0) == "1"
    assert PinWords.quadrant("11", 1) == "1"
    assert PinWords.quadrant("12", 0) == "1"
    assert PinWords.quadrant("12", 1) == "2"
    assert PinWords.quadrant("13", 0) == "1"
    assert PinWords.quadrant("13", 1) == "3"
    assert PinWords.quadrant("14", 0) == "1"
    assert PinWords.quadrant("14", 1) == "4"
    assert PinWords.quadrant("2U", 0) == "2"
    assert PinWords.quadrant("2U", 1) == "2"
    assert PinWords.quadrant("2D", 0) == "2"
    assert PinWords.quadrant("2D", 1) == "3"
    assert PinWords.quadrant("2L", 0) == "2"
    assert PinWords.quadrant("2L", 1) == "2"
    assert PinWords.quadrant("2R", 0) == "2"
    assert PinWords.quadrant("2R", 1) == "1"
    assert PinWords.quadrant("21", 0) == "2"
    assert PinWords.quadrant("21", 1) == "1"
    assert PinWords.quadrant("22", 0) == "2"
    assert PinWords.quadrant("22", 1) == "2"
    assert PinWords.quadrant("23", 0) == "2"
    assert PinWords.quadrant("23", 1) == "3"
    assert PinWords.quadrant("24", 0) == "2"
    assert PinWords.quadrant("24", 1) == "4"
    assert PinWords.quadrant("3U", 0) == "3"
    assert PinWords.quadrant("3U", 1) == "2"
    assert PinWords.quadrant("3D", 0) == "3"
    assert PinWords.quadrant("3D", 1) == "3"
    assert PinWords.quadrant("3L", 0) == "3"
    assert PinWords.quadrant("3L", 1) == "3"
    assert PinWords.quadrant("3R", 0) == "3"
    assert PinWords.quadrant("3R", 1) == "4"
    assert PinWords.quadrant("31", 0) == "3"
    assert PinWords.quadrant("31", 1) == "1"
    assert PinWords.quadrant("32", 0) == "3"
    assert PinWords.quadrant("32", 1) == "2"
    assert PinWords.quadrant("33", 0) == "3"
    assert PinWords.quadrant("33", 1) == "3"
    assert PinWords.quadrant("34", 0) == "3"
    assert PinWords.quadrant("34", 1) == "4"
    assert PinWords.quadrant("4U", 0) == "4"
    assert PinWords.quadrant("4U", 1) == "1"
    assert PinWords.quadrant("4D", 0) == "4"
    assert PinWords.quadrant("4D", 1) == "4"
    assert PinWords.quadrant("4L", 0) == "4"
    assert PinWords.quadrant("4L", 1) == "3"
    assert PinWords.quadrant("4R", 0) == "4"
    assert PinWords.quadrant("4R", 1) == "4"
    assert PinWords.quadrant("41", 0) == "4"
    assert PinWords.quadrant("41", 1) == "1"
    assert PinWords.quadrant("42", 0) == "4"
    assert PinWords.quadrant("42", 1) == "2"
    assert PinWords.quadrant("43", 0) == "4"
    assert PinWords.quadrant("43", 1) == "3"
    assert PinWords.quadrant("44", 0) == "4"
    assert PinWords.quadrant("44", 1) == "4"
    assert PinWords.quadrant("224", 0) == "2"
    assert PinWords.quadrant("224", 1) == "2"
    assert PinWords.quadrant("224", 2) == "4"
    assert PinWords.quadrant("4UR", 0) == "4"
    assert PinWords.quadrant("4UR", 1) == "1"
    assert PinWords.quadrant("4UR", 2) == "1"
    assert PinWords.quadrant("4D4", 0) == "4"
    assert PinWords.quadrant("4D4", 1) == "4"
    assert PinWords.quadrant("4D4", 2) == "4"
    assert PinWords.quadrant("224", 0) == "2"
    assert PinWords.quadrant("224", 1) == "2"
    assert PinWords.quadrant("224", 2) == "4"
    assert PinWords.quadrant("4UR", 0) == "4"
    assert PinWords.quadrant("4UR", 1) == "1"
    assert PinWords.quadrant("4UR", 2) == "1"
    assert PinWords.quadrant("2U3L", 0) == "2"
    assert PinWords.quadrant("2U3L", 1) == "2"
    assert PinWords.quadrant("2U3L", 2) == "3"
    assert PinWords.quadrant("2U3L", 3) == "3"
    assert PinWords.quadrant("3L3D", 0) == "3"
    assert PinWords.quadrant("3L3D", 1) == "3"
    assert PinWords.quadrant("3L3D", 2) == "3"
    assert PinWords.quadrant("3L3D", 3) == "3"
    assert PinWords.quadrant("2D44", 0) == "2"
    assert PinWords.quadrant("2D44", 1) == "3"
    assert PinWords.quadrant("2D44", 2) == "4"
    assert PinWords.quadrant("2D44", 3) == "4"
    assert PinWords.quadrant("12L3", 0) == "1"
    assert PinWords.quadrant("12L3", 1) == "2"
    assert PinWords.quadrant("12L3", 2) == "2"
    assert PinWords.quadrant("12L3", 3) == "3"
    assert PinWords.quadrant("4R42", 0) == "4"
    assert PinWords.quadrant("4R42", 1) == "4"
    assert PinWords.quadrant("4R42", 2) == "4"
    assert PinWords.quadrant("4R42", 3) == "2"
    assert PinWords.quadrant("243U1", 0) == "2"
    assert PinWords.quadrant("243U1", 1) == "4"
    assert PinWords.quadrant("243U1", 2) == "3"
    assert PinWords.quadrant("243U1", 3) == "2"
    assert PinWords.quadrant("243U1", 4) == "1"
    assert PinWords.quadrant("14U4R", 0) == "1"
    assert PinWords.quadrant("14U4R", 1) == "4"
    assert PinWords.quadrant("14U4R", 2) == "1"
    assert PinWords.quadrant("14U4R", 3) == "4"
    assert PinWords.quadrant("14U4R", 4) == "4"
    assert PinWords.quadrant("224UL", 0) == "2"
    assert PinWords.quadrant("224UL", 1) == "2"
    assert PinWords.quadrant("224UL", 2) == "4"
    assert PinWords.quadrant("224UL", 3) == "1"
    assert PinWords.quadrant("224UL", 4) == "2"
    assert PinWords.quadrant("44343", 0) == "4"
    assert PinWords.quadrant("44343", 1) == "4"
    assert PinWords.quadrant("44343", 2) == "3"
    assert PinWords.quadrant("44343", 3) == "4"
    assert PinWords.quadrant("44343", 4) == "3"
    assert PinWords.quadrant("13U44", 0) == "1"
    assert PinWords.quadrant("13U44", 1) == "3"
    assert PinWords.quadrant("13U44", 2) == "2"
    assert PinWords.quadrant("13U44", 3) == "4"
    assert PinWords.quadrant("13U44", 4) == "4"
    assert PinWords.quadrant("21DL42", 0) == "2"
    assert PinWords.quadrant("21DL42", 1) == "1"
    assert PinWords.quadrant("21DL42", 2) == "4"
    assert PinWords.quadrant("21DL42", 3) == "3"
    assert PinWords.quadrant("21DL42", 4) == "4"
    assert PinWords.quadrant("21DL42", 5) == "2"
    assert PinWords.quadrant("424U3R", 0) == "4"
    assert PinWords.quadrant("424U3R", 1) == "2"
    assert PinWords.quadrant("424U3R", 2) == "4"
    assert PinWords.quadrant("424U3R", 3) == "1"
    assert PinWords.quadrant("424U3R", 4) == "3"
    assert PinWords.quadrant("424U3R", 5) == "4"
    assert PinWords.quadrant("1U343R", 0) == "1"
    assert PinWords.quadrant("1U343R", 1) == "1"
    assert PinWords.quadrant("1U343R", 2) == "3"
    assert PinWords.quadrant("1U343R", 3) == "4"
    assert PinWords.quadrant("1U343R", 4) == "3"
    assert PinWords.quadrant("1U343R", 5) == "4"
    assert PinWords.quadrant("4R2U14", 0) == "4"
    assert PinWords.quadrant("4R2U14", 1) == "4"
    assert PinWords.quadrant("4R2U14", 2) == "2"
    assert PinWords.quadrant("4R2U14", 3) == "2"
    assert PinWords.quadrant("4R2U14", 4) == "1"
    assert PinWords.quadrant("4R2U14", 5) == "4"
    assert PinWords.quadrant("4R2R11", 0) == "4"
    assert PinWords.quadrant("4R2R11", 1) == "4"
    assert PinWords.quadrant("4R2R11", 2) == "2"
    assert PinWords.quadrant("4R2R11", 3) == "1"
    assert PinWords.quadrant("4R2R11", 4) == "1"
    assert PinWords.quadrant("4R2R11", 5) == "1"


def test_pinword_occurrences_sp():
    assert list(PinWords.pinword_occurrences_sp("1", "4")) == []
    assert list(PinWords.pinword_occurrences_sp("2", "1")) == []
    assert list(PinWords.pinword_occurrences_sp("3", "1")) == []
    assert list(PinWords.pinword_occurrences_sp("4", "4")) == [0]
    assert list(PinWords.pinword_occurrences_sp("1U", "4U")) == []
    assert list(PinWords.pinword_occurrences_sp("1D", "1D")) == [0]
    assert list(PinWords.pinword_occurrences_sp("1L", "1L")) == [0]
    assert list(PinWords.pinword_occurrences_sp("1R", "1")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("11", "1")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("12", "2")) == [1]
    assert list(PinWords.pinword_occurrences_sp("13", "3")) == [1]
    assert list(PinWords.pinword_occurrences_sp("14", "1")) == [0]
    assert list(PinWords.pinword_occurrences_sp("2U", "2")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("2D", "2")) == [0]
    assert list(PinWords.pinword_occurrences_sp("2L", "2L")) == [0]
    assert list(PinWords.pinword_occurrences_sp("2R", "2R")) == [0]
    assert list(PinWords.pinword_occurrences_sp("21", "2")) == [0]
    assert list(PinWords.pinword_occurrences_sp("22", "2")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("23", "2")) == [0]
    assert list(PinWords.pinword_occurrences_sp("24", "2")) == [0]
    assert list(PinWords.pinword_occurrences_sp("3U", "3")) == [0]
    assert list(PinWords.pinword_occurrences_sp("3D", "3")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("3L", "3")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("3R", "4")) == [1]
    assert list(PinWords.pinword_occurrences_sp("31", "3")) == [0]
    assert list(PinWords.pinword_occurrences_sp("32", "2")) == [1]
    assert list(PinWords.pinword_occurrences_sp("33", "3")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("34", "4")) == [1]
    assert list(PinWords.pinword_occurrences_sp("4U", "4")) == [0]
    assert list(PinWords.pinword_occurrences_sp("4D", "4")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("4L", "4")) == [0]
    assert list(PinWords.pinword_occurrences_sp("4R", "4")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("41", "1")) == [1]
    assert list(PinWords.pinword_occurrences_sp("42", "4")) == [0]
    assert list(PinWords.pinword_occurrences_sp("43", "4")) == [0]
    assert list(PinWords.pinword_occurrences_sp("44", "4")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("1U1", "1")) == [0, 1, 2]
    assert list(PinWords.pinword_occurrences_sp("2RU", "1")) == [1, 2]
    assert list(PinWords.pinword_occurrences_sp("33L", "3")) == [0, 1, 2]
    assert list(PinWords.pinword_occurrences_sp("234", "3")) == [1]
    assert list(PinWords.pinword_occurrences_sp("13L", "1")) == [0]
    assert list(PinWords.pinword_occurrences_sp("2D2L", "2")) == [0, 2, 3]
    assert list(PinWords.pinword_occurrences_sp("4L2U", "2")) == [2, 3]
    assert list(PinWords.pinword_occurrences_sp("13R3", "3R")) == [1]
    assert list(PinWords.pinword_occurrences_sp("34L4", "3")) == [0, 2]
    assert list(PinWords.pinword_occurrences_sp("11L3", "1")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("32142", "4")) == [3]
    assert list(PinWords.pinword_occurrences_sp("33311", "1")) == [3, 4]
    assert list(PinWords.pinword_occurrences_sp("134L3", "1")) == [0]
    assert list(PinWords.pinword_occurrences_sp("4R4D3", "3")) == [4]
    assert list(PinWords.pinword_occurrences_sp("3U421", "3")) == [0]
    assert list(PinWords.pinword_occurrences_sp("4ULULD", "4U")) == [0]
    assert list(PinWords.pinword_occurrences_sp("4D2U41", "2")) == [2, 3]
    assert list(PinWords.pinword_occurrences_sp("313D4D", "1")) == [1]
    assert list(PinWords.pinword_occurrences_sp("331R14", "3")) == [0, 1]
    assert list(PinWords.pinword_occurrences_sp("3LU1DL", "4L")) == [4]


def test_pinword_contains_sp():
    assert PinWords.pinword_contains_sp("1", "2") is False
    assert PinWords.pinword_contains_sp("2", "4") is False
    assert PinWords.pinword_contains_sp("3", "1") is False
    assert PinWords.pinword_contains_sp("4", "4") is True
    assert PinWords.pinword_contains_sp("1U", "4") is False
    assert PinWords.pinword_contains_sp("1D", "3") is False
    assert PinWords.pinword_contains_sp("1L", "3L") is False
    assert PinWords.pinword_contains_sp("1R", "3D") is False
    assert PinWords.pinword_contains_sp("11", "4") is False
    assert PinWords.pinword_contains_sp("12", "3") is False
    assert PinWords.pinword_contains_sp("13", "1L") is False
    assert PinWords.pinword_contains_sp("14", "3") is False
    assert PinWords.pinword_contains_sp("2U", "4") is False
    assert PinWords.pinword_contains_sp("2D", "3") is True
    assert PinWords.pinword_contains_sp("2L", "2") is True
    assert PinWords.pinword_contains_sp("2R", "2R") is True
    assert PinWords.pinword_contains_sp("21", "2L") is False
    assert PinWords.pinword_contains_sp("22", "4") is False
    assert PinWords.pinword_contains_sp("23", "2R") is False
    assert PinWords.pinword_contains_sp("24", "4R") is False
    assert PinWords.pinword_contains_sp("3U", "2") is True
    assert PinWords.pinword_contains_sp("3D", "1R") is False
    assert PinWords.pinword_contains_sp("3L", "2") is False
    assert PinWords.pinword_contains_sp("3R", "3") is True
    assert PinWords.pinword_contains_sp("31", "1D") is False
    assert PinWords.pinword_contains_sp("32", "1") is False
    assert PinWords.pinword_contains_sp("33", "2D") is False
    assert PinWords.pinword_contains_sp("34", "3") is True
    assert PinWords.pinword_contains_sp("4U", "1D") is False
    assert PinWords.pinword_contains_sp("4D", "4") is True
    assert PinWords.pinword_contains_sp("4L", "2") is False
    assert PinWords.pinword_contains_sp("4R", "1D") is False
    assert PinWords.pinword_contains_sp("41", "3") is False
    assert PinWords.pinword_contains_sp("42", "3") is False
    assert PinWords.pinword_contains_sp("43", "2") is False
    assert PinWords.pinword_contains_sp("44", "1U") is False
    assert PinWords.pinword_contains_sp("43U", "4") is True
    assert PinWords.pinword_contains_sp("213", "4DL") is False
    assert PinWords.pinword_contains_sp("4U3", "3L") is False
    assert PinWords.pinword_contains_sp("12U", "1") is True
    assert PinWords.pinword_contains_sp("421", "3DL") is False
    assert PinWords.pinword_contains_sp("42D4", "4") is True
    assert PinWords.pinword_contains_sp("43D3", "1DL") is False
    assert PinWords.pinword_contains_sp("44D3", "1") is False
    assert PinWords.pinword_contains_sp("341L", "3L") is False
    assert PinWords.pinword_contains_sp("14U2", "3UL") is False
    assert PinWords.pinword_contains_sp("4RU3D", "1ULD") is False
    assert PinWords.pinword_contains_sp("11D34", "1LDLU") is False
    assert PinWords.pinword_contains_sp("311U3", "1U") is True
    assert PinWords.pinword_contains_sp("34LDR", "3D") is True
    assert PinWords.pinword_contains_sp("12UR1", "2URD") is False
    assert PinWords.pinword_contains_sp("3L44LU", "1") is False
    assert PinWords.pinword_contains_sp("133223", "4LDR") is False
    assert PinWords.pinword_contains_sp("4D4413", "4LDRUL") is False
    assert PinWords.pinword_contains_sp("23U2L3", "1DL") is False
    assert PinWords.pinword_contains_sp("1L3UL4", "3RDL") is False


def test_pinword_occurences():
    assert list(PinWords.pinword_occurrences("1", "1")) == [(0,)]
    assert list(PinWords.pinword_occurrences("2", "1")) == []
    assert list(PinWords.pinword_occurrences("3", "4")) == []
    assert list(PinWords.pinword_occurrences("4", "2")) == []
    assert list(PinWords.pinword_occurrences("1U", "2")) == []
    assert list(PinWords.pinword_occurrences("1D", "1")) == [(0,)]
    assert list(PinWords.pinword_occurrences("1L", "2")) == [(1,)]
    assert list(PinWords.pinword_occurrences("1R", "1")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("11", "1")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("12", "1")) == [(0,)]
    assert list(PinWords.pinword_occurrences("13", "3")) == [(1,)]
    assert list(PinWords.pinword_occurrences("14", "4")) == [(1,)]
    assert list(PinWords.pinword_occurrences("2U", "2")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("2D", "2")) == [(0,)]
    assert list(PinWords.pinword_occurrences("2L", "2")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("2R", "2")) == [(0,)]
    assert list(PinWords.pinword_occurrences("21", "2")) == [(0,)]
    assert list(PinWords.pinword_occurrences("22", "2")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("23", "2")) == [(0,)]
    assert list(PinWords.pinword_occurrences("24", "2")) == [(0,)]
    assert list(PinWords.pinword_occurrences("3U", "2")) == [(1,)]
    assert list(PinWords.pinword_occurrences("3D", "3")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("3L", "3")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("3R", "4")) == [(1,)]
    assert list(PinWords.pinword_occurrences("31", "3")) == [(0,)]
    assert list(PinWords.pinword_occurrences("32", "2")) == [(1,)]
    assert list(PinWords.pinword_occurrences("33", "3")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("34", "4")) == [(1,)]
    assert list(PinWords.pinword_occurrences("4U", "4")) == [(0,)]
    assert list(PinWords.pinword_occurrences("4D", "4")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("4L", "3")) == [(1,)]
    assert list(PinWords.pinword_occurrences("4R", "4")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("41", "1")) == [(1,)]
    assert list(PinWords.pinword_occurrences("42", "4")) == [(0,)]
    assert list(PinWords.pinword_occurrences("43", "4")) == [(0,)]
    assert list(PinWords.pinword_occurrences("44", "4")) == [(0,), (1,)]
    assert list(PinWords.pinword_occurrences("2R4", "4")) == [(2,)]
    assert list(PinWords.pinword_occurrences("242", "4")) == [(1,)]
    assert list(PinWords.pinword_occurrences("23R", "2")) == [(0,)]
    assert list(PinWords.pinword_occurrences("12R", "1")) == [(0,), (2,)]
    assert list(PinWords.pinword_occurrences("4D1", "4D")) == [(0,)]
    assert list(PinWords.pinword_occurrences("4RDR", "4D")) == [(1,)]
    assert list(PinWords.pinword_occurrences("142U", "2")) == [(2,), (3,)]
    assert list(PinWords.pinword_occurrences("3U31", "1")) == [(3,)]
    assert list(PinWords.pinword_occurrences("121U", "12")) == [(0, 1)]
    assert list(PinWords.pinword_occurrences("1423", "2")) == [(2,)]
    assert list(PinWords.pinword_occurrences("41DR1", "4")) == [(0,), (2,), (3,)]
    assert list(PinWords.pinword_occurrences("211R3", "11")) == [(1, 2), (1, 3), (2, 3)]
    assert list(PinWords.pinword_occurrences("4334D", "4D")) == [(3,)]
    assert list(PinWords.pinword_occurrences("13RU2", "1")) == [(0,), (3,)]
    assert list(PinWords.pinword_occurrences("34321", "21")) == [(3, 4)]
    assert list(PinWords.pinword_occurrences("4DL44L", "3")) == [(2,), (5,)]
    assert list(PinWords.pinword_occurrences("1L1RUR", "1L1U")) == [(0, 3)]
    assert list(PinWords.pinword_occurrences("1R31L2", "1")) == [(0,), (1,), (3,)]
    assert list(PinWords.pinword_occurrences("1U13RU", "41")) == [(4, 5)]
    assert list(PinWords.pinword_occurrences("2232D2", "2")) == [(0,), (1,), (3,), (5,)]


def test_pinword_contains():
    assert PinWords.pinword_contains("1", "3") is False
    assert PinWords.pinword_contains("2", "4") is False
    assert PinWords.pinword_contains("3", "1") is False
    assert PinWords.pinword_contains("4", "2") is False
    assert PinWords.pinword_contains("1U", "21") is False
    assert PinWords.pinword_contains("1D", "1") is True
    assert PinWords.pinword_contains("1L", "2D") is False
    assert PinWords.pinword_contains("1R", "12") is False
    assert PinWords.pinword_contains("11", "1") is True
    assert PinWords.pinword_contains("12", "12") is True
    assert PinWords.pinword_contains("13", "31") is False
    assert PinWords.pinword_contains("14", "2") is False
    assert PinWords.pinword_contains("2U", "3") is False
    assert PinWords.pinword_contains("2D", "3L") is False
    assert PinWords.pinword_contains("2L", "4U") is False
    assert PinWords.pinword_contains("2R", "1L") is False
    assert PinWords.pinword_contains("21", "2D") is False
    assert PinWords.pinword_contains("22", "4L") is False
    assert PinWords.pinword_contains("23", "24") is False
    assert PinWords.pinword_contains("24", "2U") is False
    assert PinWords.pinword_contains("3U", "1") is False
    assert PinWords.pinword_contains("3D", "3") is True
    assert PinWords.pinword_contains("3L", "3D") is False
    assert PinWords.pinword_contains("3R", "2") is False
    assert PinWords.pinword_contains("31", "32") is False
    assert PinWords.pinword_contains("32", "2") is True
    assert PinWords.pinword_contains("33", "3R") is False
    assert PinWords.pinword_contains("34", "14") is False
    assert PinWords.pinword_contains("4U", "31") is False
    assert PinWords.pinword_contains("4D", "1") is False
    assert PinWords.pinword_contains("4L", "3U") is False
    assert PinWords.pinword_contains("4R", "3") is False
    assert PinWords.pinword_contains("41", "1") is True
    assert PinWords.pinword_contains("42", "3") is False
    assert PinWords.pinword_contains("43", "1") is False
    assert PinWords.pinword_contains("44", "34") is False
    assert PinWords.pinword_contains("43D", "3L") is False
    assert PinWords.pinword_contains("3R4", "22") is False
    assert PinWords.pinword_contains("213", "1") is True
    assert PinWords.pinword_contains("4D3", "3") is True
    assert PinWords.pinword_contains("111", "4RD") is False
    assert PinWords.pinword_contains("4DR2", "1L32") is False
    assert PinWords.pinword_contains("1UR3", "1") is True
    assert PinWords.pinword_contains("23L1", "4U1") is False
    assert PinWords.pinword_contains("2424", "32") is False
    assert PinWords.pinword_contains("14D2", "3") is False
    assert PinWords.pinword_contains("4ULD3", "442") is False
    assert PinWords.pinword_contains("41413", "3R1D") is False
    assert PinWords.pinword_contains("1D4D2", "4D3") is False
    assert PinWords.pinword_contains("2U1UR", "3244L") is False
    assert PinWords.pinword_contains("1RU13", "3U2L1") is False
    assert PinWords.pinword_contains("11D4R3", "241D") is False
    assert PinWords.pinword_contains("211214", "2") is True
    assert PinWords.pinword_contains("42DRD2", "341") is False
    assert PinWords.pinword_contains("2L41DR", "2") is True
    assert PinWords.pinword_contains("32D4U3", "3D") is False


def test_make_nfa_for_pinword():
    assert PinWords.make_nfa_for_pinword("1") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("2") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("3") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"2", "0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"L": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("4") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("1U") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0", "1"}, "L": {"0"}, "D": {"0"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"U": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("1D") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0", "1"}, "L": {"0"}, "D": {"0"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"D": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("1L") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "1": {"U": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"L": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("1R") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "1": {"U": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"R": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("11") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("12") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("13") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("14") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("2U") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0", "1"}, "L": {"0"}, "D": {"0"}, "R": {"0"}},
            "1": {"L": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"U": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("2D") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0", "1"}, "L": {"0"}, "D": {"0"}, "R": {"0"}},
            "1": {"L": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"D": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("2L") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "1": {"U": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"L": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("2R") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "1": {"U": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"R": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("21") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("22") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("23") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("24") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("3U") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"L": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"U": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("3D") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"L": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"D": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("3L") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "1": {"D": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"L": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("3R") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "1": {"D": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"R": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("31") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"2", "0"}, "R": {"0"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "1": {"D": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("32") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"2", "0"}, "R": {"0"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("33") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"2", "0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("34") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"2", "0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "1": {"D": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("4U") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"U": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("4D") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"D": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("4L") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "1": {"D": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"L": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("4R") == NFA(
        states={"2", "3", "0", "1"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "1": {"D": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"3"}, "R": {"3"}},
            "2": {"R": {"3"}},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_nfa_for_pinword("41") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("42") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("43") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("44") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("1D4") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0", "1"}, "L": {"0"}, "D": {"0"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "2": {"D": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("3R4") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "1": {"D": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("1L4") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "1": {"U": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("4D3") == NFA(
        states={"6", "3", "2", "4", "5", "1", "0"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "2": {"D": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
        },
        initial_state="0",
        final_states={"6"},
    )
    assert PinWords.make_nfa_for_pinword("413") == NFA(
        states={"6", "3", "9", "1", "0", "7", "2", "4", "5", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"7", "6"}, "D": {"6", "8"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
            "9": {"U": {"9"}, "L": {"9"}, "D": {"9"}, "R": {"9"}},
            "7": {"D": {"9"}},
            "8": {"L": {"9"}},
        },
        initial_state="0",
        final_states={"9"},
    )
    assert PinWords.make_nfa_for_pinword("1111") == NFA(
        states={"6", "3", "10", "12", "9", "1", "0", "7", "2", "4", "5", "11", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6", "8"}, "L": {"6"}, "D": {"6"}, "R": {"7", "6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
            "9": {"U": {"11", "9"}, "L": {"9"}, "D": {"9"}, "R": {"10", "9"}},
            "7": {"U": {"9"}},
            "8": {"R": {"9"}},
            "12": {"U": {"12"}, "L": {"12"}, "D": {"12"}, "R": {"12"}},
            "10": {"U": {"12"}},
            "11": {"R": {"12"}},
        },
        initial_state="0",
        final_states={"12"},
    )
    assert PinWords.make_nfa_for_pinword("4413") == NFA(
        states={"6", "3", "10", "12", "9", "1", "0", "7", "2", "4", "5", "11", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6", "8"}, "L": {"6"}, "D": {"6"}, "R": {"7", "6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
            "9": {"U": {"9"}, "L": {"10", "9"}, "D": {"11", "9"}, "R": {"9"}},
            "7": {"U": {"9"}},
            "8": {"R": {"9"}},
            "12": {"U": {"12"}, "L": {"12"}, "D": {"12"}, "R": {"12"}},
            "10": {"D": {"12"}},
            "11": {"L": {"12"}},
        },
        initial_state="0",
        final_states={"12"},
    )
    assert PinWords.make_nfa_for_pinword("1U41") == NFA(
        states={"6", "3", "9", "1", "0", "7", "2", "4", "5", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0", "1"}, "L": {"0"}, "D": {"0"}, "R": {"0"}},
            "1": {"R": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "2": {"U": {"3"}},
            "6": {"U": {"6", "8"}, "L": {"6"}, "D": {"6"}, "R": {"7", "6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
            "9": {"U": {"9"}, "L": {"9"}, "D": {"9"}, "R": {"9"}},
            "7": {"U": {"9"}},
            "8": {"R": {"9"}},
        },
        initial_state="0",
        final_states={"9"},
    )
    assert PinWords.make_nfa_for_pinword("23R3") == NFA(
        states={"6", "3", "9", "1", "0", "7", "2", "4", "5", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "4": {"D": {"5"}},
            "6": {"U": {"6"}, "L": {"7", "6"}, "D": {"6", "8"}, "R": {"6"}},
            "5": {"R": {"6"}},
            "9": {"U": {"9"}, "L": {"9"}, "D": {"9"}, "R": {"9"}},
            "7": {"D": {"9"}},
            "8": {"L": {"9"}},
        },
        initial_state="0",
        final_states={"9"},
    )
    assert PinWords.make_nfa_for_pinword("2L24") == NFA(
        states={"6", "3", "9", "1", "0", "7", "2", "4", "5", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "1": {"U": {"2"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6", "8"}, "R": {"7", "6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
            "9": {"U": {"9"}, "L": {"9"}, "D": {"9"}, "R": {"9"}},
            "7": {"D": {"9"}},
            "8": {"R": {"9"}},
        },
        initial_state="0",
        final_states={"9"},
    )
    assert PinWords.make_nfa_for_pinword("222D4") == NFA(
        states={"6", "3", "10", "12", "9", "1", "0", "7", "2", "4", "5", "11", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"7", "6"}, "L": {"6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
            "7": {"L": {"8"}},
            "9": {"U": {"9"}, "L": {"9"}, "D": {"11", "9"}, "R": {"10", "9"}},
            "8": {"D": {"9"}},
            "12": {"U": {"12"}, "L": {"12"}, "D": {"12"}, "R": {"12"}},
            "10": {"D": {"12"}},
            "11": {"R": {"12"}},
        },
        initial_state="0",
        final_states={"12"},
    )
    assert PinWords.make_nfa_for_pinword("12322") == NFA(
        states={
            "6",
            "3",
            "10",
            "9",
            "7",
            "2",
            "11",
            "8",
            "12",
            "1",
            "15",
            "0",
            "4",
            "5",
            "13",
            "14",
        },
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"7", "6"}, "D": {"6", "8"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
            "9": {"U": {"11", "9"}, "L": {"10", "9"}, "D": {"9"}, "R": {"9"}},
            "7": {"D": {"9"}},
            "8": {"L": {"9"}},
            "12": {"U": {"12", "14"}, "L": {"12", "13"}, "D": {"12"}, "R": {"12"}},
            "10": {"U": {"12"}},
            "11": {"L": {"12"}},
            "15": {"U": {"15"}, "L": {"15"}, "D": {"15"}, "R": {"15"}},
            "13": {"U": {"15"}},
            "14": {"L": {"15"}},
        },
        initial_state="0",
        final_states={"15"},
    )
    assert PinWords.make_nfa_for_pinword("23132") == NFA(
        states={
            "6",
            "3",
            "10",
            "9",
            "7",
            "2",
            "11",
            "8",
            "12",
            "1",
            "15",
            "0",
            "4",
            "5",
            "13",
            "14",
        },
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"2", "0"}, "L": {"0", "1"}, "D": {"0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"U": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6", "8"}, "L": {"6"}, "D": {"6"}, "R": {"7", "6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
            "9": {"U": {"9"}, "L": {"10", "9"}, "D": {"11", "9"}, "R": {"9"}},
            "7": {"U": {"9"}},
            "8": {"R": {"9"}},
            "12": {"U": {"12", "14"}, "L": {"12", "13"}, "D": {"12"}, "R": {"12"}},
            "10": {"D": {"12"}},
            "11": {"L": {"12"}},
            "15": {"U": {"15"}, "L": {"15"}, "D": {"15"}, "R": {"15"}},
            "13": {"U": {"15"}},
            "14": {"L": {"15"}},
        },
        initial_state="0",
        final_states={"15"},
    )
    assert PinWords.make_nfa_for_pinword("43411") == NFA(
        states={
            "6",
            "3",
            "10",
            "9",
            "7",
            "2",
            "11",
            "8",
            "12",
            "1",
            "15",
            "0",
            "4",
            "5",
            "13",
            "14",
        },
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"6", "8"}, "R": {"7", "6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
            "9": {"U": {"11", "9"}, "L": {"9"}, "D": {"9"}, "R": {"10", "9"}},
            "7": {"D": {"9"}},
            "8": {"R": {"9"}},
            "12": {"U": {"12", "14"}, "L": {"12"}, "D": {"12"}, "R": {"12", "13"}},
            "10": {"U": {"12"}},
            "11": {"R": {"12"}},
            "15": {"U": {"15"}, "L": {"15"}, "D": {"15"}, "R": {"15"}},
            "13": {"U": {"15"}},
            "14": {"R": {"15"}},
        },
        initial_state="0",
        final_states={"15"},
    )
    assert PinWords.make_nfa_for_pinword("1R43R") == NFA(
        states={"6", "3", "9", "1", "0", "7", "2", "4", "5", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0"}, "R": {"0", "1"}},
            "1": {"U": {"2"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"5", "3"}, "R": {"4", "3"}},
            "2": {"R": {"3"}},
            "6": {"U": {"6"}, "L": {"7", "6"}, "D": {"6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"R": {"6"}},
            "7": {"D": {"8"}},
            "9": {"U": {"9"}, "L": {"9"}, "D": {"9"}, "R": {"9"}},
            "8": {"R": {"9"}},
        },
        initial_state="0",
        final_states={"9"},
    )
    assert PinWords.make_nfa_for_pinword("333DRU") == NFA(
        states={"6", "3", "10", "9", "1", "0", "7", "2", "4", "5", "11", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0", "1"}, "D": {"2", "0"}, "R": {"0"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"5", "3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"L": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"7", "6"}, "R": {"6"}},
            "4": {"D": {"6"}},
            "5": {"L": {"6"}},
            "7": {"L": {"8"}},
            "8": {"D": {"9"}},
            "9": {"R": {"10"}},
            "11": {"U": {"11"}, "L": {"11"}, "D": {"11"}, "R": {"11"}},
            "10": {"U": {"11"}},
        },
        initial_state="0",
        final_states={"11"},
    )
    assert PinWords.make_nfa_for_pinword("43U2R2") == NFA(
        states={"6", "3", "10", "12", "9", "1", "0", "7", "2", "4", "5", "11", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"3"}, "D": {"4", "3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "4": {"L": {"5"}},
            "6": {"U": {"6"}, "L": {"7", "6"}, "D": {"6"}, "R": {"6"}},
            "5": {"U": {"6"}},
            "7": {"U": {"8"}},
            "9": {"U": {"11", "9"}, "L": {"10", "9"}, "D": {"9"}, "R": {"9"}},
            "8": {"R": {"9"}},
            "12": {"U": {"12"}, "L": {"12"}, "D": {"12"}, "R": {"12"}},
            "10": {"U": {"12"}},
            "11": {"L": {"12"}},
        },
        initial_state="0",
        final_states={"12"},
    )
    assert PinWords.make_nfa_for_pinword("3D2234") == NFA(
        states={
            "6",
            "3",
            "10",
            "9",
            "7",
            "2",
            "11",
            "8",
            "12",
            "1",
            "15",
            "0",
            "4",
            "5",
            "13",
            "14",
        },
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"L": {"2"}},
            "3": {"U": {"5", "3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "2": {"D": {"3"}},
            "6": {"U": {"6", "8"}, "L": {"7", "6"}, "D": {"6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"L": {"6"}},
            "9": {"U": {"9"}, "L": {"10", "9"}, "D": {"11", "9"}, "R": {"9"}},
            "7": {"U": {"9"}},
            "8": {"L": {"9"}},
            "12": {"U": {"12"}, "L": {"12"}, "D": {"12", "14"}, "R": {"12", "13"}},
            "10": {"D": {"12"}},
            "11": {"L": {"12"}},
            "15": {"U": {"15"}, "L": {"15"}, "D": {"15"}, "R": {"15"}},
            "13": {"D": {"15"}},
            "14": {"R": {"15"}},
        },
        initial_state="0",
        final_states={"15"},
    )
    assert PinWords.make_nfa_for_pinword("43R332") == NFA(
        states={
            "6",
            "3",
            "10",
            "9",
            "7",
            "2",
            "11",
            "8",
            "12",
            "1",
            "15",
            "0",
            "4",
            "5",
            "13",
            "14",
        },
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"2", "0"}, "R": {"0", "1"}},
            "3": {"U": {"3"}, "L": {"4", "3"}, "D": {"3"}, "R": {"3"}},
            "1": {"D": {"3"}},
            "2": {"R": {"3"}},
            "4": {"D": {"5"}},
            "6": {"U": {"6"}, "L": {"7", "6"}, "D": {"6", "8"}, "R": {"6"}},
            "5": {"R": {"6"}},
            "9": {"U": {"9"}, "L": {"10", "9"}, "D": {"11", "9"}, "R": {"9"}},
            "7": {"D": {"9"}},
            "8": {"L": {"9"}},
            "12": {"U": {"12", "14"}, "L": {"12", "13"}, "D": {"12"}, "R": {"12"}},
            "10": {"D": {"12"}},
            "11": {"L": {"12"}},
            "15": {"U": {"15"}, "L": {"15"}, "D": {"15"}, "R": {"15"}},
            "13": {"U": {"15"}},
            "14": {"L": {"15"}},
        },
        initial_state="0",
        final_states={"15"},
    )
    assert PinWords.make_nfa_for_pinword("3D13DR") == NFA(
        states={"6", "3", "10", "9", "1", "0", "7", "2", "4", "5", "8"},
        input_symbols={"U", "D", "L", "R"},
        transitions={
            "0": {"U": {"0"}, "L": {"0"}, "D": {"0", "1"}, "R": {"0"}},
            "1": {"L": {"2"}},
            "3": {"U": {"5", "3"}, "L": {"3"}, "D": {"3"}, "R": {"4", "3"}},
            "2": {"D": {"3"}},
            "6": {"U": {"6"}, "L": {"6"}, "D": {"7", "6"}, "R": {"6"}},
            "4": {"U": {"6"}},
            "5": {"R": {"6"}},
            "7": {"L": {"8"}},
            "8": {"D": {"9"}},
            "10": {"U": {"10"}, "L": {"10"}, "D": {"10"}, "R": {"10"}},
            "9": {"R": {"10"}},
        },
        initial_state="0",
        final_states={"10"},
    )


def test_make_dfa_for_m():
    assert PinWords.make_dfa_for_m() == DFA(
        states={"0", "1", "2", "3"},
        input_symbols=set("ULDR"),
        transitions={
            "0": {"U": "1", "D": "1", "L": "2", "R": "2"},
            "1": {"U": "3", "D": "3", "L": "2", "R": "2"},
            "2": {"U": "1", "D": "1", "L": "3", "R": "3"},
            "3": {"U": "3", "D": "3", "L": "3", "R": "3"},
        },
        initial_state="0",
        final_states={"0", "1", "2"},
    )


def test_make_dfa_for_pinword():
    assert PinWords.make_dfa_for_pinword("1D") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0,1}", "D": "{0}", "L": "{0}"},
            "{0,1}": {"R": "{0,2}", "U": "{0,1}", "D": "{0}", "L": "{0}"},
            "{0,2}": {
                "R": "{0}",
                "U": "{0,1}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("4U") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0,1}", "L": "{0}"},
            "{0,1}": {"R": "{0,2}", "U": "{0}", "D": "{0,1}", "L": "{0}"},
            "{0,2}": {
                "R": "{0}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,1}",
                "L": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("4U") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0,1}", "L": "{0}"},
            "{0,1}": {"R": "{0,2}", "U": "{0}", "D": "{0,1}", "L": "{0}"},
            "{0,2}": {
                "R": "{0}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,1}",
                "L": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("11") == DFA(
        states={
            "{0,2}",
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{0}",
            "{0,1}",
            "{0,1,3,4}",
            "{0,2,3,5}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0,1}", "U": "{0,2}", "D": "{0}", "L": "{0}"},
            "{0,1}": {
                "R": "{0,1}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0}",
                "L": "{0}",
            },
            "{0,2}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,2}",
                "D": "{0}",
                "L": "{0}",
            },
            "{0,1,3,4}": {
                "R": "{0,1,3,4}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,2,3,5}": {
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "U": "{0,2,3,5}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}": {
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{0,1,3,4}",
                "U": "{0,2,3,5}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}"},
    )
    assert PinWords.make_dfa_for_pinword("31") == DFA(
        states={
            "{{0,1,3},{0,2,3}}",
            "{0,2}",
            "{0,3,5}",
            "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
            "{0}",
            "{0,1}",
            "{0,3,4}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0,2}", "L": "{0,1}"},
            "{0,2}": {"R": "{0}", "U": "{0}", "D": "{0,2}", "L": "{{0,1,3},{0,2,3}}"},
            "{0,1}": {"R": "{0}", "U": "{0}", "D": "{{0,1,3},{0,2,3}}", "L": "{0,1}"},
            "{0,3,4}": {
                "R": "{0,3,4}",
                "U": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "D": "{{0,1,3},{0,2,3}}",
                "L": "{{0,1,3},{0,2,3}}",
            },
            "{0,3,5}": {
                "R": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "U": "{0,3,5}",
                "D": "{{0,1,3},{0,2,3}}",
                "L": "{{0,1,3},{0,2,3}}",
            },
            "{{0,1,3},{0,2,3}}": {
                "R": "{0,3,4}",
                "U": "{0,3,5}",
                "D": "{{0,1,3},{0,2,3}}",
                "L": "{{0,1,3},{0,2,3}}",
            },
            "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}": {
                "R": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "U": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "D": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "L": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}"},
    )
    assert PinWords.make_dfa_for_pinword("1R") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0,1}", "U": "{0}", "D": "{0}", "L": "{0}"},
            "{0,1}": {"R": "{0,1}", "U": "{0,2}", "D": "{0}", "L": "{0}"},
            "{0,2}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "D": "{0}",
                "L": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("2L") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0}", "L": "{0,1}"},
            "{0,1}": {"R": "{0}", "U": "{0,2}", "D": "{0}", "L": "{0,1}"},
            "{0,2}": {
                "R": "{0}",
                "U": "{0}",
                "D": "{0}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("2R2") == DFA(
        states={
            "{0,3}",
            "{0,3,5}",
            "{0,2}",
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            "{0}",
            "{0,1}",
            "{0,1,3,4}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0}", "L": "{0,1}"},
            "{0,1}": {"R": "{0}", "U": "{0,2}", "D": "{0}", "L": "{0,1}"},
            "{0,2}": {"R": "{0,3}", "U": "{0}", "D": "{0}", "L": "{0,1}"},
            "{0,3}": {"R": "{0,3}", "U": "{0,3,5}", "D": "{0,3}", "L": "{0,1,3,4}"},
            "{0,3,5}": {
                "R": "{0,3}",
                "U": "{0,3,5}",
                "D": "{0,3}",
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,4}": {
                "R": "{0,3}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{0,3}",
                "L": "{0,1,3,4}",
            },
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}": {
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}"},
    )
    assert PinWords.make_dfa_for_pinword("1") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0,1}", "U": "{0,2}", "D": "{0}", "L": "{0}"},
            "{0,1}": {
                "R": "{0,1}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0}",
                "L": "{0}",
            },
            "{0,2}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,2}",
                "D": "{0}",
                "L": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("2R") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0}", "L": "{0,1}"},
            "{0,1}": {"R": "{0}", "U": "{0,2}", "D": "{0}", "L": "{0,1}"},
            "{0,2}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "D": "{0}",
                "L": "{0,1}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("43LU") == DFA(
        states={
            "{0,2}",
            "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{0,3,4,6}",
            "{0}",
            "{0,1}",
            "{0,3,4}",
            "{0,2,3,5}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0,1}", "U": "{0}", "D": "{0,2}", "L": "{0}"},
            "{0,1}": {
                "R": "{0,1}",
                "U": "{0}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0}",
            },
            "{0,2}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "D": "{0,2}",
                "L": "{0}",
            },
            "{0,3,4}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,2,3,5}",
                "L": "{0,3,4}",
            },
            "{0,2,3,5}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0,3,4,6}",
            },
            "{0,3,4,6}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}",
                "D": "{0,2,3,5}",
                "L": "{0,3,4}",
            },
            "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}": {
                "R": "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}",
                "U": "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}",
                "D": "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}",
                "L": "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0,3,4}",
            },
        },
        initial_state="{0}",
        final_states={
            "{{0,1,3,7},{0,2,3,5,7},{0,2,3,7},{0,3,4,6,7},{0,3,4,7},{0,3,7}}"
        },
    )
    assert PinWords.make_dfa_for_pinword("3U") == DFA(
        states={"{0,2}", "{0}", "{0,1}", "{{0,1,3},{0,2,3},{0,3}}"},
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0,1}", "L": "{0}"},
            "{0,1}": {"R": "{0}", "U": "{0}", "D": "{0,1}", "L": "{0,2}"},
            "{0,2}": {
                "R": "{0}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,1}",
                "L": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.make_dfa_for_pinword("44") == DFA(
        states={
            "{0,2}",
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{0}",
            "{0,1}",
            "{0,1,3,4}",
            "{0,2,3,5}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0,1}", "U": "{0}", "D": "{0,2}", "L": "{0}"},
            "{0,1}": {
                "R": "{0,1}",
                "U": "{0}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0}",
            },
            "{0,2}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "D": "{0,2}",
                "L": "{0}",
            },
            "{0,1,3,4}": {
                "R": "{0,1,3,4}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,2,3,5}": {
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,2,3,5}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}": {
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{0,1,3,4}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,2,3,5}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,4,6},{0,2,3,5,6},{0,3,6}}"},
    )
    assert PinWords.make_dfa_for_pinword("32") == DFA(
        states={
            "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
            "{0,2}",
            "{0,3,5}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{0}",
            "{0,1}",
            "{0,1,3,4}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0,2}", "L": "{0,1}"},
            "{0,2}": {
                "R": "{0}",
                "U": "{0}",
                "D": "{0,2}",
                "L": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,1}": {
                "R": "{0}",
                "U": "{0}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0,1}",
            },
            "{0,3,5}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,3,5}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,4}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0,1,3,4}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "R": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,3,5}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "L": "{0,1,3,4}",
            },
            "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}": {
                "R": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}"},
    )
    assert PinWords.make_dfa_for_pinword("2R2") == DFA(
        states={
            "{0,3}",
            "{0,3,5}",
            "{0,2}",
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            "{0}",
            "{0,1}",
            "{0,1,3,4}",
        },
        input_symbols={"R", "U", "D", "L"},
        transitions={
            "{0}": {"R": "{0}", "U": "{0}", "D": "{0}", "L": "{0,1}"},
            "{0,1}": {"R": "{0}", "U": "{0,2}", "D": "{0}", "L": "{0,1}"},
            "{0,2}": {"R": "{0,3}", "U": "{0}", "D": "{0}", "L": "{0,1}"},
            "{0,3}": {"R": "{0,3}", "U": "{0,3,5}", "D": "{0,3}", "L": "{0,1,3,4}"},
            "{0,3,5}": {
                "R": "{0,3}",
                "U": "{0,3,5}",
                "D": "{0,3}",
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,4}": {
                "R": "{0,3}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{0,3}",
                "L": "{0,1,3,4}",
            },
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}": {
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}"},
    )


def test_dfa_name_reset():
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("1UR2")) == DFA(
        states={
            "{0,1}",
            "{0,4,5}",
            "{{0,2,4},{0,4}}",
            "{0,2}",
            "{0,1,3}",
            "{{0,1,3,4,6},{0,1,4,6}}",
            "{0}",
            "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0,1}", "R": "{0}"},
            "{0,1}": {"L": "{0}", "D": "{0}", "U": "{0,1}", "R": "{0,2}"},
            "{0,2}": {"L": "{0}", "D": "{0}", "U": "{0,1,3}", "R": "{0}"},
            "{0,1,3}": {"L": "{0}", "D": "{0}", "U": "{0,1}", "R": "{{0,2,4},{0,4}}"},
            "{0,4,5}": {
                "L": "{0,4,5}",
                "D": "{{0,2,4},{0,4}}",
                "U": "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
                "R": "{{0,2,4},{0,4}}",
            },
            "{{0,1,3,4,6},{0,1,4,6}}": {
                "L": "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
                "D": "{{0,2,4},{0,4}}",
                "U": "{{0,1,3,4,6},{0,1,4,6}}",
                "R": "{{0,2,4},{0,4}}",
            },
            "{{0,2,4},{0,4}}": {
                "L": "{0,4,5}",
                "D": "{{0,2,4},{0,4}}",
                "U": "{{0,1,3,4,6},{0,1,4,6}}",
                "R": "{{0,2,4},{0,4}}",
            },
            "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}": {
                "L": "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
                "D": "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
                "U": "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
                "R": "{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,4,6,7},{0,1,4,6,7},{0,2,4,7},{0,4,5,7},{0,4,7}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("3D23")) == DFA(
        states={
            "{0,1}",
            "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}",
            "{{0,1,3},{0,3}}",
            "{{0,2,3,4},{0,3,4}}",
            "{0,1,3,6,8}",
            "{0,2}",
            "{0,3,4,6,7}",
            "{0}",
            "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
            "{0,3,5}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0,1}", "U": "{0}", "R": "{0}"},
            "{0,1}": {"L": "{0,2}", "D": "{0,1}", "U": "{0}", "R": "{0}"},
            "{0,2}": {"L": "{0}", "D": "{{0,1,3},{0,3}}", "U": "{0}", "R": "{0}"},
            "{0,3,5}": {
                "L": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3},{0,3}}",
                "U": "{0,3,5}",
                "R": "{{0,1,3},{0,3}}",
            },
            "{0,3,4,6,7}": {
                "L": "{0,3,4,6,7}",
                "D": (
                    "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},"
                    "{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
                ),
                "U": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,6,8}": {
                "L": (
                    "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},"
                    "{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
                ),
                "D": "{0,1,3,6,8}",
                "U": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
            },
            "{{0,2,3,4},{0,3,4}}": {
                "L": "{{0,2,3,4},{0,3,4}}",
                "D": "{{0,1,3},{0,3}}",
                "U": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,1,3},{0,3}}",
            },
            "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}": {
                "L": (
                    "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},"
                    "{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
                ),
                "D": (
                    "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},"
                    "{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
                ),
                "U": (
                    "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},"
                    "{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
                ),
                "R": (
                    "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},"
                    "{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
                ),
            },
            "{{0,3,4,6},{0,3,5,6},{0,3,6}}": {
                "L": "{0,3,4,6,7}",
                "D": "{0,1,3,6,8}",
                "U": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,3,4,6},{0,3,5,6},{0,3,6}}",
            },
            "{{0,1,3},{0,3}}": {
                "L": "{{0,2,3,4},{0,3,4}}",
                "D": "{{0,1,3},{0,3}}",
                "U": "{0,3,5}",
                "R": "{{0,1,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={
            "{{0,1,3,6,8,9},{0,2,3,4,6,7,9},{0,3,4,6,7,9},{0,3,5,6,9},{0,3,6,9}}"
        },
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("141R4")) == DFA(
        states={
            "{0,1}",
            "{0,2,3,6,8}",
            "{0}",
            "{0,1,3,4,6,7}",
            "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
            "{0,1,3,4}",
            "{0,2}",
            (
                "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
            ),
            "{0,1,10,3,4,6,7,9}",
            "{0,3,5}",
            "{0,11,3,5,6,9}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0,2}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0}",
                "U": "{0,2}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,1}": {
                "L": "{0}",
                "D": "{0}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{0,1}",
            },
            "{0,3,5}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,3,5}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,4}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{0,1,3,4}",
            },
            "{0,1,3,4,6,7}": {
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,2,3,6,8}",
                "R": "{0,1,3,4,6,7}",
            },
            "{0,2,3,6,8}": {
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
            },
            "{0,11,3,5,6,9}": {
                "L": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
                "D": "{0,11,3,5,6,9}",
                "U": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
                "R": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                    "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
            },
            "{0,1,10,3,4,6,7,9}": {
                "L": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
                "D": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                    "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "U": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
                "R": "{0,1,10,3,4,6,7,9}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0,3,5}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{0,1,3,4}",
            },
            "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}": {
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,4,6},{0,2,3,6},{0,3,5,6},{0,3,6}}",
                "R": "{0,1,3,4,6,7}",
            },
            (
                "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
            ): {
                "L": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                    "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "D": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                    "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "U": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                    "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "R": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},"
                    "{0,12,2,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
            },
            "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}": {
                "L": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
                "D": "{0,11,3,5,6,9}",
                "U": "{{0,1,3,4,6,7,9},{0,2,3,6,8,9},{0,2,3,6,9},{0,3,6,9}}",
                "R": "{0,1,10,3,4,6,7,9}",
            },
        },
        initial_state="{0}",
        final_states={
            (
                "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,9},{0,12,2,3,6,8,9},"
                "{0,12,2,3,6,9},{0,12,3,6,9}}"
            )
        },
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("1R")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,1}": {"L": "{0}", "D": "{0}", "U": "{0,2}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("2L")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0,1}", "D": "{0}", "U": "{0}", "R": "{0}"},
            "{0,1}": {"L": "{0,1}", "D": "{0}", "U": "{0,2}", "R": "{0}"},
            "{0,2}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0}",
                "U": "{0}",
                "R": "{0}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("4L2")) == DFA(
        states={
            "{0,1}",
            "{0,2}",
            "{0,3,4}",
            "{0,3,5}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{0}",
            "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,1}": {"L": "{0}", "D": "{0,2}", "U": "{0}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{0}",
                "U": "{0}",
                "R": "{0,1}",
            },
            "{0,3,4}": {
                "L": "{0,3,4}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,3,5}": {
                "L": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,3,5}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{0,3,4}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,3,5}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}": {
                "L": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "U": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
                "R": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6},{0,3,6}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("3R")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0,1}", "D": "{0}", "U": "{0}", "R": "{0}"},
            "{0,1}": {"L": "{0,1}", "D": "{0,2}", "U": "{0}", "R": "{0}"},
            "{0,2}": {
                "L": "{0,1}",
                "D": "{0}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("41R11")) == DFA(
        states={
            "{{0,3,5,6,8},{0,3,6,8}}",
            "{0,1}",
            "{0}",
            "{0,1,3,4,6,7}",
            "{{0,1,3},{0,2,3},{0,3}}",
            "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
            "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
            "{0,1,3,4}",
            "{0,2}",
            "{{0,11,3,5,6,8,9},{0,11,3,6,8,9}}",
            (
                "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},{0,11,12,3,6,8,9},"
                "{0,12,2,3,6,9},{0,12,3,6,9}}"
            ),
            "{0,1,10,3,4,6,7,9}",
            "{0,3,5}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0,2}", "U": "{0}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0,2}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,1}": {
                "L": "{0}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "R": "{0,1}",
            },
            "{0,1,3,4}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0,3,5}",
                "R": "{0,1,3,4}",
            },
            "{0,3,5}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
            },
            "{0,1,3,4,6,7}": {
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
                "U": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "R": "{0,1,3,4,6,7}",
            },
            "{0,1,10,3,4,6,7,9}": {
                "L": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "D": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "U": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},"
                    "{0,11,12,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "R": "{0,1,10,3,4,6,7,9}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{0,1,3,4}",
            },
            "{{0,3,5,6,8},{0,3,6,8}}": {
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
                "U": "{{0,3,5,6,8},{0,3,6,8}}",
                "R": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
            },
            "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}": {
                "L": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,6},{0,3,6}}",
                "U": "{{0,3,5,6,8},{0,3,6,8}}",
                "R": "{0,1,3,4,6,7}",
            },
            (
                "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},{0,11,12,3,6,8,9},"
                "{0,12,2,3,6,9},{0,12,3,6,9}}"
            ): {
                "L": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},"
                    "{0,11,12,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "D": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},"
                    "{0,11,12,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "U": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},"
                    "{0,11,12,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
                "R": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},"
                    "{0,11,12,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
            },
            "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}": {
                "L": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "D": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "U": "{{0,11,3,5,6,8,9},{0,11,3,6,8,9}}",
                "R": "{0,1,10,3,4,6,7,9}",
            },
            "{{0,11,3,5,6,8,9},{0,11,3,6,8,9}}": {
                "L": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "D": "{{0,1,3,4,6,7,9},{0,2,3,6,9},{0,3,5,6,8,9},{0,3,6,9}}",
                "U": "{{0,11,3,5,6,8,9},{0,11,3,6,8,9}}",
                "R": (
                    "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},"
                    "{0,11,12,3,6,8,9},{0,12,2,3,6,9},{0,12,3,6,9}}"
                ),
            },
        },
        initial_state="{0}",
        final_states={
            (
                "{{0,1,10,12,3,4,6,7,9},{0,11,12,3,5,6,8,9},{0,11,12,3,6,8,9},"
                "{0,12,2,3,6,9},{0,12,3,6,9}}"
            )
        },
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("4L41D4")) == DFA(
        states={
            "{0,3,6,7}",
            "{0,1}",
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            "{0,1,3,4,6,8}",
            "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
            (
                "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
            ),
            "{0,3}",
            "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}",
            "{0,1,3,4}",
            "{0,2}",
            "{0}",
            "{0,3,5}",
            "{0,11,3,5,6,9}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,1}": {"L": "{0}", "D": "{0,2}", "U": "{0}", "R": "{0,1}"},
            "{0,2}": {"L": "{0,3}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,3}": {"L": "{0,3}", "D": "{0,3,5}", "U": "{0,3}", "R": "{0,1,3,4}"},
            "{0,3,5}": {
                "L": "{0,3}",
                "D": "{0,3,5}",
                "U": "{0,3}",
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,4}": {
                "L": "{0,3}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,3}",
                "R": "{0,1,3,4}",
            },
            "{0,3,6,7}": {
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,3,6,7}",
                "R": "{0,1,3,4,6,8}",
            },
            "{0,1,3,4,6,8}": {
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "U": "{0,3,6,7}",
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,11,3,5,6,9}": {
                "L": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "D": "{0,11,3,5,6,9}",
                "U": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "R": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
            },
            "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}": {
                "L": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "D": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "U": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "R": "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}",
            },
            (
                "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
            ): {
                "L": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "D": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "U": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "R": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
            },
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}": {
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,3,6,7}",
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}": {
                "L": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "D": "{0,11,3,5,6,9}",
                "U": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "R": "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}",
            },
        },
        initial_state="{0}",
        final_states={
            (
                "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
            )
        },
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("4")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0,2}", "U": "{0}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0,2}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,1}": {
                "L": "{0}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "R": "{0,1}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("1R")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,1}": {"L": "{0}", "D": "{0}", "U": "{0,2}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("4L41D4")) == DFA(
        states={
            "{0,3,6,7}",
            "{0,1}",
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            "{0,1,3,4,6,8}",
            "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
            (
                "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
            ),
            "{0,3}",
            "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}",
            "{0,1,3,4}",
            "{0,2}",
            "{0}",
            "{0,3,5}",
            "{0,11,3,5,6,9}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,1}": {"L": "{0}", "D": "{0,2}", "U": "{0}", "R": "{0,1}"},
            "{0,2}": {"L": "{0,3}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,3}": {"L": "{0,3}", "D": "{0,3,5}", "U": "{0,3}", "R": "{0,1,3,4}"},
            "{0,3,5}": {
                "L": "{0,3}",
                "D": "{0,3,5}",
                "U": "{0,3}",
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,1,3,4}": {
                "L": "{0,3}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,3}",
                "R": "{0,1,3,4}",
            },
            "{0,3,6,7}": {
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,3,6,7}",
                "R": "{0,1,3,4,6,8}",
            },
            "{0,1,3,4,6,8}": {
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "U": "{0,3,6,7}",
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{0,11,3,5,6,9}": {
                "L": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "D": "{0,11,3,5,6,9}",
                "U": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "R": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
            },
            "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}": {
                "L": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "D": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "U": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "R": "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}",
            },
            (
                "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
            ): {
                "L": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "D": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "U": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
                "R": (
                    "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                    "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
                ),
            },
            "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}": {
                "L": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "D": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
                "U": "{0,3,6,7}",
                "R": "{{0,1,3,4,6},{0,2,3,5,6},{0,3,5,6},{0,3,6}}",
            },
            "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}": {
                "L": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "D": "{0,11,3,5,6,9}",
                "U": "{{0,2,3,5,6,9},{0,3,6,7,9},{0,3,6,9}}",
                "R": "{{0,1,10,3,4,6,8,9},{0,1,10,3,4,6,9}}",
            },
        },
        initial_state="{0}",
        final_states={
            (
                "{{0,1,10,12,3,4,6,8,9},{0,1,10,12,3,4,6,9},{0,11,12,2,3,5,6,9},"
                "{0,11,12,3,5,6,9},{0,12,3,6,7,9},{0,12,3,6,9}}"
            )
        },
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("4")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0,2}", "U": "{0}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0,2}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{0,1}": {
                "L": "{0}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{0}",
                "R": "{0,1}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("31")) == DFA(
        states={
            "{0,1}",
            "{0,2}",
            "{0,3,4}",
            "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
            "{{0,1,3},{0,2,3}}",
            "{0}",
            "{0,3,5}",
        },
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0,1}", "D": "{0,2}", "U": "{0}", "R": "{0}"},
            "{0,1}": {"L": "{0,1}", "D": "{{0,1,3},{0,2,3}}", "U": "{0}", "R": "{0}"},
            "{0,2}": {"L": "{{0,1,3},{0,2,3}}", "D": "{0,2}", "U": "{0}", "R": "{0}"},
            "{0,3,5}": {
                "L": "{{0,1,3},{0,2,3}}",
                "D": "{{0,1,3},{0,2,3}}",
                "U": "{0,3,5}",
                "R": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
            },
            "{0,3,4}": {
                "L": "{{0,1,3},{0,2,3}}",
                "D": "{{0,1,3},{0,2,3}}",
                "U": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "R": "{0,3,4}",
            },
            "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}": {
                "L": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "D": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "U": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
                "R": "{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}",
            },
            "{{0,1,3},{0,2,3}}": {
                "L": "{{0,1,3},{0,2,3}}",
                "D": "{{0,1,3},{0,2,3}}",
                "U": "{0,3,5}",
                "R": "{0,3,4}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3,6},{0,2,3,6},{0,3,4,6},{0,3,5,6}}"},
    )
    assert PinWords.dfa_name_reset(PinWords.make_dfa_for_pinword("1R")) == DFA(
        states={"{{0,1,3},{0,2,3},{0,3}}", "{0,1}", "{0}", "{0,2}"},
        input_symbols={"L", "D", "U", "R"},
        transitions={
            "{0}": {"L": "{0}", "D": "{0}", "U": "{0}", "R": "{0,1}"},
            "{0,1}": {"L": "{0}", "D": "{0}", "U": "{0,2}", "R": "{0,1}"},
            "{0,2}": {
                "L": "{0}",
                "D": "{0}",
                "U": "{0}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
            "{{0,1,3},{0,2,3},{0,3}}": {
                "L": "{{0,1,3},{0,2,3},{0,3}}",
                "D": "{{0,1,3},{0,2,3},{0,3}}",
                "U": "{{0,1,3},{0,2,3},{0,3}}",
                "R": "{{0,1,3},{0,2,3},{0,3}}",
            },
        },
        initial_state="{0}",
        final_states={"{{0,1,3},{0,2,3},{0,3}}"},
    )


def test_make_dfa_for_perm():
    assert PinWords.make_dfa_for_perm(Perm.from_string("1032")) == DFA(
        states={
            "1",
            "11",
            "5",
            "16",
            "18",
            "10",
            "6",
            "12",
            "8",
            "0",
            "4",
            "2",
            "15",
            "13",
            "9",
            "14",
            "7",
            "3",
            "17",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "0", "D": "0", "U": "0"},
            "13": {"L": "13", "R": "1", "D": "4", "U": "18"},
            "18": {"L": "10", "R": "16", "D": "3", "U": "6"},
            "7": {"L": "14", "R": "18", "D": "7", "U": "11"},
            "15": {"L": "10", "R": "16", "D": "3", "U": "0"},
            "11": {"L": "18", "R": "14", "D": "7", "U": "11"},
            "2": {"L": "10", "R": "16", "D": "0", "U": "6"},
            "9": {"L": "10", "R": "0", "D": "3", "U": "6"},
            "14": {"L": "13", "R": "1", "D": "18", "U": "18"},
            "6": {"L": "10", "R": "15", "D": "3", "U": "6"},
            "3": {"L": "2", "R": "16", "D": "3", "U": "6"},
            "8": {"L": "0", "R": "16", "D": "3", "U": "6"},
            "16": {"L": "10", "R": "16", "D": "3", "U": "9"},
            "17": {"L": "1", "R": "13", "D": "17", "U": "17"},
            "4": {"L": "18", "R": "18", "D": "7", "U": "11"},
            "12": {"L": "12", "R": "12", "D": "11", "U": "7"},
            "10": {"L": "10", "R": "16", "D": "8", "U": "6"},
            "5": {"L": "12", "R": "12", "D": "17", "U": "17"},
            "1": {"L": "13", "R": "1", "D": "18", "U": "4"},
        },
        initial_state="5",
        final_states={"0"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("0312")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "21",
            "32",
            "4",
            "2",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "36",
            "9",
            "14",
            "7",
            "3",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "30", "D": "25", "U": "1"},
            "13": {"L": "6", "R": "10", "D": "32", "U": "32"},
            "19": {"L": "32", "R": "33", "D": "34", "U": "12"},
            "34": {"L": "32", "R": "10", "D": "34", "U": "12"},
            "11": {"L": "5", "R": "23", "D": "11", "U": "11"},
            "27": {"L": "15", "R": "15", "D": "11", "U": "11"},
            "2": {"L": "13", "R": "33", "D": "34", "U": "12"},
            "9": {"L": "3", "R": "33", "D": "17", "U": "7"},
            "14": {"L": "0", "R": "30", "D": "2", "U": "31"},
            "6": {"L": "6", "R": "10", "D": "32", "U": "1"},
            "3": {"L": "0", "R": "30", "D": "2", "U": "8"},
            "1": {"L": "21", "R": "33", "D": "34", "U": "12"},
            "29": {"L": "33", "R": "14", "D": "17", "U": "7"},
            "25": {"L": "20", "R": "14", "D": "17", "U": "7"},
            "33": {"L": "6", "R": "10", "D": "19", "U": "8"},
            "16": {"L": "3", "R": "14", "D": "17", "U": "7"},
            "4": {"L": "0", "R": "30", "D": "35", "U": "31"},
            "28": {"L": "33", "R": "33", "D": "17", "U": "7"},
            "37": {"L": "14", "R": "33", "D": "36", "U": "18"},
            "5": {"L": "23", "R": "5", "D": "37", "U": "16"},
            "21": {"L": "6", "R": "10", "D": "32", "U": "8"},
            "18": {"L": "24", "R": "4", "D": "36", "U": "18"},
            "7": {"L": "10", "R": "4", "D": "17", "U": "7"},
            "22": {"L": "0", "R": "30", "D": "2", "U": "28"},
            "15": {"L": "15", "R": "15", "D": "18", "U": "36"},
            "26": {"L": "0", "R": "30", "D": "35", "U": "32"},
            "35": {"L": "20", "R": "33", "D": "17", "U": "7"},
            "30": {"L": "0", "R": "30", "D": "35", "U": "29"},
            "8": {"L": "21", "R": "32", "D": "34", "U": "12"},
            "20": {"L": "0", "R": "30", "D": "2", "U": "32"},
            "23": {"L": "23", "R": "5", "D": "16", "U": "37"},
            "24": {"L": "23", "R": "5", "D": "1", "U": "9"},
            "17": {"L": "26", "R": "22", "D": "17", "U": "7"},
            "12": {"L": "6", "R": "33", "D": "34", "U": "12"},
            "36": {"L": "4", "R": "24", "D": "36", "U": "18"},
            "10": {"L": "6", "R": "10", "D": "19", "U": "1"},
            "32": {"L": "32", "R": "32", "D": "32", "U": "32"},
            "31": {"L": "33", "R": "32", "D": "17", "U": "7"},
        },
        initial_state="27",
        final_states={"32"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("ε")) == DFA(
        states={"{0}"},
        input_symbols={"L", "R", "D", "U"},
        transitions={"{0}": {"L": "{0}", "R": "{0}", "D": "{0}", "U": "{0}"}},
        initial_state="{0}",
        final_states={"{0}"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("1320")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "21",
            "32",
            "4",
            "2",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "36",
            "9",
            "14",
            "7",
            "3",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "34", "R": "26", "D": "3", "U": "0"},
            "13": {"L": "1", "R": "13", "D": "5", "U": "37"},
            "19": {"L": "17", "R": "27", "D": "10", "U": "21"},
            "34": {"L": "9", "R": "15", "D": "21", "U": "8"},
            "11": {"L": "28", "R": "26", "D": "3", "U": "0"},
            "27": {"L": "17", "R": "27", "D": "28", "U": "16"},
            "2": {"L": "9", "R": "15", "D": "30", "U": "8"},
            "9": {"L": "9", "R": "15", "D": "16", "U": "5"},
            "14": {"L": "24", "R": "28", "D": "29", "U": "16"},
            "6": {"L": "20", "R": "20", "D": "36", "U": "36"},
            "3": {"L": "23", "R": "31", "D": "3", "U": "0"},
            "29": {"L": "23", "R": "28", "D": "29", "U": "16"},
            "25": {"L": "9", "R": "15", "D": "21", "U": "28"},
            "33": {"L": "35", "R": "2", "D": "33", "U": "4"},
            "16": {"L": "23", "R": "7", "D": "29", "U": "16"},
            "4": {"L": "2", "R": "35", "D": "33", "U": "4"},
            "28": {"L": "28", "R": "28", "D": "28", "U": "28"},
            "37": {"L": "22", "R": "23", "D": "33", "U": "4"},
            "5": {"L": "25", "R": "26", "D": "3", "U": "0"},
            "21": {"L": "24", "R": "7", "D": "29", "U": "16"},
            "18": {"L": "9", "R": "15", "D": "21", "U": "21"},
            "7": {"L": "17", "R": "27", "D": "28", "U": "21"},
            "22": {"L": "9", "R": "15", "D": "30", "U": "21"},
            "15": {"L": "9", "R": "15", "D": "11", "U": "32"},
            "26": {"L": "9", "R": "15", "D": "12", "U": "21"},
            "35": {"L": "1", "R": "13", "D": "8", "U": "21"},
            "30": {"L": "24", "R": "19", "D": "3", "U": "0"},
            "8": {"L": "25", "R": "19", "D": "3", "U": "0"},
            "20": {"L": "20", "R": "20", "D": "4", "U": "33"},
            "23": {"L": "17", "R": "27", "D": "14", "U": "21"},
            "17": {"L": "17", "R": "27", "D": "29", "U": "21"},
            "24": {"L": "17", "R": "27", "D": "14", "U": "28"},
            "12": {"L": "28", "R": "19", "D": "3", "U": "0"},
            "36": {"L": "13", "R": "1", "D": "36", "U": "36"},
            "10": {"L": "28", "R": "28", "D": "29", "U": "16"},
            "32": {"L": "18", "R": "19", "D": "3", "U": "0"},
            "31": {"L": "9", "R": "15", "D": "12", "U": "8"},
            "1": {"L": "1", "R": "13", "D": "37", "U": "5"},
        },
        initial_state="6",
        final_states={"28"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("012")) == DFA(
        states={
            "12",
            "1",
            "9",
            "11",
            "8",
            "14",
            "7",
            "0",
            "5",
            "10",
            "13",
            "3",
            "6",
            "4",
            "2",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "12", "R": "1", "D": "0", "U": "5"},
            "13": {"L": "3", "R": "8", "D": "13", "U": "7"},
            "7": {"L": "11", "R": "3", "D": "13", "U": "7"},
            "11": {"L": "11", "R": "8", "D": "3", "U": "7"},
            "2": {"L": "2", "R": "6", "D": "12", "U": "10"},
            "9": {"L": "9", "R": "9", "D": "5", "U": "0"},
            "14": {"L": "9", "R": "9", "D": "4", "U": "4"},
            "6": {"L": "2", "R": "6", "D": "10", "U": "12"},
            "3": {"L": "3", "R": "3", "D": "3", "U": "3"},
            "8": {"L": "11", "R": "8", "D": "13", "U": "3"},
            "12": {"L": "11", "R": "8", "D": "13", "U": "7"},
            "4": {"L": "6", "R": "2", "D": "4", "U": "4"},
            "10": {"L": "12", "R": "12", "D": "0", "U": "5"},
            "5": {"L": "1", "R": "12", "D": "0", "U": "5"},
            "1": {"L": "2", "R": "6", "D": "12", "U": "12"},
        },
        initial_state="14",
        final_states={"3"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("0312")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "21",
            "32",
            "4",
            "2",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "36",
            "9",
            "14",
            "7",
            "3",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "30", "D": "25", "U": "1"},
            "13": {"L": "6", "R": "10", "D": "32", "U": "32"},
            "19": {"L": "32", "R": "33", "D": "34", "U": "12"},
            "34": {"L": "32", "R": "10", "D": "34", "U": "12"},
            "11": {"L": "5", "R": "23", "D": "11", "U": "11"},
            "27": {"L": "15", "R": "15", "D": "11", "U": "11"},
            "2": {"L": "13", "R": "33", "D": "34", "U": "12"},
            "9": {"L": "3", "R": "33", "D": "17", "U": "7"},
            "14": {"L": "0", "R": "30", "D": "2", "U": "31"},
            "6": {"L": "6", "R": "10", "D": "32", "U": "1"},
            "3": {"L": "0", "R": "30", "D": "2", "U": "8"},
            "1": {"L": "21", "R": "33", "D": "34", "U": "12"},
            "29": {"L": "33", "R": "14", "D": "17", "U": "7"},
            "25": {"L": "20", "R": "14", "D": "17", "U": "7"},
            "33": {"L": "6", "R": "10", "D": "19", "U": "8"},
            "16": {"L": "3", "R": "14", "D": "17", "U": "7"},
            "4": {"L": "0", "R": "30", "D": "35", "U": "31"},
            "28": {"L": "33", "R": "33", "D": "17", "U": "7"},
            "37": {"L": "14", "R": "33", "D": "36", "U": "18"},
            "5": {"L": "23", "R": "5", "D": "37", "U": "16"},
            "21": {"L": "6", "R": "10", "D": "32", "U": "8"},
            "18": {"L": "24", "R": "4", "D": "36", "U": "18"},
            "7": {"L": "10", "R": "4", "D": "17", "U": "7"},
            "22": {"L": "0", "R": "30", "D": "2", "U": "28"},
            "15": {"L": "15", "R": "15", "D": "18", "U": "36"},
            "26": {"L": "0", "R": "30", "D": "35", "U": "32"},
            "35": {"L": "20", "R": "33", "D": "17", "U": "7"},
            "30": {"L": "0", "R": "30", "D": "35", "U": "29"},
            "8": {"L": "21", "R": "32", "D": "34", "U": "12"},
            "20": {"L": "0", "R": "30", "D": "2", "U": "32"},
            "23": {"L": "23", "R": "5", "D": "16", "U": "37"},
            "24": {"L": "23", "R": "5", "D": "1", "U": "9"},
            "17": {"L": "26", "R": "22", "D": "17", "U": "7"},
            "12": {"L": "6", "R": "33", "D": "34", "U": "12"},
            "36": {"L": "4", "R": "24", "D": "36", "U": "18"},
            "10": {"L": "6", "R": "10", "D": "19", "U": "1"},
            "32": {"L": "32", "R": "32", "D": "32", "U": "32"},
            "31": {"L": "33", "R": "32", "D": "17", "U": "7"},
        },
        initial_state="27",
        final_states={"32"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("2310")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "46",
            "22",
            "10",
            "6",
            "40",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "48",
            "38",
            "21",
            "32",
            "44",
            "4",
            "41",
            "2",
            "42",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "45",
            "43",
            "36",
            "9",
            "39",
            "14",
            "7",
            "3",
            "47",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "36", "R": "23", "D": "24", "U": "0"},
            "46": {"L": "46", "R": "5", "D": "14", "U": "42"},
            "13": {"L": "16", "R": "39", "D": "11", "U": "13"},
            "19": {"L": "19", "R": "2", "D": "8", "U": "30"},
            "34": {"L": "22", "R": "2", "D": "8", "U": "34"},
            "45": {"L": "28", "R": "12", "D": "25", "U": "17"},
            "41": {"L": "26", "R": "41", "D": "9", "U": "31"},
            "48": {"L": "1", "R": "6", "D": "12", "U": "29"},
            "2": {"L": "19", "R": "2", "D": "15", "U": "34"},
            "9": {"L": "19", "R": "28", "D": "10", "U": "20"},
            "27": {"L": "18", "R": "40", "D": "11", "U": "13"},
            "14": {"L": "18", "R": "12", "D": "11", "U": "13"},
            "11": {"L": "3", "R": "12", "D": "11", "U": "13"},
            "6": {"L": "1", "R": "6", "D": "12", "U": "31"},
            "3": {"L": "46", "R": "5", "D": "43", "U": "42"},
            "29": {"L": "19", "R": "40", "D": "11", "U": "13"},
            "25": {"L": "23", "R": "12", "D": "25", "U": "17"},
            "33": {"L": "33", "R": "33", "D": "0", "U": "24"},
            "16": {"L": "46", "R": "5", "D": "43", "U": "15"},
            "4": {"L": "37", "R": "4", "D": "9", "U": "35"},
            "28": {"L": "46", "R": "5", "D": "43", "U": "34"},
            "47": {"L": "37", "R": "4", "D": "29", "U": "15"},
            "37": {"L": "37", "R": "4", "D": "27", "U": "44"},
            "5": {"L": "46", "R": "5", "D": "12", "U": "35"},
            "21": {"L": "22", "R": "40", "D": "11", "U": "13"},
            "18": {"L": "46", "R": "5", "D": "43", "U": "30"},
            "7": {"L": "41", "R": "26", "D": "7", "U": "7"},
            "22": {"L": "19", "R": "2", "D": "8", "U": "15"},
            "15": {"L": "15", "R": "15", "D": "15", "U": "15"},
            "26": {"L": "26", "R": "41", "D": "31", "U": "9"},
            "35": {"L": "16", "R": "40", "D": "11", "U": "13"},
            "40": {"L": "46", "R": "5", "D": "12", "U": "34"},
            "30": {"L": "15", "R": "2", "D": "8", "U": "34"},
            "43": {"L": "19", "R": "12", "D": "11", "U": "13"},
            "8": {"L": "19", "R": "15", "D": "8", "U": "34"},
            "39": {"L": "46", "R": "5", "D": "12", "U": "21"},
            "42": {"L": "15", "R": "40", "D": "11", "U": "13"},
            "38": {"L": "46", "R": "5", "D": "43", "U": "21"},
            "44": {"L": "15", "R": "28", "D": "10", "U": "20"},
            "20": {"L": "47", "R": "38", "D": "10", "U": "20"},
            "23": {"L": "1", "R": "6", "D": "43", "U": "29"},
            "17": {"L": "28", "R": "48", "D": "25", "U": "17"},
            "24": {"L": "23", "R": "36", "D": "24", "U": "0"},
            "12": {"L": "19", "R": "2", "D": "8", "U": "34"},
            "36": {"L": "37", "R": "4", "D": "29", "U": "34"},
            "10": {"L": "3", "R": "36", "D": "10", "U": "20"},
            "32": {"L": "33", "R": "33", "D": "7", "U": "7"},
            "31": {"L": "28", "R": "40", "D": "25", "U": "17"},
            "1": {"L": "1", "R": "6", "D": "45", "U": "29"},
        },
        initial_state="32",
        final_states={"15"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("2103")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "12",
            "8",
            "0",
            "20",
            "21",
            "4",
            "2",
            "19",
            "15",
            "13",
            "9",
            "14",
            "7",
            "3",
            "17",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "20", "D": "13", "U": "23"},
            "21": {"L": "21", "R": "11", "D": "21", "U": "12"},
            "13": {"L": "23", "R": "23", "D": "14", "U": "8"},
            "18": {"L": "18", "R": "5", "D": "3", "U": "7"},
            "7": {"L": "21", "R": "17", "D": "21", "U": "12"},
            "19": {"L": "0", "R": "20", "D": "23", "U": "23"},
            "22": {"L": "21", "R": "11", "D": "21", "U": "16"},
            "15": {"L": "18", "R": "5", "D": "10", "U": "6"},
            "11": {"L": "21", "R": "11", "D": "21", "U": "10"},
            "2": {"L": "20", "R": "0", "D": "2", "U": "2"},
            "9": {"L": "9", "R": "9", "D": "8", "U": "14"},
            "14": {"L": "19", "R": "23", "D": "14", "U": "8"},
            "6": {"L": "10", "R": "15", "D": "3", "U": "1"},
            "3": {"L": "18", "R": "22", "D": "3", "U": "1"},
            "8": {"L": "23", "R": "19", "D": "14", "U": "8"},
            "16": {"L": "10", "R": "10", "D": "21", "U": "12"},
            "20": {"L": "0", "R": "20", "D": "23", "U": "13"},
            "23": {"L": "18", "R": "5", "D": "3", "U": "1"},
            "17": {"L": "21", "R": "11", "D": "10", "U": "10"},
            "12": {"L": "21", "R": "10", "D": "21", "U": "12"},
            "4": {"L": "9", "R": "9", "D": "2", "U": "2"},
            "10": {"L": "10", "R": "10", "D": "10", "U": "10"},
            "5": {"L": "18", "R": "5", "D": "21", "U": "6"},
            "1": {"L": "21", "R": "15", "D": "3", "U": "1"},
        },
        initial_state="4",
        final_states={"10"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("2301")) == DFA(
        states={
            "1",
            "11",
            "5",
            "16",
            "18",
            "10",
            "6",
            "12",
            "8",
            "0",
            "4",
            "2",
            "15",
            "13",
            "9",
            "14",
            "7",
            "3",
            "17",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "12", "R": "3", "D": "0", "U": "17"},
            "13": {"L": "15", "R": "14", "D": "13", "U": "11"},
            "18": {"L": "8", "R": "18", "D": "7", "U": "12"},
            "7": {"L": "12", "R": "12", "D": "0", "U": "17"},
            "15": {"L": "15", "R": "16", "D": "13", "U": "2"},
            "11": {"L": "10", "R": "16", "D": "13", "U": "11"},
            "2": {"L": "1", "R": "16", "D": "13", "U": "11"},
            "9": {"L": "18", "R": "8", "D": "9", "U": "9"},
            "14": {"L": "15", "R": "16", "D": "1", "U": "11"},
            "6": {"L": "15", "R": "1", "D": "13", "U": "11"},
            "3": {"L": "8", "R": "18", "D": "12", "U": "12"},
            "8": {"L": "8", "R": "18", "D": "12", "U": "7"},
            "16": {"L": "15", "R": "16", "D": "6", "U": "11"},
            "17": {"L": "3", "R": "12", "D": "0", "U": "17"},
            "12": {"L": "15", "R": "16", "D": "13", "U": "11"},
            "4": {"L": "4", "R": "4", "D": "17", "U": "0"},
            "10": {"L": "15", "R": "16", "D": "13", "U": "1"},
            "5": {"L": "4", "R": "4", "D": "9", "U": "9"},
            "1": {"L": "1", "R": "1", "D": "1", "U": "1"},
        },
        initial_state="5",
        final_states={"1"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("3210")) == DFA(
        states={
            "1",
            "11",
            "5",
            "16",
            "18",
            "10",
            "6",
            "12",
            "8",
            "0",
            "4",
            "2",
            "19",
            "15",
            "13",
            "9",
            "14",
            "7",
            "3",
            "17",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "16", "D": "4", "U": "10"},
            "13": {"L": "0", "R": "16", "D": "4", "U": "14"},
            "18": {"L": "18", "R": "18", "D": "3", "U": "15"},
            "19": {"L": "19", "R": "1", "D": "2", "U": "13"},
            "7": {"L": "5", "R": "5", "D": "15", "U": "3"},
            "15": {"L": "12", "R": "5", "D": "15", "U": "3"},
            "11": {"L": "11", "R": "6", "D": "7", "U": "5"},
            "2": {"L": "19", "R": "13", "D": "2", "U": "8"},
            "14": {"L": "10", "R": "16", "D": "4", "U": "14"},
            "9": {"L": "6", "R": "11", "D": "9", "U": "9"},
            "6": {"L": "11", "R": "6", "D": "5", "U": "7"},
            "3": {"L": "5", "R": "12", "D": "15", "U": "3"},
            "8": {"L": "13", "R": "1", "D": "2", "U": "8"},
            "16": {"L": "0", "R": "16", "D": "10", "U": "14"},
            "17": {"L": "18", "R": "18", "D": "9", "U": "9"},
            "4": {"L": "0", "R": "10", "D": "4", "U": "14"},
            "12": {"L": "11", "R": "6", "D": "5", "U": "5"},
            "10": {"L": "10", "R": "10", "D": "10", "U": "10"},
            "5": {"L": "19", "R": "1", "D": "2", "U": "8"},
            "1": {"L": "19", "R": "1", "D": "13", "U": "8"},
        },
        initial_state="17",
        final_states={"10"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("1320")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "21",
            "32",
            "4",
            "2",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "36",
            "9",
            "14",
            "7",
            "3",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "34", "R": "26", "D": "3", "U": "0"},
            "13": {"L": "1", "R": "13", "D": "5", "U": "37"},
            "19": {"L": "17", "R": "27", "D": "10", "U": "21"},
            "34": {"L": "9", "R": "15", "D": "21", "U": "8"},
            "11": {"L": "28", "R": "26", "D": "3", "U": "0"},
            "27": {"L": "17", "R": "27", "D": "28", "U": "16"},
            "2": {"L": "9", "R": "15", "D": "30", "U": "8"},
            "9": {"L": "9", "R": "15", "D": "16", "U": "5"},
            "14": {"L": "24", "R": "28", "D": "29", "U": "16"},
            "6": {"L": "20", "R": "20", "D": "36", "U": "36"},
            "3": {"L": "23", "R": "31", "D": "3", "U": "0"},
            "29": {"L": "23", "R": "28", "D": "29", "U": "16"},
            "25": {"L": "9", "R": "15", "D": "21", "U": "28"},
            "33": {"L": "35", "R": "2", "D": "33", "U": "4"},
            "16": {"L": "23", "R": "7", "D": "29", "U": "16"},
            "4": {"L": "2", "R": "35", "D": "33", "U": "4"},
            "28": {"L": "28", "R": "28", "D": "28", "U": "28"},
            "37": {"L": "22", "R": "23", "D": "33", "U": "4"},
            "5": {"L": "25", "R": "26", "D": "3", "U": "0"},
            "21": {"L": "24", "R": "7", "D": "29", "U": "16"},
            "18": {"L": "9", "R": "15", "D": "21", "U": "21"},
            "7": {"L": "17", "R": "27", "D": "28", "U": "21"},
            "22": {"L": "9", "R": "15", "D": "30", "U": "21"},
            "15": {"L": "9", "R": "15", "D": "11", "U": "32"},
            "26": {"L": "9", "R": "15", "D": "12", "U": "21"},
            "35": {"L": "1", "R": "13", "D": "8", "U": "21"},
            "30": {"L": "24", "R": "19", "D": "3", "U": "0"},
            "8": {"L": "25", "R": "19", "D": "3", "U": "0"},
            "20": {"L": "20", "R": "20", "D": "4", "U": "33"},
            "23": {"L": "17", "R": "27", "D": "14", "U": "21"},
            "17": {"L": "17", "R": "27", "D": "29", "U": "21"},
            "24": {"L": "17", "R": "27", "D": "14", "U": "28"},
            "12": {"L": "28", "R": "19", "D": "3", "U": "0"},
            "36": {"L": "13", "R": "1", "D": "36", "U": "36"},
            "10": {"L": "28", "R": "28", "D": "29", "U": "16"},
            "32": {"L": "18", "R": "19", "D": "3", "U": "0"},
            "31": {"L": "9", "R": "15", "D": "12", "U": "8"},
            "1": {"L": "1", "R": "13", "D": "37", "U": "5"},
        },
        initial_state="6",
        final_states={"28"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("0231")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "21",
            "32",
            "4",
            "2",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "36",
            "9",
            "14",
            "7",
            "3",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "9", "R": "30", "D": "6", "U": "8"},
            "13": {"L": "34", "R": "18", "D": "16", "U": "8"},
            "19": {"L": "17", "R": "5", "D": "11", "U": "19"},
            "34": {"L": "34", "R": "18", "D": "26", "U": "33"},
            "11": {"L": "5", "R": "17", "D": "11", "U": "19"},
            "27": {"L": "10", "R": "21", "D": "37", "U": "27"},
            "2": {"L": "21", "R": "35", "D": "11", "U": "19"},
            "9": {"L": "9", "R": "30", "D": "8", "U": "27"},
            "14": {"L": "9", "R": "30", "D": "15", "U": "16"},
            "6": {"L": "8", "R": "0", "D": "37", "U": "27"},
            "3": {"L": "36", "R": "21", "D": "3", "U": "24"},
            "29": {"L": "7", "R": "31", "D": "29", "U": "29"},
            "25": {"L": "34", "R": "18", "D": "22", "U": "16"},
            "33": {"L": "14", "R": "28", "D": "3", "U": "24"},
            "16": {"L": "10", "R": "0", "D": "37", "U": "27"},
            "4": {"L": "4", "R": "4", "D": "19", "U": "11"},
            "28": {"L": "34", "R": "18", "D": "16", "U": "16"},
            "37": {"L": "8", "R": "21", "D": "37", "U": "27"},
            "5": {"L": "34", "R": "18", "D": "12", "U": "32"},
            "21": {"L": "9", "R": "30", "D": "6", "U": "16"},
            "18": {"L": "34", "R": "18", "D": "27", "U": "23"},
            "7": {"L": "31", "R": "7", "D": "2", "U": "23"},
            "22": {"L": "14", "R": "8", "D": "3", "U": "24"},
            "15": {"L": "8", "R": "8", "D": "37", "U": "27"},
            "26": {"L": "25", "R": "8", "D": "3", "U": "24"},
            "35": {"L": "34", "R": "18", "D": "12", "U": "16"},
            "30": {"L": "9", "R": "30", "D": "37", "U": "16"},
            "8": {"L": "8", "R": "8", "D": "8", "U": "8"},
            "20": {"L": "34", "R": "18", "D": "16", "U": "32"},
            "23": {"L": "25", "R": "13", "D": "3", "U": "24"},
            "17": {"L": "31", "R": "7", "D": "32", "U": "16"},
            "24": {"L": "25", "R": "20", "D": "3", "U": "24"},
            "12": {"L": "14", "R": "0", "D": "3", "U": "24"},
            "36": {"L": "34", "R": "18", "D": "22", "U": "32"},
            "10": {"L": "9", "R": "30", "D": "8", "U": "16"},
            "32": {"L": "14", "R": "13", "D": "3", "U": "24"},
            "31": {"L": "31", "R": "7", "D": "23", "U": "2"},
            "1": {"L": "4", "R": "4", "D": "29", "U": "29"},
        },
        initial_state="1",
        final_states={"8"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("1023")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "46",
            "22",
            "10",
            "6",
            "40",
            "27",
            "24",
            "12",
            "28",
            "8",
            "0",
            "26",
            "20",
            "48",
            "38",
            "21",
            "32",
            "44",
            "4",
            "41",
            "2",
            "42",
            "34",
            "35",
            "19",
            "15",
            "29",
            "33",
            "37",
            "30",
            "13",
            "31",
            "45",
            "43",
            "36",
            "9",
            "39",
            "14",
            "7",
            "3",
            "47",
            "17",
            "25",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "3", "R": "19", "D": "39", "U": "18"},
            "46": {"L": "14", "R": "26", "D": "32", "U": "9"},
            "13": {"L": "46", "R": "43", "D": "17", "U": "13"},
            "19": {"L": "29", "R": "44", "D": "22", "U": "34"},
            "34": {"L": "29", "R": "48", "D": "22", "U": "34"},
            "45": {"L": "27", "R": "6", "D": "45", "U": "45"},
            "41": {"L": "40", "R": "41", "D": "20", "U": "4"},
            "11": {"L": "21", "R": "21", "D": "45", "U": "45"},
            "48": {"L": "48", "R": "48", "D": "48", "U": "48"},
            "27": {"L": "6", "R": "27", "D": "12", "U": "4"},
            "9": {"L": "29", "R": "19", "D": "39", "U": "18"},
            "2": {"L": "38", "R": "1", "D": "37", "U": "9"},
            "14": {"L": "14", "R": "26", "D": "32", "U": "23"},
            "6": {"L": "6", "R": "27", "D": "4", "U": "12"},
            "3": {"L": "38", "R": "1", "D": "47", "U": "9"},
            "29": {"L": "29", "R": "44", "D": "47", "U": "34"},
            "25": {"L": "38", "R": "1", "D": "36", "U": "9"},
            "16": {"L": "14", "R": "26", "D": "32", "U": "19"},
            "33": {"L": "3", "R": "31", "D": "39", "U": "18"},
            "4": {"L": "29", "R": "5", "D": "30", "U": "15"},
            "28": {"L": "46", "R": "19", "D": "10", "U": "28"},
            "47": {"L": "48", "R": "44", "D": "22", "U": "34"},
            "5": {"L": "38", "R": "1", "D": "22", "U": "9"},
            "37": {"L": "42", "R": "31", "D": "39", "U": "18"},
            "21": {"L": "21", "R": "21", "D": "13", "U": "17"},
            "18": {"L": "25", "R": "19", "D": "39", "U": "18"},
            "7": {"L": "40", "R": "41", "D": "48", "U": "32"},
            "22": {"L": "42", "R": "44", "D": "22", "U": "34"},
            "15": {"L": "25", "R": "43", "D": "30", "U": "15"},
            "26": {"L": "14", "R": "26", "D": "12", "U": "19"},
            "35": {"L": "38", "R": "1", "D": "37", "U": "19"},
            "40": {"L": "40", "R": "41", "D": "8", "U": "33"},
            "43": {"L": "40", "R": "41", "D": "22", "U": "32"},
            "39": {"L": "24", "R": "35", "D": "39", "U": "18"},
            "8": {"L": "48", "R": "5", "D": "30", "U": "15"},
            "42": {"L": "29", "R": "44", "D": "48", "U": "34"},
            "30": {"L": "7", "R": "2", "D": "30", "U": "15"},
            "38": {"L": "38", "R": "1", "D": "36", "U": "0"},
            "44": {"L": "29", "R": "44", "D": "22", "U": "48"},
            "20": {"L": "24", "R": "31", "D": "39", "U": "18"},
            "23": {"L": "5", "R": "19", "D": "10", "U": "28"},
            "17": {"L": "43", "R": "46", "D": "17", "U": "13"},
            "24": {"L": "38", "R": "1", "D": "48", "U": "9"},
            "12": {"L": "5", "R": "31", "D": "10", "U": "28"},
            "36": {"L": "48", "R": "31", "D": "39", "U": "18"},
            "10": {"L": "5", "R": "16", "D": "10", "U": "28"},
            "32": {"L": "29", "R": "31", "D": "39", "U": "18"},
            "31": {"L": "38", "R": "1", "D": "22", "U": "19"},
            "1": {"L": "38", "R": "1", "D": "20", "U": "19"},
        },
        initial_state="11",
        final_states={"48"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("201")) == DFA(
        states={
            "1",
            "11",
            "5",
            "16",
            "18",
            "10",
            "6",
            "12",
            "8",
            "0",
            "20",
            "21",
            "4",
            "2",
            "19",
            "15",
            "13",
            "9",
            "14",
            "7",
            "3",
            "17",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "0", "D": "0", "U": "0"},
            "21": {"L": "16", "R": "7", "D": "21", "U": "15"},
            "13": {"L": "13", "R": "13", "D": "15", "U": "21"},
            "18": {"L": "14", "R": "4", "D": "18", "U": "8"},
            "19": {"L": "5", "R": "6", "D": "0", "U": "0"},
            "7": {"L": "2", "R": "12", "D": "0", "U": "17"},
            "15": {"L": "7", "R": "16", "D": "21", "U": "15"},
            "11": {"L": "0", "R": "4", "D": "18", "U": "8"},
            "2": {"L": "2", "R": "12", "D": "20", "U": "3"},
            "9": {"L": "0", "R": "0", "D": "18", "U": "8"},
            "14": {"L": "5", "R": "6", "D": "17", "U": "0"},
            "6": {"L": "5", "R": "6", "D": "17", "U": "11"},
            "3": {"L": "4", "R": "0", "D": "21", "U": "15"},
            "8": {"L": "0", "R": "16", "D": "18", "U": "8"},
            "16": {"L": "5", "R": "6", "D": "17", "U": "9"},
            "20": {"L": "19", "R": "4", "D": "18", "U": "8"},
            "17": {"L": "19", "R": "0", "D": "18", "U": "8"},
            "4": {"L": "5", "R": "6", "D": "0", "U": "9"},
            "12": {"L": "2", "R": "12", "D": "3", "U": "20"},
            "10": {"L": "13", "R": "13", "D": "1", "U": "1"},
            "5": {"L": "5", "R": "6", "D": "20", "U": "0"},
            "1": {"L": "12", "R": "2", "D": "1", "U": "1"},
        },
        initial_state="10",
        final_states={"0"},
    )
    assert PinWords.make_dfa_for_perm(Perm.from_string("2103")) == DFA(
        states={
            "1",
            "23",
            "11",
            "5",
            "16",
            "18",
            "22",
            "10",
            "6",
            "12",
            "8",
            "0",
            "20",
            "21",
            "4",
            "2",
            "19",
            "15",
            "13",
            "9",
            "14",
            "7",
            "3",
            "17",
        },
        input_symbols={"L", "R", "D", "U"},
        transitions={
            "0": {"L": "0", "R": "20", "D": "13", "U": "23"},
            "21": {"L": "21", "R": "11", "D": "21", "U": "12"},
            "13": {"L": "23", "R": "23", "D": "14", "U": "8"},
            "18": {"L": "18", "R": "5", "D": "3", "U": "7"},
            "7": {"L": "21", "R": "17", "D": "21", "U": "12"},
            "19": {"L": "0", "R": "20", "D": "23", "U": "23"},
            "22": {"L": "21", "R": "11", "D": "21", "U": "16"},
            "15": {"L": "18", "R": "5", "D": "10", "U": "6"},
            "11": {"L": "21", "R": "11", "D": "21", "U": "10"},
            "2": {"L": "20", "R": "0", "D": "2", "U": "2"},
            "9": {"L": "9", "R": "9", "D": "8", "U": "14"},
            "14": {"L": "19", "R": "23", "D": "14", "U": "8"},
            "6": {"L": "10", "R": "15", "D": "3", "U": "1"},
            "3": {"L": "18", "R": "22", "D": "3", "U": "1"},
            "8": {"L": "23", "R": "19", "D": "14", "U": "8"},
            "16": {"L": "10", "R": "10", "D": "21", "U": "12"},
            "20": {"L": "0", "R": "20", "D": "23", "U": "13"},
            "23": {"L": "18", "R": "5", "D": "3", "U": "1"},
            "17": {"L": "21", "R": "11", "D": "10", "U": "10"},
            "12": {"L": "21", "R": "10", "D": "21", "U": "12"},
            "4": {"L": "9", "R": "9", "D": "2", "U": "2"},
            "10": {"L": "10", "R": "10", "D": "10", "U": "10"},
            "5": {"L": "18", "R": "5", "D": "21", "U": "6"},
            "1": {"L": "21", "R": "15", "D": "3", "U": "1"},
        },
        initial_state="4",
        final_states={"10"},
    )


def test_make_dfa_for_basis_from_pinwords():
    assert PinWords.make_dfa_for_basis_from_pinwords([Perm((2, 0, 1, 3))]) == DFA(
        states={
            "22",
            "26",
            "24",
            "1",
            "12",
            "21",
            "28",
            "32",
            "11",
            "34",
            "18",
            "3",
            "35",
            "4",
            "6",
            "37",
            "19",
            "13",
            "10",
            "23",
            "20",
            "33",
            "5",
            "7",
            "0",
            "9",
            "31",
            "17",
            "2",
            "16",
            "27",
            "8",
            "29",
            "14",
            "25",
            "36",
            "30",
            "15",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "28": {"R": "18", "D": "9", "L": "28", "U": "37"},
            "14": {"R": "36", "D": "32", "L": "17", "U": "1"},
            "26": {"R": "36", "D": "30", "L": "17", "U": "1"},
            "6": {"R": "33", "D": "6", "L": "8", "U": "5"},
            "7": {"R": "18", "D": "30", "L": "28", "U": "32"},
            "17": {"R": "36", "D": "32", "L": "17", "U": "35"},
            "25": {"R": "18", "D": "3", "L": "28", "U": "2"},
            "2": {"R": "13", "D": "6", "L": "30", "U": "5"},
            "9": {"R": "33", "D": "6", "L": "7", "U": "5"},
            "36": {"R": "36", "D": "37", "L": "17", "U": "30"},
            "12": {"R": "18", "D": "32", "L": "28", "U": "32"},
            "34": {"R": "34", "D": "19", "L": "34", "U": "4"},
            "33": {"R": "18", "D": "32", "L": "28", "U": "2"},
            "0": {"R": "34", "D": "29", "L": "34", "U": "29"},
            "3": {"R": "13", "D": "6", "L": "7", "U": "5"},
            "27": {"R": "16", "D": "9", "L": "27", "U": "15"},
            "1": {"R": "30", "D": "37", "L": "26", "U": "35"},
            "20": {"R": "13", "D": "6", "L": "12", "U": "5"},
            "22": {"R": "16", "D": "32", "L": "27", "U": "3"},
            "35": {"R": "30", "D": "37", "L": "14", "U": "35"},
            "31": {"R": "13", "D": "6", "L": "26", "U": "5"},
            "18": {"R": "18", "D": "20", "L": "28", "U": "23"},
            "19": {"R": "24", "D": "4", "L": "22", "U": "19"},
            "5": {"R": "25", "D": "6", "L": "14", "U": "5"},
            "32": {"R": "21", "D": "37", "L": "26", "U": "35"},
            "15": {"R": "14", "D": "4", "L": "11", "U": "19"},
            "11": {"R": "18", "D": "32", "L": "28", "U": "31"},
            "29": {"R": "27", "D": "29", "L": "16", "U": "29"},
            "24": {"R": "18", "D": "3", "L": "28", "U": "31"},
            "30": {"R": "30", "D": "30", "L": "30", "U": "30"},
            "8": {"R": "18", "D": "3", "L": "28", "U": "32"},
            "10": {"R": "30", "D": "37", "L": "30", "U": "35"},
            "21": {"R": "36", "D": "32", "L": "17", "U": "30"},
            "37": {"R": "21", "D": "37", "L": "14", "U": "35"},
            "23": {"R": "33", "D": "6", "L": "30", "U": "5"},
            "16": {"R": "16", "D": "15", "L": "27", "U": "9"},
            "4": {"R": "22", "D": "4", "L": "24", "U": "19"},
            "13": {"R": "36", "D": "32", "L": "17", "U": "10"},
        },
        initial_state="0",
        final_states={"30"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [Perm((1, 3, 0, 2)), Perm((1, 2, 0))]
    ) == DFA(
        states={
            "1",
            "12",
            "21",
            "11",
            "18",
            "3",
            "4",
            "6",
            "19",
            "13",
            "10",
            "20",
            "5",
            "7",
            "0",
            "9",
            "17",
            "2",
            "16",
            "8",
            "14",
            "15",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "18": {"R": "13", "D": "20", "L": "13", "U": "20"},
            "19": {"R": "2", "D": "19", "L": "6", "U": "7"},
            "5": {"R": "21", "D": "19", "L": "8", "U": "7"},
            "15": {"R": "8", "D": "3", "L": "8", "U": "9"},
            "14": {"R": "17", "D": "8", "L": "16", "U": "1"},
            "11": {"R": "11", "D": "5", "L": "0", "U": "12"},
            "6": {"R": "17", "D": "15", "L": "16", "U": "1"},
            "7": {"R": "6", "D": "19", "L": "2", "U": "7"},
            "1": {"R": "10", "D": "3", "L": "8", "U": "9"},
            "8": {"R": "8", "D": "8", "L": "8", "U": "8"},
            "17": {"R": "17", "D": "8", "L": "16", "U": "12"},
            "10": {"R": "17", "D": "8", "L": "16", "U": "8"},
            "21": {"R": "17", "D": "15", "L": "16", "U": "8"},
            "2": {"R": "11", "D": "1", "L": "0", "U": "8"},
            "9": {"R": "14", "D": "3", "L": "21", "U": "9"},
            "13": {"R": "13", "D": "7", "L": "13", "U": "19"},
            "12": {"R": "10", "D": "3", "L": "21", "U": "9"},
            "16": {"R": "17", "D": "4", "L": "16", "U": "1"},
            "4": {"R": "8", "D": "3", "L": "21", "U": "9"},
            "0": {"R": "11", "D": "12", "L": "0", "U": "5"},
            "3": {"R": "8", "D": "3", "L": "6", "U": "9"},
            "20": {"R": "0", "D": "20", "L": "11", "U": "20"},
        },
        initial_state="18",
        final_states={"8"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [Perm((0, 2, 1)), Perm((3, 0, 1, 2)), Perm((3, 0, 1, 2))]
    ) == DFA(
        states={
            "22",
            "26",
            "24",
            "1",
            "12",
            "21",
            "28",
            "32",
            "11",
            "34",
            "49",
            "18",
            "35",
            "3",
            "48",
            "4",
            "37",
            "6",
            "19",
            "40",
            "13",
            "47",
            "10",
            "23",
            "20",
            "45",
            "33",
            "5",
            "41",
            "50",
            "7",
            "0",
            "9",
            "31",
            "17",
            "2",
            "16",
            "46",
            "27",
            "8",
            "44",
            "29",
            "39",
            "14",
            "42",
            "38",
            "25",
            "43",
            "51",
            "36",
            "30",
            "15",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "38": {"R": "38", "D": "11", "L": "17", "U": "16"},
            "43": {"R": "1", "D": "33", "L": "7", "U": "29"},
            "17": {"R": "38", "D": "48", "L": "17", "U": "29"},
            "47": {"R": "23", "D": "39", "L": "33", "U": "47"},
            "25": {"R": "36", "D": "32", "L": "46", "U": "33"},
            "2": {"R": "21", "D": "32", "L": "51", "U": "33"},
            "12": {"R": "42", "D": "48", "L": "12", "U": "33"},
            "41": {"R": "41", "D": "27", "L": "41", "U": "8"},
            "34": {"R": "33", "D": "28", "L": "2", "U": "4"},
            "27": {"R": "9", "D": "8", "L": "24", "U": "27"},
            "35": {"R": "35", "D": "13", "L": "26", "U": "34"},
            "19": {"R": "5", "D": "44", "L": "43", "U": "19"},
            "42": {"R": "42", "D": "22", "L": "12", "U": "20"},
            "15": {"R": "33", "D": "50", "L": "33", "U": "30"},
            "11": {"R": "5", "D": "50", "L": "46", "U": "30"},
            "8": {"R": "24", "D": "8", "L": "9", "U": "27"},
            "21": {"R": "21", "D": "10", "L": "51", "U": "6"},
            "37": {"R": "5", "D": "44", "L": "33", "U": "19"},
            "23": {"R": "42", "D": "6", "L": "12", "U": "33"},
            "16": {"R": "33", "D": "39", "L": "46", "U": "47"},
            "28": {"R": "0", "D": "28", "L": "23", "U": "4"},
            "14": {"R": "36", "D": "32", "L": "46", "U": "32"},
            "26": {"R": "35", "D": "34", "L": "26", "U": "13"},
            "39": {"R": "14", "D": "39", "L": "23", "U": "47"},
            "45": {"R": "14", "D": "45", "L": "33", "U": "49"},
            "6": {"R": "33", "D": "45", "L": "46", "U": "49"},
            "7": {"R": "1", "D": "33", "L": "7", "U": "13"},
            "9": {"R": "38", "D": "3", "L": "17", "U": "33"},
            "36": {"R": "36", "D": "49", "L": "46", "U": "32"},
            "40": {"R": "26", "D": "40", "L": "35", "U": "40"},
            "49": {"R": "25", "D": "45", "L": "33", "U": "49"},
            "33": {"R": "33", "D": "33", "L": "33", "U": "33"},
            "0": {"R": "21", "D": "15", "L": "51", "U": "6"},
            "3": {"R": "33", "D": "50", "L": "46", "U": "30"},
            "46": {"R": "36", "D": "33", "L": "46", "U": "33"},
            "1": {"R": "1", "D": "37", "L": "7", "U": "29"},
            "20": {"R": "33", "D": "39", "L": "33", "U": "47"},
            "22": {"R": "25", "D": "45", "L": "46", "U": "49"},
            "31": {"R": "21", "D": "33", "L": "51", "U": "33"},
            "18": {"R": "41", "D": "40", "L": "41", "U": "40"},
            "5": {"R": "21", "D": "15", "L": "51", "U": "33"},
            "32": {"R": "33", "D": "45", "L": "33", "U": "49"},
            "29": {"R": "33", "D": "50", "L": "31", "U": "30"},
            "24": {"R": "1", "D": "15", "L": "7", "U": "29"},
            "30": {"R": "25", "D": "50", "L": "51", "U": "30"},
            "51": {"R": "21", "D": "33", "L": "51", "U": "29"},
            "10": {"R": "5", "D": "50", "L": "33", "U": "30"},
            "48": {"R": "33", "D": "39", "L": "25", "U": "47"},
            "50": {"R": "0", "D": "50", "L": "33", "U": "30"},
            "44": {"R": "24", "D": "44", "L": "33", "U": "19"},
            "4": {"R": "23", "D": "28", "L": "51", "U": "4"},
            "13": {"R": "5", "D": "44", "L": "31", "U": "19"},
        },
        initial_state="18",
        final_states={"33"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [Perm((1, 0, 2, 3)), Perm((3, 2, 0, 1)), Perm((2, 1, 3, 0)), Perm((2, 1, 0, 3))]
    ) == DFA(
        states={
            "78",
            "80",
            "12",
            "11",
            "105",
            "107",
            "49",
            "37",
            "85",
            "69",
            "87",
            "20",
            "50",
            "60",
            "9",
            "31",
            "2",
            "46",
            "27",
            "8",
            "71",
            "64",
            "83",
            "84",
            "25",
            "22",
            "81",
            "76",
            "61",
            "92",
            "28",
            "32",
            "72",
            "35",
            "40",
            "47",
            "15",
            "97",
            "10",
            "45",
            "33",
            "57",
            "63",
            "102",
            "91",
            "16",
            "86",
            "89",
            "14",
            "56",
            "95",
            "108",
            "24",
            "1",
            "99",
            "58",
            "73",
            "67",
            "34",
            "104",
            "65",
            "19",
            "13",
            "103",
            "101",
            "7",
            "93",
            "44",
            "39",
            "106",
            "109",
            "96",
            "36",
            "53",
            "26",
            "75",
            "52",
            "21",
            "77",
            "18",
            "3",
            "48",
            "94",
            "4",
            "6",
            "74",
            "23",
            "82",
            "5",
            "41",
            "68",
            "0",
            "70",
            "59",
            "17",
            "62",
            "29",
            "88",
            "90",
            "42",
            "79",
            "100",
            "54",
            "38",
            "51",
            "43",
            "66",
            "55",
            "30",
            "98",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "90": {"R": "35", "D": "64", "L": "27", "U": "90"},
            "100": {"R": "35", "D": "104", "L": "54", "U": "36"},
            "70": {"R": "73", "D": "41", "L": "97", "U": "70"},
            "66": {"R": "83", "D": "17", "L": "66", "U": "35"},
            "77": {"R": "38", "D": "1", "L": "21", "U": "59"},
            "2": {"R": "38", "D": "49", "L": "2", "U": "35"},
            "63": {"R": "35", "D": "26", "L": "9", "U": "69"},
            "12": {"R": "106", "D": "51", "L": "12", "U": "78"},
            "41": {"R": "68", "D": "41", "L": "6", "U": "70"},
            "74": {"R": "74", "D": "40", "L": "18", "U": "101"},
            "87": {"R": "87", "D": "47", "L": "87", "U": "25"},
            "96": {"R": "35", "D": "26", "L": "35", "U": "69"},
            "102": {"R": "65", "D": "107", "L": "91", "U": "11"},
            "42": {"R": "42", "D": "22", "L": "72", "U": "35"},
            "105": {"R": "108", "D": "46", "L": "105", "U": "35"},
            "15": {"R": "83", "D": "98", "L": "66", "U": "35"},
            "11": {"R": "81", "D": "99", "L": "35", "U": "37"},
            "88": {"R": "38", "D": "26", "L": "9", "U": "69"},
            "8": {"R": "65", "D": "107", "L": "91", "U": "94"},
            "37": {"R": "7", "D": "99", "L": "24", "U": "37"},
            "104": {"R": "54", "D": "104", "L": "54", "U": "36"},
            "95": {"R": "33", "D": "99", "L": "55", "U": "37"},
            "79": {"R": "65", "D": "77", "L": "91", "U": "88"},
            "85": {"R": "35", "D": "104", "L": "15", "U": "36"},
            "52": {"R": "109", "D": "52", "L": "79", "U": "71"},
            "108": {"R": "108", "D": "100", "L": "105", "U": "98"},
            "65": {"R": "65", "D": "57", "L": "91", "U": "10"},
            "58": {"R": "18", "D": "58", "L": "74", "U": "58"},
            "28": {"R": "54", "D": "104", "L": "2", "U": "36"},
            "26": {"R": "92", "D": "26", "L": "82", "U": "69"},
            "39": {"R": "92", "D": "99", "L": "35", "U": "37"},
            "45": {"R": "33", "D": "50", "L": "53", "U": "103"},
            "6": {"R": "84", "D": "35", "L": "20", "U": "14"},
            "55": {"R": "65", "D": "35", "L": "91", "U": "0"},
            "97": {"R": "108", "D": "46", "L": "105", "U": "103"},
            "9": {"R": "38", "D": "49", "L": "2", "U": "49"},
            "33": {"R": "108", "D": "13", "L": "105", "U": "98"},
            "0": {"R": "38", "D": "104", "L": "35", "U": "36"},
            "3": {"R": "54", "D": "50", "L": "2", "U": "103"},
            "1": {"R": "35", "D": "1", "L": "48", "U": "59"},
            "71": {"R": "7", "D": "52", "L": "27", "U": "71"},
            "86": {"R": "92", "D": "26", "L": "35", "U": "69"},
            "20": {"R": "84", "D": "62", "L": "20", "U": "45"},
            "22": {"R": "35", "D": "64", "L": "43", "U": "90"},
            "18": {"R": "74", "D": "101", "L": "18", "U": "40"},
            "107": {"R": "38", "D": "13", "L": "38", "U": "49"},
            "32": {"R": "35", "D": "104", "L": "2", "U": "36"},
            "29": {"R": "33", "D": "99", "L": "9", "U": "37"},
            "24": {"R": "83", "D": "17", "L": "66", "U": "36"},
            "30": {"R": "38", "D": "104", "L": "2", "U": "36"},
            "101": {"R": "102", "D": "41", "L": "76", "U": "70"},
            "51": {"R": "35", "D": "1", "L": "35", "U": "59"},
            "10": {"R": "106", "D": "1", "L": "35", "U": "59"},
            "78": {"R": "35", "D": "13", "L": "2", "U": "49"},
            "84": {"R": "84", "D": "95", "L": "20", "U": "34"},
            "48": {"R": "106", "D": "35", "L": "12", "U": "78"},
            "67": {"R": "67", "D": "57", "L": "75", "U": "35"},
            "83": {"R": "83", "D": "100", "L": "66", "U": "35"},
            "38": {"R": "38", "D": "35", "L": "2", "U": "35"},
            "69": {"R": "35", "D": "26", "L": "24", "U": "69"},
            "43": {"R": "67", "D": "107", "L": "75", "U": "96"},
            "17": {"R": "54", "D": "104", "L": "35", "U": "36"},
            "47": {"R": "73", "D": "25", "L": "61", "U": "47"},
            "25": {"R": "61", "D": "25", "L": "73", "U": "47"},
            "91": {"R": "65", "D": "39", "L": "91", "U": "16"},
            "99": {"R": "92", "D": "99", "L": "93", "U": "37"},
            "34": {"R": "102", "D": "41", "L": "9", "U": "70"},
            "73": {"R": "84", "D": "77", "L": "20", "U": "29"},
            "27": {"R": "42", "D": "28", "L": "72", "U": "96"},
            "35": {"R": "35", "D": "35", "L": "35", "U": "35"},
            "19": {"R": "19", "D": "22", "L": "44", "U": "10"},
            "98": {"R": "38", "D": "13", "L": "35", "U": "49"},
            "76": {"R": "106", "D": "49", "L": "12", "U": "49"},
            "60": {"R": "92", "D": "26", "L": "76", "U": "69"},
            "53": {"R": "108", "D": "98", "L": "105", "U": "35"},
            "80": {"R": "67", "D": "77", "L": "75", "U": "63"},
            "68": {"R": "65", "D": "56", "L": "91", "U": "11"},
            "21": {"R": "106", "D": "35", "L": "12", "U": "49"},
            "109": {"R": "42", "D": "35", "L": "72", "U": "35"},
            "89": {"R": "87", "D": "58", "L": "87", "U": "58"},
            "23": {"R": "38", "D": "64", "L": "43", "U": "90"},
            "57": {"R": "35", "D": "26", "L": "31", "U": "69"},
            "16": {"R": "38", "D": "104", "L": "15", "U": "36"},
            "54": {"R": "83", "D": "35", "L": "66", "U": "35"},
            "82": {"R": "67", "D": "35", "L": "75", "U": "32"},
            "75": {"R": "67", "D": "86", "L": "75", "U": "85"},
            "106": {"R": "106", "D": "35", "L": "12", "U": "35"},
            "61": {"R": "19", "D": "3", "L": "44", "U": "11"},
            "62": {"R": "102", "D": "41", "L": "35", "U": "70"},
            "94": {"R": "38", "D": "26", "L": "35", "U": "69"},
            "14": {"R": "33", "D": "50", "L": "2", "U": "103"},
            "72": {"R": "42", "D": "60", "L": "72", "U": "22"},
            "56": {"R": "54", "D": "50", "L": "38", "U": "103"},
            "7": {"R": "106", "D": "35", "L": "12", "U": "51"},
            "36": {"R": "35", "D": "104", "L": "35", "U": "36"},
            "40": {"R": "33", "D": "52", "L": "8", "U": "71"},
            "49": {"R": "35", "D": "13", "L": "35", "U": "49"},
            "93": {"R": "65", "D": "35", "L": "91", "U": "30"},
            "46": {"R": "54", "D": "50", "L": "35", "U": "103"},
            "31": {"R": "67", "D": "35", "L": "75", "U": "36"},
            "5": {"R": "108", "D": "35", "L": "105", "U": "35"},
            "64": {"R": "109", "D": "64", "L": "80", "U": "90"},
            "59": {"R": "35", "D": "1", "L": "9", "U": "59"},
            "81": {"R": "38", "D": "35", "L": "2", "U": "49"},
            "50": {"R": "54", "D": "50", "L": "5", "U": "103"},
            "44": {"R": "19", "D": "4", "L": "44", "U": "23"},
            "4": {"R": "92", "D": "99", "L": "76", "U": "37"},
            "13": {"R": "35", "D": "13", "L": "38", "U": "49"},
            "92": {"R": "67", "D": "35", "L": "75", "U": "35"},
            "103": {"R": "81", "D": "50", "L": "35", "U": "103"},
        },
        initial_state="89",
        final_states={"35"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((2, 1, 0)),
            Perm((0, 2, 3, 1)),
            Perm((0, 1, 2, 3)),
            Perm((1, 0, 3, 2)),
            Perm((1, 0)),
        ]
    ) == DFA(
        states={
            "6",
            "7",
            "1",
            "13",
            "12",
            "9",
            "0",
            "15",
            "10",
            "2",
            "11",
            "3",
            "8",
            "5",
            "14",
            "4",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "5": {"R": "6", "D": "0", "L": "5", "U": "15"},
            "15": {"R": "15", "D": "15", "L": "15", "U": "15"},
            "14": {"R": "14", "D": "15", "L": "3", "U": "7"},
            "11": {"R": "11", "D": "15", "L": "11", "U": "15"},
            "6": {"R": "6", "D": "15", "L": "5", "U": "0"},
            "7": {"R": "15", "D": "7", "L": "15", "U": "7"},
            "8": {"R": "8", "D": "2", "L": "8", "U": "9"},
            "10": {"R": "15", "D": "10", "L": "11", "U": "4"},
            "2": {"R": "12", "D": "9", "L": "15", "U": "2"},
            "9": {"R": "15", "D": "9", "L": "12", "U": "2"},
            "12": {"R": "14", "D": "15", "L": "3", "U": "15"},
            "13": {"R": "5", "D": "13", "L": "6", "U": "13"},
            "4": {"R": "11", "D": "10", "L": "15", "U": "4"},
            "0": {"R": "15", "D": "10", "L": "15", "U": "4"},
            "3": {"R": "14", "D": "7", "L": "3", "U": "15"},
            "1": {"R": "8", "D": "13", "L": "8", "U": "13"},
        },
        initial_state="1",
        final_states={"15"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((3, 1, 2, 0)),
            Perm((1, 2, 0, 3)),
            Perm((0, 2, 3, 1)),
            Perm((0, 1, 3, 2)),
            Perm((0, 1, 2, 3)),
            Perm((3, 1, 2, 0)),
        ]
    ) == DFA(
        states={
            "78",
            "80",
            "12",
            "11",
            "49",
            "37",
            "69",
            "20",
            "50",
            "60",
            "9",
            "31",
            "2",
            "46",
            "27",
            "8",
            "71",
            "64",
            "25",
            "22",
            "76",
            "61",
            "28",
            "32",
            "72",
            "35",
            "40",
            "47",
            "10",
            "45",
            "33",
            "57",
            "63",
            "16",
            "14",
            "56",
            "24",
            "1",
            "58",
            "73",
            "67",
            "34",
            "65",
            "19",
            "13",
            "7",
            "44",
            "39",
            "36",
            "53",
            "26",
            "75",
            "21",
            "52",
            "77",
            "18",
            "3",
            "48",
            "4",
            "6",
            "74",
            "23",
            "5",
            "41",
            "68",
            "0",
            "70",
            "59",
            "17",
            "62",
            "29",
            "42",
            "79",
            "54",
            "38",
            "51",
            "43",
            "66",
            "55",
            "30",
            "15",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "38": {"R": "23", "D": "33", "L": "77", "U": "13"},
            "70": {"R": "63", "D": "67", "L": "70", "U": "41"},
            "69": {"R": "68", "D": "39", "L": "16", "U": "20"},
            "66": {"R": "48", "D": "15", "L": "4", "U": "54"},
            "43": {"R": "77", "D": "43", "L": "77", "U": "14"},
            "77": {"R": "77", "D": "77", "L": "77", "U": "77"},
            "17": {"R": "1", "D": "17", "L": "75", "U": "17"},
            "47": {"R": "40", "D": "77", "L": "47", "U": "24"},
            "25": {"R": "31", "D": "32", "L": "45", "U": "52"},
            "2": {"R": "77", "D": "2", "L": "77", "U": "61"},
            "63": {"R": "63", "D": "73", "L": "70", "U": "71"},
            "12": {"R": "53", "D": "77", "L": "12", "U": "52"},
            "41": {"R": "53", "D": "37", "L": "6", "U": "72"},
            "74": {"R": "50", "D": "66", "L": "74", "U": "69"},
            "34": {"R": "40", "D": "77", "L": "47", "U": "6"},
            "73": {"R": "23", "D": "33", "L": "58", "U": "13"},
            "27": {"R": "46", "D": "37", "L": "6", "U": "72"},
            "35": {"R": "42", "D": "44", "L": "60", "U": "35"},
            "19": {"R": "49", "D": "57", "L": "77", "U": "57"},
            "76": {"R": "16", "D": "76", "L": "25", "U": "36"},
            "42": {"R": "63", "D": "5", "L": "70", "U": "28"},
            "15": {"R": "16", "D": "15", "L": "77", "U": "54"},
            "11": {"R": "51", "D": "17", "L": "51", "U": "17"},
            "53": {"R": "53", "D": "77", "L": "12", "U": "77"},
            "60": {"R": "50", "D": "27", "L": "74", "U": "73"},
            "80": {"R": "46", "D": "2", "L": "65", "U": "61"},
            "68": {"R": "9", "D": "59", "L": "64", "U": "6"},
            "8": {"R": "31", "D": "77", "L": "45", "U": "77"},
            "21": {"R": "79", "D": "21", "L": "77", "U": "71"},
            "37": {"R": "77", "D": "37", "L": "26", "U": "72"},
            "23": {"R": "49", "D": "57", "L": "49", "U": "77"},
            "57": {"R": "77", "D": "57", "L": "77", "U": "57"},
            "16": {"R": "18", "D": "19", "L": "58", "U": "13"},
            "79": {"R": "18", "D": "19", "L": "58", "U": "77"},
            "54": {"R": "8", "D": "15", "L": "34", "U": "54"},
            "52": {"R": "77", "D": "43", "L": "65", "U": "14"},
            "75": {"R": "75", "D": "69", "L": "1", "U": "30"},
            "65": {"R": "49", "D": "77", "L": "49", "U": "57"},
            "58": {"R": "18", "D": "77", "L": "58", "U": "77"},
            "61": {"R": "53", "D": "2", "L": "34", "U": "61"},
            "62": {"R": "62", "D": "38", "L": "7", "U": "71"},
            "28": {"R": "53", "D": "15", "L": "65", "U": "54"},
            "14": {"R": "77", "D": "43", "L": "29", "U": "14"},
            "72": {"R": "53", "D": "37", "L": "78", "U": "72"},
            "26": {"R": "53", "D": "43", "L": "12", "U": "52"},
            "39": {"R": "60", "D": "39", "L": "55", "U": "20"},
            "45": {"R": "31", "D": "77", "L": "45", "U": "52"},
            "6": {"R": "49", "D": "57", "L": "49", "U": "57"},
            "56": {"R": "63", "D": "43", "L": "70", "U": "6"},
            "7": {"R": "62", "D": "77", "L": "7", "U": "24"},
            "55": {"R": "62", "D": "3", "L": "7", "U": "28"},
            "9": {"R": "9", "D": "77", "L": "64", "U": "14"},
            "36": {"R": "8", "D": "76", "L": "78", "U": "36"},
            "40": {"R": "40", "D": "77", "L": "47", "U": "14"},
            "49": {"R": "49", "D": "77", "L": "49", "U": "77"},
            "33": {"R": "79", "D": "33", "L": "77", "U": "13"},
            "0": {"R": "77", "D": "57", "L": "49", "U": "57"},
            "3": {"R": "23", "D": "15", "L": "77", "U": "54"},
            "46": {"R": "40", "D": "77", "L": "47", "U": "77"},
            "1": {"R": "75", "D": "30", "L": "1", "U": "69"},
            "71": {"R": "77", "D": "21", "L": "29", "U": "71"},
            "20": {"R": "42", "D": "39", "L": "10", "U": "20"},
            "22": {"R": "31", "D": "77", "L": "45", "U": "0"},
            "31": {"R": "31", "D": "38", "L": "45", "U": "77"},
            "18": {"R": "18", "D": "38", "L": "58", "U": "77"},
            "5": {"R": "23", "D": "76", "L": "77", "U": "36"},
            "32": {"R": "77", "D": "21", "L": "77", "U": "71"},
            "29": {"R": "53", "D": "77", "L": "12", "U": "0"},
            "24": {"R": "53", "D": "2", "L": "65", "U": "61"},
            "30": {"R": "48", "D": "76", "L": "56", "U": "36"},
            "64": {"R": "9", "D": "14", "L": "64", "U": "41"},
            "51": {"R": "51", "D": "35", "L": "51", "U": "44"},
            "59": {"R": "77", "D": "37", "L": "77", "U": "72"},
            "10": {"R": "50", "D": "80", "L": "74", "U": "73"},
            "78": {"R": "9", "D": "52", "L": "64", "U": "6"},
            "48": {"R": "62", "D": "19", "L": "7", "U": "77"},
            "50": {"R": "50", "D": "69", "L": "74", "U": "30"},
            "44": {"R": "60", "D": "44", "L": "42", "U": "35"},
            "4": {"R": "62", "D": "77", "L": "7", "U": "6"},
            "67": {"R": "77", "D": "21", "L": "22", "U": "71"},
            "13": {"R": "77", "D": "33", "L": "77", "U": "13"},
        },
        initial_state="11",
        final_states={"77"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((3, 2, 0, 1)),
            Perm((1, 2, 0, 3)),
            Perm((2, 1, 0)),
            Perm((1, 0, 2)),
            Perm((0, 1)),
            Perm((0, 1, 2)),
            Perm((0, 2, 1)),
        ]
    ) == DFA(
        states={"6", "7", "1", "0", "9", "3", "2", "8", "5", "4"},
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "9": {"R": "9", "D": "5", "L": "9", "U": "5"},
            "5": {"R": "5", "D": "5", "L": "5", "U": "5"},
            "6": {"R": "9", "D": "6", "L": "5", "U": "1"},
            "7": {"R": "0", "D": "4", "L": "0", "U": "4"},
            "4": {"R": "3", "D": "4", "L": "8", "U": "4"},
            "8": {"R": "8", "D": "2", "L": "3", "U": "5"},
            "0": {"R": "0", "D": "1", "L": "0", "U": "6"},
            "3": {"R": "8", "D": "5", "L": "3", "U": "2"},
            "1": {"R": "5", "D": "6", "L": "9", "U": "1"},
            "2": {"R": "5", "D": "2", "L": "5", "U": "2"},
        },
        initial_state="7",
        final_states={"5"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((1, 0)),
            Perm((2, 0, 1, 3)),
            Perm((1, 2, 0, 3)),
            Perm((0, 1, 2, 3)),
            Perm((2, 1, 0, 3)),
            Perm((1, 0, 3, 2)),
            Perm((0, 2, 3, 1)),
            Perm((1, 0, 2, 3)),
        ]
    ) == DFA(
        states={
            "6",
            "7",
            "1",
            "0",
            "12",
            "9",
            "13",
            "15",
            "10",
            "2",
            "11",
            "3",
            "8",
            "5",
            "14",
            "4",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "5": {"R": "11", "D": "13", "L": "5", "U": "1"},
            "15": {"R": "2", "D": "0", "L": "1", "U": "15"},
            "14": {"R": "4", "D": "12", "L": "14", "U": "1"},
            "11": {"R": "11", "D": "1", "L": "5", "U": "13"},
            "6": {"R": "6", "D": "7", "L": "6", "U": "10"},
            "7": {"R": "9", "D": "10", "L": "1", "U": "7"},
            "1": {"R": "1", "D": "1", "L": "1", "U": "1"},
            "8": {"R": "14", "D": "8", "L": "4", "U": "8"},
            "10": {"R": "1", "D": "10", "L": "9", "U": "7"},
            "2": {"R": "2", "D": "1", "L": "2", "U": "1"},
            "9": {"R": "11", "D": "1", "L": "5", "U": "1"},
            "12": {"R": "1", "D": "0", "L": "1", "U": "15"},
            "4": {"R": "4", "D": "1", "L": "14", "U": "12"},
            "0": {"R": "1", "D": "0", "L": "2", "U": "15"},
            "3": {"R": "6", "D": "8", "L": "6", "U": "8"},
            "13": {"R": "1", "D": "13", "L": "1", "U": "13"},
        },
        initial_state="3",
        final_states={"1"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((2, 1, 3, 0)),
            Perm((0, 1, 2, 3)),
            Perm((1, 0)),
            Perm((1, 2, 3, 0)),
            Perm((0, 1, 3, 2)),
            Perm((1, 0)),
            Perm((0, 2, 1)),
            Perm((0, 2, 1, 3)),
            Perm((1, 2, 0, 3)),
        ]
    ) == DFA(
        states={
            "6",
            "7",
            "1",
            "13",
            "12",
            "9",
            "0",
            "15",
            "10",
            "2",
            "11",
            "3",
            "8",
            "5",
            "14",
            "4",
        },
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "5": {"R": "14", "D": "13", "L": "7", "U": "13"},
            "15": {"R": "9", "D": "15", "L": "0", "U": "15"},
            "14": {"R": "14", "D": "13", "L": "7", "U": "1"},
            "11": {"R": "5", "D": "6", "L": "13", "U": "11"},
            "6": {"R": "13", "D": "6", "L": "5", "U": "11"},
            "7": {"R": "14", "D": "1", "L": "7", "U": "13"},
            "8": {"R": "13", "D": "3", "L": "13", "U": "10"},
            "10": {"R": "2", "D": "3", "L": "13", "U": "10"},
            "2": {"R": "2", "D": "13", "L": "2", "U": "13"},
            "9": {"R": "0", "D": "8", "L": "9", "U": "13"},
            "12": {"R": "12", "D": "11", "L": "12", "U": "6"},
            "13": {"R": "13", "D": "13", "L": "13", "U": "13"},
            "4": {"R": "12", "D": "15", "L": "12", "U": "15"},
            "0": {"R": "0", "D": "13", "L": "9", "U": "8"},
            "3": {"R": "13", "D": "3", "L": "2", "U": "10"},
            "1": {"R": "13", "D": "1", "L": "13", "U": "1"},
        },
        initial_state="4",
        final_states={"13"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((2, 1, 3, 0)),
            Perm((1, 0, 3, 2)),
            Perm((0, 1)),
            Perm((1, 2, 0, 3)),
            Perm((1, 0, 3, 2)),
            Perm((0, 3, 2, 1)),
            Perm((1, 3, 2, 0)),
            Perm((0,)),
            Perm((3, 1, 2, 0)),
            Perm((1, 3, 2, 0)),
        ]
    ) == DFA(
        states={"0", "3", "1", "2"},
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "0": {"R": "3", "D": "0", "L": "3", "U": "0"},
            "3": {"R": "3", "D": "3", "L": "3", "U": "3"},
            "1": {"R": "1", "D": "3", "L": "1", "U": "3"},
            "2": {"R": "1", "D": "0", "L": "1", "U": "0"},
        },
        initial_state="2",
        final_states={"3"},
    )
    assert PinWords.make_dfa_for_basis_from_pinwords(
        [
            Perm((0, 1, 2)),
            Perm((0, 3, 2, 1)),
            Perm((2, 0, 1, 3)),
            Perm((0, 1, 3, 2)),
            Perm((0, 3, 1, 2)),
            Perm((3, 0, 1, 2)),
            Perm((1, 0, 2, 3)),
            Perm((2, 3, 1, 0)),
            Perm((0, 2, 3, 1)),
            Perm((1, 3, 0, 2)),
            Perm((0,)),
        ]
    ) == DFA(
        states={"0", "3", "1", "2"},
        input_symbols={"R", "D", "L", "U"},
        transitions={
            "0": {"R": "2", "D": "0", "L": "2", "U": "0"},
            "3": {"R": "1", "D": "0", "L": "1", "U": "0"},
            "1": {"R": "1", "D": "2", "L": "1", "U": "2"},
            "2": {"R": "2", "D": "2", "L": "2", "U": "2"},
        },
        initial_state="3",
        final_states={"2"},
    )


def test_make_dfa_for_basis_from_db():
    assert PinWords.make_dfa_for_basis_from_db([Perm((1, 3, 0, 2))]) == DFA(
        states={
            "5",
            "6",
            "2",
            "14",
            "4",
            "10",
            "8",
            "9",
            "7",
            "12",
            "13",
            "1",
            "3",
            "11",
            "0",
            "15",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "15": {"D": "13", "R": "11", "U": "6", "L": "1"},
            "0": {"D": "13", "R": "14", "U": "6", "L": "1"},
            "3": {"D": "6", "R": "3", "U": "13", "L": "3"},
            "12": {"D": "13", "R": "5", "U": "6", "L": "5"},
            "6": {"D": "13", "R": "2", "U": "6", "L": "5"},
            "13": {"D": "13", "R": "5", "U": "6", "L": "2"},
            "8": {"D": "10", "R": "3", "U": "10", "L": "3"},
            "2": {"D": "15", "R": "9", "U": "15", "L": "7"},
            "7": {"D": "15", "R": "9", "U": "12", "L": "7"},
            "14": {"D": "14", "R": "14", "U": "14", "L": "14"},
            "11": {"D": "14", "R": "9", "U": "0", "L": "7"},
            "4": {"D": "13", "R": "11", "U": "6", "L": "14"},
            "9": {"D": "12", "R": "9", "U": "15", "L": "7"},
            "5": {"D": "4", "R": "9", "U": "0", "L": "7"},
            "10": {"D": "10", "R": "7", "U": "10", "L": "9"},
            "1": {"D": "4", "R": "9", "U": "14", "L": "7"},
        },
        initial_state="8",
        final_states={"14"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [Perm((0, 1, 2, 3)), Perm((2, 1, 0, 3))]
    ) == DFA(
        states={
            "31",
            "60",
            "5",
            "29",
            "58",
            "18",
            "43",
            "56",
            "51",
            "33",
            "23",
            "10",
            "20",
            "8",
            "57",
            "7",
            "28",
            "25",
            "39",
            "64",
            "55",
            "54",
            "21",
            "63",
            "16",
            "12",
            "45",
            "42",
            "38",
            "34",
            "24",
            "0",
            "44",
            "50",
            "17",
            "61",
            "41",
            "47",
            "6",
            "36",
            "15",
            "48",
            "62",
            "22",
            "19",
            "37",
            "32",
            "2",
            "53",
            "14",
            "4",
            "9",
            "46",
            "30",
            "65",
            "11",
            "13",
            "35",
            "49",
            "1",
            "27",
            "3",
            "59",
            "26",
            "40",
            "52",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "48": {"D": "45", "L": "48", "U": "34", "R": "44"},
            "39": {"D": "40", "L": "22", "U": "39", "R": "29"},
            "30": {"D": "59", "L": "30", "U": "63", "R": "30"},
            "18": {"D": "33", "L": "61", "U": "42", "R": "19"},
            "13": {"D": "7", "L": "30", "U": "7", "R": "30"},
            "51": {"D": "29", "L": "22", "U": "21", "R": "8"},
            "49": {"D": "54", "L": "48", "U": "34", "R": "44"},
            "0": {"D": "53", "L": "50", "U": "35", "R": "10"},
            "42": {"D": "40", "L": "22", "U": "39", "R": "24"},
            "6": {"D": "6", "L": "0", "U": "3", "R": "28"},
            "3": {"D": "6", "L": "36", "U": "3", "R": "29"},
            "62": {"D": "43", "L": "36", "U": "62", "R": "46"},
            "22": {"D": "29", "L": "22", "U": "39", "R": "8"},
            "34": {"D": "33", "L": "61", "U": "15", "R": "55"},
            "16": {"D": "45", "L": "61", "U": "15", "R": "19"},
            "57": {"D": "27", "L": "57", "U": "5", "R": "25"},
            "46": {"D": "29", "L": "61", "U": "37", "R": "19"},
            "23": {"D": "53", "L": "50", "U": "35", "R": "24"},
            "35": {"D": "53", "L": "50", "U": "35", "R": "29"},
            "53": {"D": "53", "L": "45", "U": "35", "R": "10"},
            "36": {"D": "0", "L": "11", "U": "35", "R": "58"},
            "7": {"D": "7", "L": "17", "U": "7", "R": "56"},
            "28": {"D": "0", "L": "11", "U": "29", "R": "58"},
            "63": {"D": "63", "L": "49", "U": "59", "R": "2"},
            "1": {"D": "6", "L": "0", "U": "3", "R": "10"},
            "56": {"D": "26", "L": "56", "U": "31", "R": "17"},
            "4": {"D": "33", "L": "29", "U": "15", "R": "65"},
            "8": {"D": "40", "L": "22", "U": "29", "R": "8"},
            "19": {"D": "53", "L": "61", "U": "47", "R": "19"},
            "32": {"D": "33", "L": "50", "U": "15", "R": "65"},
            "65": {"D": "29", "L": "61", "U": "47", "R": "19"},
            "50": {"D": "45", "L": "50", "U": "35", "R": "10"},
            "27": {"D": "33", "L": "61", "U": "15", "R": "38"},
            "20": {"D": "20", "L": "45", "U": "41", "R": "18"},
            "60": {"D": "0", "L": "11", "U": "9", "R": "58"},
            "52": {"D": "6", "L": "0", "U": "3", "R": "29"},
            "61": {"D": "45", "L": "61", "U": "23", "R": "19"},
            "47": {"D": "40", "L": "29", "U": "39", "R": "24"},
            "37": {"D": "33", "L": "29", "U": "15", "R": "51"},
            "25": {"D": "1", "L": "57", "U": "4", "R": "25"},
            "9": {"D": "53", "L": "29", "U": "35", "R": "29"},
            "33": {"D": "33", "L": "45", "U": "15", "R": "38"},
            "41": {"D": "20", "L": "16", "U": "41", "R": "45"},
            "31": {"D": "43", "L": "14", "U": "62", "R": "12"},
            "5": {"D": "6", "L": "0", "U": "3", "R": "64"},
            "2": {"D": "27", "L": "57", "U": "32", "R": "25"},
            "14": {"D": "33", "L": "61", "U": "23", "R": "19"},
            "43": {"D": "43", "L": "14", "U": "62", "R": "60"},
            "17": {"D": "31", "L": "56", "U": "26", "R": "17"},
            "44": {"D": "54", "L": "48", "U": "45", "R": "44"},
            "59": {"D": "63", "L": "2", "U": "59", "R": "49"},
            "64": {"D": "29", "L": "50", "U": "29", "R": "10"},
            "54": {"D": "33", "L": "45", "U": "15", "R": "19"},
            "45": {"D": "40", "L": "22", "U": "39", "R": "8"},
            "24": {"D": "29", "L": "22", "U": "29", "R": "8"},
            "58": {"D": "1", "L": "11", "U": "29", "R": "58"},
            "10": {"D": "53", "L": "50", "U": "29", "R": "10"},
            "26": {"D": "20", "L": "16", "U": "41", "R": "18"},
            "12": {"D": "53", "L": "61", "U": "37", "R": "19"},
            "38": {"D": "53", "L": "50", "U": "21", "R": "10"},
            "11": {"D": "0", "L": "11", "U": "52", "R": "58"},
            "29": {"D": "29", "L": "29", "U": "29", "R": "29"},
            "40": {"D": "40", "L": "29", "U": "39", "R": "8"},
            "55": {"D": "40", "L": "22", "U": "21", "R": "8"},
            "15": {"D": "33", "L": "50", "U": "15", "R": "51"},
            "21": {"D": "40", "L": "29", "U": "39", "R": "29"},
        },
        initial_state="13",
        final_states={"29"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [Perm((0, 1, 2)), Perm(()), Perm((2, 0, 1))]
    ) == DFA(
        states={"0"},
        input_symbols={"D", "L", "U", "R"},
        transitions={"0": {"D": "0", "L": "0", "U": "0", "R": "0"}},
        initial_state="0",
        final_states={"0"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [Perm((3, 2, 0, 1)), Perm((0, 3, 1, 2)), Perm((1, 2, 3, 0)), Perm((1, 2, 0, 3))]
    ) == DFA(
        states={
            "29",
            "81",
            "43",
            "51",
            "7",
            "28",
            "64",
            "54",
            "67",
            "12",
            "82",
            "98",
            "44",
            "17",
            "41",
            "6",
            "48",
            "2",
            "14",
            "9",
            "80",
            "13",
            "10",
            "88",
            "60",
            "75",
            "83",
            "76",
            "87",
            "71",
            "100",
            "99",
            "57",
            "21",
            "84",
            "63",
            "16",
            "0",
            "47",
            "36",
            "62",
            "46",
            "86",
            "65",
            "95",
            "93",
            "59",
            "94",
            "52",
            "40",
            "58",
            "18",
            "56",
            "102",
            "72",
            "77",
            "20",
            "8",
            "73",
            "89",
            "101",
            "25",
            "70",
            "42",
            "38",
            "24",
            "32",
            "53",
            "4",
            "30",
            "35",
            "103",
            "49",
            "27",
            "15",
            "31",
            "85",
            "5",
            "78",
            "69",
            "33",
            "23",
            "91",
            "96",
            "92",
            "55",
            "39",
            "45",
            "34",
            "50",
            "61",
            "22",
            "19",
            "37",
            "74",
            "68",
            "97",
            "79",
            "90",
            "1",
            "66",
            "3",
            "11",
            "26",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "48": {"D": "0", "L": "30", "U": "94", "R": "58"},
            "13": {"D": "94", "L": "30", "U": "79", "R": "58"},
            "30": {"D": "68", "L": "30", "U": "28", "R": "58"},
            "18": {"D": "103", "L": "87", "U": "18", "R": "94"},
            "39": {"D": "39", "L": "94", "U": "41", "R": "47"},
            "51": {"D": "82", "L": "51", "U": "91", "R": "34"},
            "99": {"D": "2", "L": "36", "U": "38", "R": "99"},
            "0": {"D": "0", "L": "94", "U": "57", "R": "94"},
            "42": {"D": "102", "L": "95", "U": "11", "R": "63"},
            "73": {"D": "73", "L": "55", "U": "45", "R": "16"},
            "62": {"D": "0", "L": "23", "U": "37", "R": "100"},
            "84": {"D": "37", "L": "98", "U": "26", "R": "65"},
            "34": {"D": "94", "L": "51", "U": "94", "R": "34"},
            "57": {"D": "0", "L": "94", "U": "57", "R": "76"},
            "46": {"D": "46", "L": "94", "U": "4", "R": "47"},
            "77": {"D": "22", "L": "12", "U": "77", "R": "42"},
            "98": {"D": "50", "L": "98", "U": "26", "R": "65"},
            "35": {"D": "7", "L": "51", "U": "94", "R": "34"},
            "75": {"D": "75", "L": "1", "U": "75", "R": "70"},
            "53": {"D": "53", "L": "55", "U": "96", "R": "92"},
            "36": {"D": "27", "L": "36", "U": "97", "R": "99"},
            "7": {"D": "20", "L": "94", "U": "25", "R": "94"},
            "28": {"D": "0", "L": "17", "U": "57", "R": "80"},
            "63": {"D": "67", "L": "95", "U": "38", "R": "63"},
            "1": {"D": "44", "L": "70", "U": "78", "R": "1"},
            "56": {"D": "0", "L": "94", "U": "57", "R": "80"},
            "4": {"D": "46", "L": "94", "U": "4", "R": "76"},
            "8": {"D": "94", "L": "59", "U": "21", "R": "15"},
            "19": {"D": "61", "L": "51", "U": "94", "R": "34"},
            "32": {"D": "32", "L": "83", "U": "89", "R": "8"},
            "89": {"D": "32", "L": "12", "U": "89", "R": "54"},
            "90": {"D": "39", "L": "98", "U": "18", "R": "65"},
            "27": {"D": "81", "L": "48", "U": "5", "R": "34"},
            "20": {"D": "20", "L": "35", "U": "25", "R": "94"},
            "66": {"D": "73", "L": "94", "U": "45", "R": "94"},
            "67": {"D": "103", "L": "94", "U": "18", "R": "33"},
            "60": {"D": "94", "L": "31", "U": "61", "R": "14"},
            "68": {"D": "81", "L": "48", "U": "5", "R": "94"},
            "94": {"D": "94", "L": "94", "U": "94", "R": "94"},
            "52": {"D": "64", "L": "36", "U": "26", "R": "99"},
            "47": {"D": "94", "L": "47", "U": "94", "R": "33"},
            "25": {"D": "20", "L": "24", "U": "25", "R": "94"},
            "33": {"D": "41", "L": "47", "U": "94", "R": "33"},
            "9": {"D": "73", "L": "52", "U": "45", "R": "3"},
            "41": {"D": "39", "L": "94", "U": "41", "R": "94"},
            "97": {"D": "46", "L": "47", "U": "4", "R": "80"},
            "85": {"D": "81", "L": "94", "U": "5", "R": "94"},
            "31": {"D": "94", "L": "31", "U": "94", "R": "14"},
            "5": {"D": "81", "L": "62", "U": "5", "R": "13"},
            "14": {"D": "41", "L": "31", "U": "56", "R": "14"},
            "44": {"D": "32", "L": "90", "U": "89", "R": "71"},
            "101": {"D": "32", "L": "90", "U": "89", "R": "94"},
            "69": {"D": "39", "L": "36", "U": "25", "R": "99"},
            "92": {"D": "39", "L": "98", "U": "94", "R": "65"},
            "64": {"D": "0", "L": "94", "U": "57", "R": "17"},
            "81": {"D": "81", "L": "55", "U": "5", "R": "94"},
            "24": {"D": "61", "L": "17", "U": "61", "R": "17"},
            "10": {"D": "73", "L": "94", "U": "45", "R": "47"},
            "26": {"D": "39", "L": "47", "U": "41", "R": "94"},
            "38": {"D": "81", "L": "49", "U": "5", "R": "72"},
            "11": {"D": "73", "L": "87", "U": "45", "R": "94"},
            "87": {"D": "37", "L": "47", "U": "41", "R": "33"},
            "29": {"D": "46", "L": "94", "U": "4", "R": "94"},
            "55": {"D": "85", "L": "30", "U": "94", "R": "58"},
            "49": {"D": "0", "L": "23", "U": "61", "R": "100"},
            "6": {"D": "73", "L": "52", "U": "45", "R": "93"},
            "3": {"D": "94", "L": "36", "U": "25", "R": "99"},
            "78": {"D": "53", "L": "52", "U": "96", "R": "69"},
            "100": {"D": "94", "L": "23", "U": "56", "R": "100"},
            "22": {"D": "22", "L": "42", "U": "77", "R": "12"},
            "16": {"D": "94", "L": "98", "U": "94", "R": "65"},
            "23": {"D": "94", "L": "23", "U": "94", "R": "100"},
            "96": {"D": "53", "L": "43", "U": "96", "R": "13"},
            "76": {"D": "94", "L": "23", "U": "0", "R": "100"},
            "102": {"D": "73", "L": "94", "U": "45", "R": "33"},
            "79": {"D": "81", "L": "24", "U": "5", "R": "94"},
            "71": {"D": "29", "L": "31", "U": "41", "R": "14"},
            "91": {"D": "61", "L": "17", "U": "61", "R": "94"},
            "70": {"D": "78", "L": "70", "U": "44", "R": "1"},
            "65": {"D": "2", "L": "98", "U": "94", "R": "65"},
            "50": {"D": "20", "L": "19", "U": "25", "R": "34"},
            "74": {"D": "75", "L": "88", "U": "75", "R": "88"},
            "103": {"D": "103", "L": "35", "U": "18", "R": "16"},
            "61": {"D": "61", "L": "94", "U": "61", "R": "94"},
            "37": {"D": "61", "L": "94", "U": "61", "R": "17"},
            "72": {"D": "94", "L": "30", "U": "25", "R": "58"},
            "2": {"D": "103", "L": "94", "U": "18", "R": "94"},
            "82": {"D": "20", "L": "19", "U": "25", "R": "94"},
            "43": {"D": "64", "L": "31", "U": "40", "R": "14"},
            "17": {"D": "94", "L": "17", "U": "94", "R": "17"},
            "59": {"D": "9", "L": "59", "U": "44", "R": "15"},
            "45": {"D": "73", "L": "43", "U": "45", "R": "13"},
            "54": {"D": "66", "L": "36", "U": "11", "R": "99"},
            "58": {"D": "94", "L": "30", "U": "38", "R": "58"},
            "80": {"D": "94", "L": "23", "U": "61", "R": "100"},
            "95": {"D": "27", "L": "95", "U": "97", "R": "63"},
            "86": {"D": "46", "L": "47", "U": "4", "R": "60"},
            "93": {"D": "41", "L": "36", "U": "25", "R": "99"},
            "83": {"D": "10", "L": "36", "U": "11", "R": "99"},
            "12": {"D": "86", "L": "59", "U": "21", "R": "15"},
            "88": {"D": "77", "L": "88", "U": "22", "R": "88"},
            "40": {"D": "39", "L": "94", "U": "41", "R": "17"},
            "15": {"D": "101", "L": "59", "U": "6", "R": "15"},
            "21": {"D": "103", "L": "84", "U": "18", "R": "33"},
        },
        initial_state="74",
        final_states={"94"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((0, 1, 3, 2)),
            Perm((3, 2, 1, 0)),
            Perm((0, 1, 3, 2)),
            Perm((0, 1, 2, 3)),
            Perm((3, 0, 2, 1)),
        ]
    ) == DFA(
        states={
            "29",
            "81",
            "43",
            "51",
            "104",
            "7",
            "28",
            "64",
            "54",
            "67",
            "106",
            "82",
            "12",
            "98",
            "44",
            "17",
            "41",
            "6",
            "48",
            "2",
            "14",
            "119",
            "9",
            "80",
            "13",
            "10",
            "88",
            "60",
            "75",
            "83",
            "110",
            "76",
            "118",
            "87",
            "71",
            "100",
            "99",
            "57",
            "21",
            "84",
            "63",
            "16",
            "120",
            "0",
            "47",
            "36",
            "62",
            "115",
            "116",
            "46",
            "86",
            "65",
            "95",
            "93",
            "113",
            "59",
            "94",
            "52",
            "40",
            "117",
            "58",
            "18",
            "56",
            "102",
            "72",
            "77",
            "20",
            "8",
            "73",
            "89",
            "101",
            "25",
            "70",
            "42",
            "38",
            "24",
            "32",
            "53",
            "112",
            "4",
            "30",
            "35",
            "103",
            "49",
            "27",
            "15",
            "31",
            "114",
            "85",
            "5",
            "105",
            "78",
            "111",
            "121",
            "69",
            "33",
            "107",
            "23",
            "91",
            "96",
            "92",
            "55",
            "39",
            "45",
            "34",
            "50",
            "108",
            "61",
            "22",
            "19",
            "37",
            "74",
            "68",
            "97",
            "79",
            "109",
            "90",
            "1",
            "66",
            "3",
            "11",
            "26",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "48": {"D": "108", "L": "10", "U": "52", "R": "6"},
            "30": {"D": "28", "L": "17", "U": "76", "R": "73"},
            "39": {"D": "69", "L": "25", "U": "110", "R": "93"},
            "13": {"D": "28", "L": "5", "U": "76", "R": "29"},
            "51": {"D": "8", "L": "101", "U": "116", "R": "38"},
            "18": {"D": "69", "L": "106", "U": "65", "R": "29"},
            "117": {"D": "70", "L": "12", "U": "63", "R": "43"},
            "99": {"D": "69", "L": "25", "U": "65", "R": "91"},
            "0": {"D": "69", "L": "73", "U": "65", "R": "73"},
            "42": {"D": "28", "L": "16", "U": "76", "R": "48"},
            "73": {"D": "73", "L": "73", "U": "73", "R": "73"},
            "62": {"D": "73", "L": "105", "U": "73", "R": "96"},
            "111": {"D": "111", "L": "92", "U": "78", "R": "45"},
            "84": {"D": "73", "L": "106", "U": "44", "R": "84"},
            "118": {"D": "112", "L": "118", "U": "74", "R": "27"},
            "34": {"D": "44", "L": "106", "U": "73", "R": "84"},
            "57": {"D": "28", "L": "16", "U": "76", "R": "59"},
            "46": {"D": "73", "L": "46", "U": "73", "R": "46"},
            "77": {"D": "63", "L": "25", "U": "110", "R": "93"},
            "98": {"D": "73", "L": "98", "U": "36", "R": "21"},
            "35": {"D": "72", "L": "67", "U": "35", "R": "73"},
            "110": {"D": "103", "L": "73", "U": "110", "R": "46"},
            "75": {"D": "24", "L": "2", "U": "23", "R": "113"},
            "116": {"D": "8", "L": "49", "U": "116", "R": "58"},
            "53": {"D": "28", "L": "5", "U": "76", "R": "59"},
            "36": {"D": "82", "L": "9", "U": "88", "R": "73"},
            "7": {"D": "120", "L": "10", "U": "47", "R": "6"},
            "28": {"D": "28", "L": "11", "U": "76", "R": "1"},
            "63": {"D": "70", "L": "73", "U": "63", "R": "73"},
            "1": {"D": "108", "L": "105", "U": "44", "R": "96"},
            "56": {"D": "82", "L": "73", "U": "88", "R": "73"},
            "4": {"D": "82", "L": "73", "U": "88", "R": "29"},
            "8": {"D": "8", "L": "115", "U": "116", "R": "90"},
            "19": {"D": "51", "L": "19", "U": "75", "R": "104"},
            "32": {"D": "103", "L": "73", "U": "110", "R": "84"},
            "89": {"D": "89", "L": "104", "U": "89", "R": "19"},
            "90": {"D": "30", "L": "10", "U": "88", "R": "6"},
            "27": {"D": "42", "L": "118", "U": "15", "R": "27"},
            "108": {"D": "108", "L": "43", "U": "37", "R": "73"},
            "20": {"D": "121", "L": "73", "U": "20", "R": "5"},
            "66": {"D": "82", "L": "119", "U": "88", "R": "73"},
            "67": {"D": "73", "L": "9", "U": "88", "R": "109"},
            "68": {"D": "71", "L": "94", "U": "53", "R": "68"},
            "60": {"D": "69", "L": "25", "U": "65", "R": "29"},
            "94": {"D": "99", "L": "94", "U": "95", "R": "68"},
            "52": {"D": "70", "L": "46", "U": "63", "R": "73"},
            "105": {"D": "107", "L": "105", "U": "73", "R": "96"},
            "47": {"D": "103", "L": "106", "U": "110", "R": "46"},
            "25": {"D": "73", "L": "25", "U": "73", "R": "93"},
            "33": {"D": "73", "L": "46", "U": "44", "R": "46"},
            "9": {"D": "73", "L": "9", "U": "107", "R": "109"},
            "41": {"D": "108", "L": "73", "U": "37", "R": "84"},
            "97": {"D": "89", "L": "79", "U": "89", "R": "79"},
            "85": {"D": "69", "L": "12", "U": "65", "R": "73"},
            "31": {"D": "28", "L": "77", "U": "76", "R": "73"},
            "5": {"D": "73", "L": "105", "U": "110", "R": "96"},
            "14": {"D": "82", "L": "73", "U": "88", "R": "87"},
            "44": {"D": "44", "L": "73", "U": "44", "R": "73"},
            "101": {"D": "66", "L": "10", "U": "18", "R": "6"},
            "69": {"D": "69", "L": "73", "U": "65", "R": "91"},
            "92": {"D": "57", "L": "118", "U": "60", "R": "27"},
            "64": {"D": "83", "L": "12", "U": "73", "R": "64"},
            "81": {"D": "56", "L": "9", "U": "73", "R": "109"},
            "24": {"D": "24", "L": "39", "U": "23", "R": "86"},
            "26": {"D": "22", "L": "10", "U": "18", "R": "6"},
            "10": {"D": "117", "L": "10", "U": "3", "R": "6"},
            "38": {"D": "0", "L": "25", "U": "63", "R": "93"},
            "11": {"D": "70", "L": "12", "U": "44", "R": "64"},
            "87": {"D": "44", "L": "9", "U": "73", "R": "109"},
            "29": {"D": "44", "L": "12", "U": "73", "R": "64"},
            "55": {"D": "103", "L": "106", "U": "73", "R": "84"},
            "49": {"D": "66", "L": "10", "U": "13", "R": "6"},
            "6": {"D": "102", "L": "10", "U": "88", "R": "6"},
            "3": {"D": "108", "L": "62", "U": "37", "R": "46"},
            "78": {"D": "111", "L": "45", "U": "78", "R": "92"},
            "100": {"D": "73", "L": "40", "U": "41", "R": "100"},
            "104": {"D": "75", "L": "19", "U": "51", "R": "104"},
            "22": {"D": "108", "L": "43", "U": "37", "R": "84"},
            "16": {"D": "63", "L": "9", "U": "107", "R": "109"},
            "23": {"D": "24", "L": "100", "U": "23", "R": "26"},
            "96": {"D": "73", "L": "105", "U": "44", "R": "96"},
            "112": {"D": "72", "L": "114", "U": "35", "R": "54"},
            "76": {"D": "28", "L": "50", "U": "76", "R": "109"},
            "102": {"D": "108", "L": "43", "U": "37", "R": "96"},
            "79": {"D": "78", "L": "79", "U": "111", "R": "79"},
            "71": {"D": "121", "L": "55", "U": "20", "R": "5"},
            "91": {"D": "103", "L": "106", "U": "44", "R": "84"},
            "115": {"D": "4", "L": "98", "U": "120", "R": "21"},
            "114": {"D": "73", "L": "9", "U": "52", "R": "109"},
            "70": {"D": "70", "L": "73", "U": "63", "R": "43"},
            "119": {"D": "73", "L": "12", "U": "44", "R": "64"},
            "65": {"D": "69", "L": "73", "U": "65", "R": "64"},
            "50": {"D": "73", "L": "105", "U": "37", "R": "96"},
            "121": {"D": "121", "L": "55", "U": "20", "R": "73"},
            "106": {"D": "73", "L": "106", "U": "73", "R": "84"},
            "74": {"D": "28", "L": "7", "U": "76", "R": "87"},
            "103": {"D": "103", "L": "73", "U": "110", "R": "73"},
            "61": {"D": "103", "L": "106", "U": "110", "R": "73"},
            "37": {"D": "108", "L": "73", "U": "37", "R": "46"},
            "72": {"D": "72", "L": "73", "U": "35", "R": "81"},
            "2": {"D": "85", "L": "10", "U": "47", "R": "6"},
            "120": {"D": "70", "L": "12", "U": "63", "R": "73"},
            "82": {"D": "82", "L": "73", "U": "88", "R": "43"},
            "43": {"D": "44", "L": "46", "U": "73", "R": "46"},
            "17": {"D": "63", "L": "12", "U": "44", "R": "64"},
            "59": {"D": "103", "L": "25", "U": "63", "R": "93"},
            "45": {"D": "31", "L": "94", "U": "53", "R": "68"},
            "54": {"D": "63", "L": "12", "U": "73", "R": "64"},
            "109": {"D": "83", "L": "9", "U": "73", "R": "109"},
            "58": {"D": "4", "L": "98", "U": "73", "R": "21"},
            "95": {"D": "121", "L": "62", "U": "20", "R": "5"},
            "80": {"D": "108", "L": "34", "U": "37", "R": "73"},
            "86": {"D": "80", "L": "40", "U": "41", "R": "100"},
            "93": {"D": "32", "L": "25", "U": "63", "R": "93"},
            "83": {"D": "44", "L": "73", "U": "44", "R": "46"},
            "107": {"D": "44", "L": "46", "U": "44", "R": "73"},
            "12": {"D": "73", "L": "12", "U": "73", "R": "64"},
            "113": {"D": "108", "L": "10", "U": "18", "R": "6"},
            "88": {"D": "82", "L": "33", "U": "88", "R": "73"},
            "40": {"D": "61", "L": "40", "U": "73", "R": "100"},
            "15": {"D": "72", "L": "114", "U": "35", "R": "73"},
            "21": {"D": "14", "L": "98", "U": "73", "R": "21"},
        },
        initial_state="97",
        final_states={"73"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((1, 0)),
            Perm((0, 3, 1, 2)),
            Perm((2, 1, 0)),
            Perm((0, 1, 2)),
            Perm((2, 1, 0, 3)),
            Perm((2, 1, 0)),
        ]
    ) == DFA(
        states={"9", "7", "5", "6", "1", "3", "2", "4", "0", "8"},
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "4": {"D": "5", "L": "3", "U": "4", "R": "7"},
            "5": {"D": "5", "L": "7", "U": "4", "R": "3"},
            "2": {"D": "1", "L": "2", "U": "3", "R": "8"},
            "8": {"D": "3", "L": "2", "U": "1", "R": "8"},
            "0": {"D": "4", "L": "0", "U": "5", "R": "0"},
            "7": {"D": "3", "L": "7", "U": "3", "R": "7"},
            "9": {"D": "6", "L": "0", "U": "6", "R": "0"},
            "6": {"D": "6", "L": "8", "U": "6", "R": "2"},
            "1": {"D": "1", "L": "3", "U": "1", "R": "3"},
            "3": {"D": "3", "L": "3", "U": "3", "R": "3"},
        },
        initial_state="9",
        final_states={"3"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((0, 1, 2)),
            Perm((3, 2, 0, 1)),
            Perm((3, 2, 1, 0)),
            Perm((3, 2, 0, 1)),
            Perm((0, 2, 1)),
            Perm((2, 1, 0, 3)),
            Perm((3, 1, 0, 2)),
        ]
    ) == DFA(
        states={
            "31",
            "5",
            "29",
            "18",
            "33",
            "23",
            "20",
            "8",
            "7",
            "25",
            "28",
            "21",
            "16",
            "12",
            "34",
            "24",
            "0",
            "17",
            "6",
            "36",
            "22",
            "19",
            "37",
            "32",
            "2",
            "14",
            "4",
            "9",
            "30",
            "11",
            "13",
            "35",
            "1",
            "27",
            "3",
            "10",
            "26",
            "15",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "30": {"D": "26", "L": "19", "U": "11", "R": "23"},
            "13": {"D": "6", "L": "23", "U": "1", "R": "19"},
            "27": {"D": "8", "L": "7", "U": "23", "R": "5"},
            "18": {"D": "22", "L": "36", "U": "22", "R": "36"},
            "20": {"D": "3", "L": "21", "U": "20", "R": "27"},
            "0": {"D": "23", "L": "14", "U": "33", "R": "14"},
            "6": {"D": "6", "L": "23", "U": "1", "R": "14"},
            "32": {"D": "23", "L": "32", "U": "24", "R": "34"},
            "3": {"D": "3", "L": "27", "U": "20", "R": "21"},
            "22": {"D": "22", "L": "37", "U": "22", "R": "29"},
            "34": {"D": "33", "L": "32", "U": "23", "R": "34"},
            "16": {"D": "16", "L": "23", "U": "8", "R": "14"},
            "37": {"D": "15", "L": "29", "U": "30", "R": "37"},
            "23": {"D": "23", "L": "23", "U": "23", "R": "23"},
            "25": {"D": "6", "L": "14", "U": "1", "R": "23"},
            "33": {"D": "33", "L": "23", "U": "33", "R": "23"},
            "9": {"D": "8", "L": "32", "U": "23", "R": "34"},
            "35": {"D": "10", "L": "0", "U": "35", "R": "19"},
            "31": {"D": "23", "L": "19", "U": "8", "R": "28"},
            "5": {"D": "13", "L": "7", "U": "23", "R": "5"},
            "2": {"D": "23", "L": "2", "U": "24", "R": "17"},
            "14": {"D": "23", "L": "14", "U": "23", "R": "14"},
            "36": {"D": "20", "L": "36", "U": "3", "R": "36"},
            "7": {"D": "23", "L": "7", "U": "4", "R": "5"},
            "17": {"D": "33", "L": "2", "U": "8", "R": "17"},
            "28": {"D": "33", "L": "19", "U": "23", "R": "28"},
            "1": {"D": "6", "L": "0", "U": "1", "R": "23"},
            "24": {"D": "33", "L": "14", "U": "33", "R": "23"},
            "4": {"D": "16", "L": "19", "U": "8", "R": "23"},
            "8": {"D": "16", "L": "23", "U": "8", "R": "23"},
            "10": {"D": "10", "L": "23", "U": "35", "R": "0"},
            "19": {"D": "23", "L": "19", "U": "23", "R": "28"},
            "26": {"D": "26", "L": "23", "U": "11", "R": "9"},
            "29": {"D": "30", "L": "29", "U": "15", "R": "37"},
            "12": {"D": "23", "L": "32", "U": "23", "R": "34"},
            "11": {"D": "26", "L": "31", "U": "11", "R": "23"},
            "15": {"D": "10", "L": "12", "U": "35", "R": "19"},
            "21": {"D": "8", "L": "2", "U": "25", "R": "17"},
        },
        initial_state="18",
        final_states={"23"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm(()),
            Perm((0, 2, 3, 1)),
            Perm((1, 0)),
            Perm((2, 3, 1, 0)),
            Perm((2, 0, 3, 1)),
            Perm(()),
            Perm((1, 0, 3, 2)),
            Perm((3, 0, 2, 1)),
        ]
    ) == DFA(
        states={"0"},
        input_symbols={"D", "L", "U", "R"},
        transitions={"0": {"D": "0", "L": "0", "U": "0", "R": "0"}},
        initial_state="0",
        final_states={"0"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((0,)),
            Perm((3, 2, 1, 0)),
            Perm((0, 3, 2, 1)),
            Perm(()),
            Perm((0, 1)),
            Perm((0, 1)),
            Perm((0, 1)),
            Perm((0, 3, 1, 2)),
            Perm((0, 1, 3, 2)),
        ]
    ) == DFA(
        states={"0"},
        input_symbols={"D", "L", "U", "R"},
        transitions={"0": {"D": "0", "L": "0", "U": "0", "R": "0"}},
        initial_state="0",
        final_states={"0"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((3, 1, 2, 0)),
            Perm((2, 1, 0, 3)),
            Perm((2, 1, 3, 0)),
            Perm((2, 0, 3, 1)),
            Perm((1, 0, 2)),
            Perm((1, 3, 0, 2)),
            Perm((0,)),
            Perm((1, 2, 3, 0)),
            Perm((1, 0, 3, 2)),
            Perm((1, 0, 2, 3)),
        ]
    ) == DFA(
        states={"1", "0", "3", "2"},
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "2": {"D": "1", "L": "2", "U": "1", "R": "2"},
            "0": {"D": "0", "L": "1", "U": "0", "R": "1"},
            "1": {"D": "1", "L": "1", "U": "1", "R": "1"},
            "3": {"D": "0", "L": "2", "U": "0", "R": "2"},
        },
        initial_state="3",
        final_states={"1"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((1, 0, 2, 3)),
            Perm((0, 3, 2, 1)),
            Perm((2, 3, 0, 1)),
            Perm((0, 1, 2)),
            Perm((0, 3, 1, 2)),
            Perm((1, 0, 2)),
            Perm((3, 1, 2, 0)),
            Perm((0, 1, 2, 3)),
            Perm((2, 1, 3, 0)),
            Perm((0, 1, 3, 2)),
            Perm((1, 0, 2, 3)),
        ]
    ) == DFA(
        states={
            "31",
            "5",
            "29",
            "18",
            "33",
            "23",
            "20",
            "8",
            "7",
            "25",
            "28",
            "39",
            "21",
            "16",
            "12",
            "38",
            "34",
            "24",
            "0",
            "17",
            "41",
            "6",
            "36",
            "22",
            "19",
            "37",
            "2",
            "14",
            "32",
            "4",
            "9",
            "30",
            "11",
            "13",
            "35",
            "1",
            "27",
            "3",
            "10",
            "40",
            "26",
            "15",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "30": {"D": "2", "L": "30", "U": "2", "R": "10"},
            "13": {"D": "39", "L": "3", "U": "11", "R": "1"},
            "39": {"D": "39", "L": "2", "U": "41", "R": "2"},
            "18": {"D": "19", "L": "3", "U": "2", "R": "1"},
            "27": {"D": "27", "L": "2", "U": "16", "R": "18"},
            "20": {"D": "17", "L": "37", "U": "20", "R": "2"},
            "0": {"D": "27", "L": "7", "U": "16", "R": "2"},
            "6": {"D": "23", "L": "7", "U": "38", "R": "37"},
            "3": {"D": "2", "L": "3", "U": "0", "R": "1"},
            "22": {"D": "22", "L": "29", "U": "40", "R": "14"},
            "34": {"D": "2", "L": "34", "U": "39", "R": "8"},
            "16": {"D": "27", "L": "4", "U": "16", "R": "2"},
            "37": {"D": "2", "L": "9", "U": "2", "R": "37"},
            "23": {"D": "23", "L": "31", "U": "38", "R": "18"},
            "25": {"D": "17", "L": "2", "U": "20", "R": "2"},
            "9": {"D": "2", "L": "9", "U": "39", "R": "37"},
            "33": {"D": "33", "L": "2", "U": "11", "R": "30"},
            "35": {"D": "28", "L": "32", "U": "2", "R": "35"},
            "15": {"D": "27", "L": "2", "U": "16", "R": "37"},
            "41": {"D": "39", "L": "37", "U": "41", "R": "2"},
            "31": {"D": "2", "L": "34", "U": "2", "R": "8"},
            "5": {"D": "17", "L": "2", "U": "20", "R": "31"},
            "2": {"D": "2", "L": "2", "U": "2", "R": "2"},
            "14": {"D": "19", "L": "32", "U": "11", "R": "35"},
            "36": {"D": "6", "L": "24", "U": "5", "R": "36"},
            "7": {"D": "2", "L": "30", "U": "11", "R": "10"},
            "17": {"D": "17", "L": "2", "U": "20", "R": "30"},
            "28": {"D": "27", "L": "30", "U": "16", "R": "37"},
            "1": {"D": "15", "L": "3", "U": "2", "R": "1"},
            "24": {"D": "5", "L": "24", "U": "6", "R": "36"},
            "4": {"D": "2", "L": "3", "U": "11", "R": "1"},
            "8": {"D": "11", "L": "34", "U": "2", "R": "8"},
            "10": {"D": "11", "L": "30", "U": "2", "R": "10"},
            "19": {"D": "39", "L": "2", "U": "41", "R": "37"},
            "26": {"D": "26", "L": "36", "U": "26", "R": "24"},
            "12": {"D": "26", "L": "21", "U": "26", "R": "21"},
            "38": {"D": "23", "L": "13", "U": "38", "R": "2"},
            "11": {"D": "33", "L": "2", "U": "11", "R": "2"},
            "29": {"D": "2", "L": "34", "U": "25", "R": "8"},
            "32": {"D": "25", "L": "32", "U": "0", "R": "35"},
            "40": {"D": "22", "L": "14", "U": "40", "R": "29"},
            "21": {"D": "40", "L": "21", "U": "22", "R": "21"},
        },
        initial_state="12",
        final_states={"2"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((3, 2, 0, 1)),
            Perm((3, 0, 2, 1)),
            Perm((1, 0, 3, 2)),
            Perm((2, 0, 1, 3)),
            Perm((3, 1, 0, 2)),
            Perm((1, 0, 3, 2)),
            Perm((3, 1, 2, 0)),
            Perm((0, 1, 2)),
            Perm((2, 3, 1, 0)),
            Perm((1, 2, 0, 3)),
            Perm((2, 0, 1, 3)),
            Perm((2, 0, 1)),
        ]
    ) == DFA(
        states={
            "5",
            "29",
            "18",
            "23",
            "20",
            "8",
            "7",
            "25",
            "28",
            "21",
            "16",
            "12",
            "24",
            "0",
            "17",
            "6",
            "22",
            "19",
            "2",
            "14",
            "4",
            "9",
            "11",
            "13",
            "1",
            "27",
            "3",
            "10",
            "26",
            "15",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "13": {"D": "8", "L": "24", "U": "28", "R": "3"},
            "18": {"D": "8", "L": "11", "U": "5", "R": "6"},
            "27": {"D": "16", "L": "20", "U": "23", "R": "8"},
            "20": {"D": "8", "L": "29", "U": "15", "R": "29"},
            "0": {"D": "27", "L": "17", "U": "1", "R": "0"},
            "6": {"D": "15", "L": "11", "U": "8", "R": "6"},
            "3": {"D": "27", "L": "24", "U": "21", "R": "3"},
            "22": {"D": "10", "L": "22", "U": "2", "R": "22"},
            "16": {"D": "16", "L": "18", "U": "23", "R": "13"},
            "25": {"D": "5", "L": "11", "U": "5", "R": "6"},
            "23": {"D": "16", "L": "7", "U": "23", "R": "12"},
            "9": {"D": "9", "L": "8", "U": "5", "R": "29"},
            "5": {"D": "9", "L": "8", "U": "5", "R": "8"},
            "2": {"D": "2", "L": "25", "U": "10", "R": "13"},
            "14": {"D": "14", "L": "0", "U": "14", "R": "17"},
            "7": {"D": "8", "L": "24", "U": "8", "R": "3"},
            "17": {"D": "1", "L": "17", "U": "27", "R": "0"},
            "28": {"D": "15", "L": "29", "U": "15", "R": "8"},
            "1": {"D": "9", "L": "11", "U": "5", "R": "11"},
            "24": {"D": "19", "L": "24", "U": "4", "R": "3"},
            "4": {"D": "16", "L": "8", "U": "23", "R": "8"},
            "8": {"D": "8", "L": "8", "U": "8", "R": "8"},
            "10": {"D": "2", "L": "13", "U": "10", "R": "25"},
            "19": {"D": "9", "L": "8", "U": "5", "R": "11"},
            "26": {"D": "14", "L": "22", "U": "14", "R": "22"},
            "12": {"D": "5", "L": "11", "U": "8", "R": "6"},
            "11": {"D": "8", "L": "11", "U": "8", "R": "6"},
            "29": {"D": "8", "L": "29", "U": "8", "R": "29"},
            "15": {"D": "15", "L": "8", "U": "15", "R": "8"},
            "21": {"D": "9", "L": "11", "U": "5", "R": "8"},
        },
        initial_state="26",
        final_states={"8"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((1, 2, 0)),
            Perm((0, 3, 1, 2)),
            Perm((2, 1, 3, 0)),
            Perm((0, 3, 2, 1)),
            Perm((2, 1, 0, 3)),
            Perm((2, 1, 3, 0)),
            Perm((1, 0, 3, 2)),
            Perm((2, 1, 0)),
            Perm((1, 3, 2, 0)),
            Perm((3, 2, 0, 1)),
            Perm((3, 1, 2, 0)),
            Perm((0, 2, 1, 3)),
            Perm((3, 2, 0, 1)),
        ]
    ) == DFA(
        states={
            "5",
            "29",
            "18",
            "23",
            "20",
            "8",
            "7",
            "25",
            "28",
            "21",
            "16",
            "12",
            "24",
            "0",
            "17",
            "6",
            "22",
            "19",
            "2",
            "14",
            "4",
            "9",
            "30",
            "11",
            "13",
            "1",
            "27",
            "3",
            "10",
            "26",
            "15",
        },
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "13": {"D": "20", "L": "29", "U": "2", "R": "16"},
            "18": {"D": "26", "L": "18", "U": "14", "R": "16"},
            "30": {"D": "30", "L": "28", "U": "30", "R": "17"},
            "27": {"D": "7", "L": "14", "U": "27", "R": "0"},
            "20": {"D": "20", "L": "8", "U": "2", "R": "14"},
            "0": {"D": "14", "L": "0", "U": "14", "R": "12"},
            "6": {"D": "26", "L": "6", "U": "14", "R": "10"},
            "3": {"D": "9", "L": "3", "U": "21", "R": "3"},
            "22": {"D": "7", "L": "6", "U": "14", "R": "10"},
            "16": {"D": "14", "L": "18", "U": "14", "R": "16"},
            "23": {"D": "20", "L": "29", "U": "2", "R": "14"},
            "25": {"D": "30", "L": "3", "U": "30", "R": "3"},
            "9": {"D": "21", "L": "22", "U": "9", "R": "15"},
            "5": {"D": "5", "L": "16", "U": "4", "R": "14"},
            "2": {"D": "20", "L": "29", "U": "2", "R": "24"},
            "14": {"D": "14", "L": "14", "U": "14", "R": "14"},
            "7": {"D": "7", "L": "14", "U": "27", "R": "14"},
            "17": {"D": "13", "L": "17", "U": "4", "R": "28"},
            "28": {"D": "4", "L": "17", "U": "13", "R": "28"},
            "1": {"D": "14", "L": "11", "U": "13", "R": "1"},
            "24": {"D": "14", "L": "11", "U": "26", "R": "1"},
            "4": {"D": "5", "L": "14", "U": "4", "R": "0"},
            "8": {"D": "7", "L": "11", "U": "14", "R": "1"},
            "10": {"D": "14", "L": "6", "U": "7", "R": "10"},
            "26": {"D": "19", "L": "14", "U": "26", "R": "14"},
            "19": {"D": "19", "L": "16", "U": "26", "R": "14"},
            "12": {"D": "14", "L": "0", "U": "7", "R": "12"},
            "11": {"D": "23", "L": "11", "U": "27", "R": "1"},
            "29": {"D": "7", "L": "0", "U": "14", "R": "12"},
            "15": {"D": "7", "L": "11", "U": "26", "R": "1"},
            "21": {"D": "21", "L": "15", "U": "9", "R": "22"},
        },
        initial_state="25",
        final_states={"14"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((0, 2, 1)),
            Perm((1, 3, 0, 2)),
            Perm((0, 3, 1, 2)),
            Perm((3, 0, 1, 2)),
            Perm((2, 1, 0)),
            Perm((3, 2, 0, 1)),
            Perm((2, 1, 0)),
            Perm((0,)),
            Perm((0,)),
            Perm((1, 3, 2, 0)),
            Perm((0, 1, 2)),
            Perm((0, 1, 2, 3)),
            Perm((0, 2, 3, 1)),
            Perm((3, 1, 2, 0)),
        ]
    ) == DFA(
        states={"1", "0", "3", "2"},
        input_symbols={"D", "L", "U", "R"},
        transitions={
            "2": {"D": "3", "L": "2", "U": "3", "R": "2"},
            "0": {"D": "0", "L": "3", "U": "0", "R": "3"},
            "1": {"D": "0", "L": "2", "U": "0", "R": "2"},
            "3": {"D": "3", "L": "3", "U": "3", "R": "3"},
        },
        initial_state="1",
        final_states={"3"},
    )
    assert PinWords.make_dfa_for_basis_from_db(
        [
            Perm((0, 1, 2, 3)),
            Perm((2, 1, 0)),
            Perm((2, 1, 0, 3)),
            Perm((3, 1, 0, 2)),
            Perm((3, 1, 2, 0)),
            Perm((2, 0, 1, 3)),
            Perm((0, 2, 1, 3)),
            Perm((2, 1, 0, 3)),
            Perm((3, 1, 2, 0)),
            Perm((0, 3, 2, 1)),
            Perm((1, 2, 0, 3)),
            Perm((2, 1, 3, 0)),
            Perm((1, 2, 0)),
            Perm((1, 0, 2, 3)),
            Perm(()),
        ]
    ) == DFA(
        states={"0"},
        input_symbols={"D", "L", "U", "R"},
        transitions={"0": {"D": "0", "L": "0", "U": "0", "R": "0"}},
        initial_state="0",
        final_states={"0"},
    )


def test_make_dfa_for_basis():
    assert PinWords.make_dfa_for_basis([Perm((1, 3, 0, 2))], use_db=False) == DFA(
        states={
            "2",
            "0",
            "7",
            "4",
            "8",
            "1",
            "14",
            "15",
            "10",
            "6",
            "5",
            "3",
            "12",
            "11",
            "9",
            "13",
        },
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "15": {"D": "11", "L": "8", "R": "8", "U": "11"},
            "3": {"D": "7", "L": "14", "R": "0", "U": "2"},
            "1": {"D": "4", "L": "3", "R": "2", "U": "13"},
            "12": {"D": "7", "L": "14", "R": "0", "U": "1"},
            "6": {"D": "10", "L": "14", "R": "0", "U": "10"},
            "9": {"D": "4", "L": "12", "R": "12", "U": "13"},
            "8": {"D": "13", "L": "8", "R": "8", "U": "4"},
            "13": {"D": "4", "L": "12", "R": "6", "U": "13"},
            "0": {"D": "9", "L": "14", "R": "0", "U": "10"},
            "10": {"D": "4", "L": "3", "R": "5", "U": "13"},
            "5": {"D": "2", "L": "14", "R": "0", "U": "1"},
            "7": {"D": "4", "L": "2", "R": "5", "U": "13"},
            "4": {"D": "4", "L": "6", "R": "12", "U": "13"},
            "14": {"D": "10", "L": "14", "R": "0", "U": "9"},
            "2": {"D": "2", "L": "2", "R": "2", "U": "2"},
            "11": {"D": "11", "L": "0", "R": "14", "U": "11"},
        },
        initial_state="15",
        final_states={"2"},
    )
    assert PinWords.make_dfa_for_basis(
        [Perm((3, 1, 2, 0)), Perm((2, 3, 0, 1))], use_db=False
    ) == DFA(
        states={
            "33",
            "4",
            "32",
            "62",
            "38",
            "2",
            "64",
            "1",
            "37",
            "26",
            "57",
            "47",
            "28",
            "5",
            "21",
            "16",
            "20",
            "46",
            "9",
            "35",
            "48",
            "42",
            "39",
            "27",
            "23",
            "19",
            "56",
            "63",
            "6",
            "31",
            "59",
            "53",
            "41",
            "11",
            "45",
            "50",
            "30",
            "8",
            "25",
            "10",
            "29",
            "54",
            "3",
            "12",
            "60",
            "36",
            "55",
            "44",
            "18",
            "7",
            "0",
            "51",
            "14",
            "15",
            "61",
            "24",
            "34",
            "58",
            "40",
            "43",
            "17",
            "52",
            "22",
            "49",
            "13",
        },
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "35": {"D": "35", "L": "19", "R": "28", "U": "56"},
            "41": {"D": "35", "L": "24", "R": "36", "U": "56"},
            "64": {"D": "54", "L": "53", "R": "64", "U": "5"},
            "27": {"D": "52", "L": "29", "R": "24", "U": "59"},
            "29": {"D": "48", "L": "29", "R": "10", "U": "28"},
            "45": {"D": "62", "L": "50", "R": "45", "U": "18"},
            "50": {"D": "8", "L": "50", "R": "45", "U": "38"},
            "7": {"D": "42", "L": "7", "R": "30", "U": "38"},
            "53": {"D": "5", "L": "53", "R": "64", "U": "54"},
            "37": {"D": "48", "L": "7", "R": "30", "U": "24"},
            "25": {"D": "25", "L": "55", "R": "2", "U": "11"},
            "14": {"D": "41", "L": "53", "R": "64", "U": "32"},
            "43": {"D": "52", "L": "1", "R": "10", "U": "59"},
            "61": {"D": "48", "L": "12", "R": "39", "U": "20"},
            "32": {"D": "52", "L": "1", "R": "24", "U": "59"},
            "26": {"D": "25", "L": "60", "R": "10", "U": "11"},
            "11": {"D": "25", "L": "51", "R": "15", "U": "11"},
            "60": {"D": "24", "L": "12", "R": "39", "U": "22"},
            "15": {"D": "62", "L": "50", "R": "45", "U": "9"},
            "18": {"D": "25", "L": "51", "R": "0", "U": "11"},
            "17": {"D": "26", "L": "50", "R": "45", "U": "9"},
            "24": {"D": "48", "L": "29", "R": "10", "U": "22"},
            "49": {"D": "49", "L": "64", "R": "53", "U": "49"},
            "28": {"D": "28", "L": "28", "R": "28", "U": "28"},
            "21": {"D": "49", "L": "34", "R": "34", "U": "49"},
            "56": {"D": "35", "L": "51", "R": "63", "U": "56"},
            "8": {"D": "25", "L": "44", "R": "2", "U": "11"},
            "13": {"D": "43", "L": "12", "R": "39", "U": "28"},
            "0": {"D": "48", "L": "50", "R": "45", "U": "27"},
            "63": {"D": "28", "L": "7", "R": "30", "U": "4"},
            "4": {"D": "35", "L": "29", "R": "36", "U": "56"},
            "19": {"D": "46", "L": "7", "R": "30", "U": "38"},
            "54": {"D": "33", "L": "6", "R": "23", "U": "31"},
            "22": {"D": "48", "L": "28", "R": "10", "U": "22"},
            "36": {"D": "28", "L": "7", "R": "30", "U": "24"},
            "3": {"D": "35", "L": "51", "R": "36", "U": "56"},
            "1": {"D": "24", "L": "12", "R": "39", "U": "28"},
            "46": {"D": "35", "L": "24", "R": "28", "U": "56"},
            "42": {"D": "35", "L": "47", "R": "28", "U": "56"},
            "34": {"D": "31", "L": "34", "R": "34", "U": "33"},
            "39": {"D": "62", "L": "12", "R": "39", "U": "16"},
            "6": {"D": "24", "L": "12", "R": "39", "U": "20"},
            "48": {"D": "48", "L": "29", "R": "28", "U": "22"},
            "44": {"D": "58", "L": "50", "R": "45", "U": "22"},
            "20": {"D": "52", "L": "28", "R": "24", "U": "59"},
            "47": {"D": "46", "L": "7", "R": "30", "U": "22"},
            "30": {"D": "28", "L": "7", "R": "30", "U": "3"},
            "10": {"D": "28", "L": "29", "R": "10", "U": "22"},
            "5": {"D": "25", "L": "44", "R": "0", "U": "11"},
            "33": {"D": "33", "L": "17", "R": "14", "U": "31"},
            "31": {"D": "33", "L": "14", "R": "17", "U": "31"},
            "57": {"D": "52", "L": "1", "R": "2", "U": "59"},
            "16": {"D": "52", "L": "28", "R": "61", "U": "59"},
            "38": {"D": "35", "L": "28", "R": "36", "U": "56"},
            "51": {"D": "46", "L": "7", "R": "30", "U": "28"},
            "59": {"D": "52", "L": "28", "R": "40", "U": "59"},
            "12": {"D": "57", "L": "12", "R": "39", "U": "28"},
            "52": {"D": "52", "L": "13", "R": "2", "U": "59"},
            "9": {"D": "25", "L": "29", "R": "37", "U": "11"},
            "23": {"D": "46", "L": "7", "R": "30", "U": "24"},
            "62": {"D": "52", "L": "1", "R": "28", "U": "59"},
            "40": {"D": "62", "L": "12", "R": "39", "U": "20"},
            "58": {"D": "35", "L": "24", "R": "10", "U": "56"},
            "55": {"D": "26", "L": "50", "R": "45", "U": "38"},
            "2": {"D": "28", "L": "12", "R": "39", "U": "20"},
        },
        initial_state="21",
        final_states={"28"},
    )
    assert PinWords.make_dfa_for_basis(
        [Perm((2, 1, 3, 0)), Perm((1, 3, 0, 2)), Perm((0, 2, 3, 1))], use_db=False
    ) == DFA(
        states={
            "33",
            "62",
            "88",
            "37",
            "86",
            "57",
            "28",
            "79",
            "21",
            "75",
            "16",
            "89",
            "23",
            "19",
            "56",
            "73",
            "25",
            "10",
            "54",
            "60",
            "68",
            "55",
            "61",
            "91",
            "43",
            "22",
            "4",
            "32",
            "93",
            "5",
            "67",
            "35",
            "90",
            "50",
            "80",
            "65",
            "3",
            "36",
            "51",
            "14",
            "15",
            "69",
            "34",
            "59",
            "13",
            "77",
            "64",
            "47",
            "20",
            "74",
            "48",
            "63",
            "6",
            "31",
            "41",
            "71",
            "76",
            "94",
            "29",
            "44",
            "18",
            "7",
            "24",
            "40",
            "70",
            "52",
            "49",
            "2",
            "38",
            "1",
            "26",
            "46",
            "9",
            "82",
            "42",
            "39",
            "27",
            "66",
            "92",
            "83",
            "53",
            "11",
            "45",
            "95",
            "30",
            "8",
            "72",
            "12",
            "85",
            "84",
            "81",
            "0",
            "78",
            "87",
            "58",
            "17",
        },
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "35": {"D": "2", "L": "32", "R": "47", "U": "9"},
            "41": {"D": "89", "L": "74", "R": "33", "U": "41"},
            "92": {"D": "8", "L": "91", "R": "0", "U": "21"},
            "64": {"D": "61", "L": "21", "R": "21", "U": "4"},
            "93": {"D": "84", "L": "72", "R": "30", "U": "1"},
            "27": {"D": "21", "L": "32", "R": "47", "U": "8"},
            "89": {"D": "89", "L": "49", "R": "36", "U": "41"},
            "29": {"D": "8", "L": "91", "R": "0", "U": "57"},
            "83": {"D": "54", "L": "83", "R": "83", "U": "17"},
            "87": {"D": "89", "L": "92", "R": "6", "U": "41"},
            "50": {"D": "84", "L": "72", "R": "13", "U": "1"},
            "7": {"D": "39", "L": "51", "R": "7", "U": "86"},
            "70": {"D": "8", "L": "19", "R": "19", "U": "60"},
            "53": {"D": "21", "L": "90", "R": "88", "U": "64"},
            "37": {"D": "40", "L": "92", "R": "34", "U": "24"},
            "25": {"D": "37", "L": "59", "R": "55", "U": "87"},
            "43": {"D": "22", "L": "95", "R": "6", "U": "20"},
            "61": {"D": "61", "L": "21", "R": "36", "U": "4"},
            "14": {"D": "93", "L": "68", "R": "14", "U": "86"},
            "32": {"D": "94", "L": "32", "R": "47", "U": "73"},
            "26": {"D": "28", "L": "5", "R": "26", "U": "43"},
            "11": {"D": "89", "L": "95", "R": "21", "U": "41"},
            "60": {"D": "8", "L": "19", "R": "0", "U": "60"},
            "15": {"D": "57", "L": "59", "R": "55", "U": "87"},
            "18": {"D": "21", "L": "32", "R": "47", "U": "21"},
            "55": {"D": "78", "L": "59", "R": "55", "U": "43"},
            "17": {"D": "17", "L": "25", "R": "75", "U": "54"},
            "24": {"D": "40", "L": "13", "R": "81", "U": "24"},
            "81": {"D": "21", "L": "32", "R": "47", "U": "9"},
            "49": {"D": "2", "L": "51", "R": "7", "U": "58"},
            "21": {"D": "21", "L": "21", "R": "21", "U": "21"},
            "75": {"D": "10", "L": "68", "R": "14", "U": "64"},
            "84": {"D": "84", "L": "48", "R": "56", "U": "1"},
            "28": {"D": "84", "L": "72", "R": "3", "U": "1"},
            "85": {"D": "44", "L": "51", "R": "7", "U": "8"},
            "56": {"D": "10", "L": "68", "R": "14", "U": "21"},
            "8": {"D": "8", "L": "21", "R": "21", "U": "60"},
            "13": {"D": "66", "L": "32", "R": "47", "U": "8"},
            "0": {"D": "21", "L": "91", "R": "0", "U": "57"},
            "80": {"D": "61", "L": "21", "R": "52", "U": "4"},
            "77": {"D": "61", "L": "53", "R": "62", "U": "4"},
            "69": {"D": "61", "L": "21", "R": "38", "U": "4"},
            "63": {"D": "63", "L": "26", "R": "5", "U": "63"},
            "4": {"D": "61", "L": "53", "R": "29", "U": "4"},
            "74": {"D": "65", "L": "51", "R": "7", "U": "64"},
            "71": {"D": "40", "L": "21", "R": "34", "U": "24"},
            "68": {"D": "23", "L": "68", "R": "14", "U": "50"},
            "19": {"D": "21", "L": "91", "R": "0", "U": "8"},
            "90": {"D": "21", "L": "90", "R": "88", "U": "77"},
            "54": {"D": "17", "L": "75", "R": "25", "U": "54"},
            "67": {"D": "8", "L": "34", "R": "21", "U": "60"},
            "22": {"D": "22", "L": "82", "R": "79", "U": "20"},
            "36": {"D": "69", "L": "90", "R": "88", "U": "21"},
            "3": {"D": "71", "L": "51", "R": "7", "U": "8"},
            "86": {"D": "40", "L": "95", "R": "18", "U": "24"},
            "1": {"D": "84", "L": "75", "R": "35", "U": "1"},
            "42": {"D": "89", "L": "16", "R": "85", "U": "41"},
            "76": {"D": "44", "L": "90", "R": "88", "U": "8"},
            "34": {"D": "21", "L": "91", "R": "0", "U": "21"},
            "46": {"D": "89", "L": "16", "R": "45", "U": "41"},
            "39": {"D": "61", "L": "53", "R": "52", "U": "4"},
            "6": {"D": "21", "L": "51", "R": "7", "U": "21"},
            "44": {"D": "8", "L": "21", "R": "34", "U": "60"},
            "48": {"D": "37", "L": "51", "R": "7", "U": "58"},
            "20": {"D": "22", "L": "74", "R": "15", "U": "20"},
            "47": {"D": "21", "L": "32", "R": "47", "U": "86"},
            "30": {"D": "71", "L": "51", "R": "7", "U": "21"},
            "10": {"D": "89", "L": "21", "R": "6", "U": "41"},
            "5": {"D": "43", "L": "5", "R": "26", "U": "28"},
            "94": {"D": "40", "L": "95", "R": "21", "U": "24"},
            "33": {"D": "67", "L": "32", "R": "47", "U": "9"},
            "31": {"D": "22", "L": "95", "R": "21", "U": "20"},
            "78": {"D": "61", "L": "53", "R": "76", "U": "4"},
            "57": {"D": "8", "L": "34", "R": "34", "U": "60"},
            "79": {"D": "69", "L": "90", "R": "88", "U": "64"},
            "95": {"D": "66", "L": "32", "R": "47", "U": "21"},
            "72": {"D": "44", "L": "90", "R": "88", "U": "64"},
            "38": {"D": "21", "L": "90", "R": "88", "U": "21"},
            "16": {"D": "8", "L": "90", "R": "88", "U": "64"},
            "91": {"D": "21", "L": "91", "R": "0", "U": "70"},
            "59": {"D": "31", "L": "59", "R": "55", "U": "42"},
            "51": {"D": "11", "L": "51", "R": "7", "U": "46"},
            "52": {"D": "44", "L": "90", "R": "88", "U": "21"},
            "9": {"D": "40", "L": "92", "R": "18", "U": "24"},
            "73": {"D": "40", "L": "62", "R": "27", "U": "24"},
            "12": {"D": "63", "L": "83", "R": "83", "U": "63"},
            "23": {"D": "89", "L": "95", "R": "6", "U": "41"},
            "40": {"D": "40", "L": "35", "R": "21", "U": "24"},
            "62": {"D": "8", "L": "91", "R": "0", "U": "8"},
            "88": {"D": "80", "L": "90", "R": "88", "U": "57"},
            "66": {"D": "40", "L": "21", "R": "21", "U": "24"},
            "65": {"D": "89", "L": "21", "R": "21", "U": "41"},
            "58": {"D": "89", "L": "92", "R": "18", "U": "41"},
            "45": {"D": "8", "L": "32", "R": "47", "U": "8"},
            "2": {"D": "40", "L": "92", "R": "21", "U": "24"},
            "82": {"D": "2", "L": "59", "R": "55", "U": "87"},
        },
        initial_state="12",
        final_states={"21"},
    )
    assert PinWords.make_dfa_for_basis(
        [Perm((2, 0, 1, 3)), Perm((0, 1)), Perm((2, 1, 0, 3)), Perm((3, 2, 0, 1))],
        use_db=False,
    ) == DFA(
        states={"2", "0", "7", "4", "8", "1", "6", "5", "3", "9"},
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "8": {"D": "6", "L": "5", "R": "8", "U": "7"},
            "9": {"D": "7", "L": "5", "R": "8", "U": "7"},
            "0": {"D": "0", "L": "7", "R": "9", "U": "2"},
            "5": {"D": "7", "L": "5", "R": "8", "U": "6"},
            "7": {"D": "7", "L": "7", "R": "7", "U": "7"},
            "3": {"D": "2", "L": "3", "R": "3", "U": "0"},
            "4": {"D": "4", "L": "8", "R": "5", "U": "4"},
            "1": {"D": "4", "L": "3", "R": "3", "U": "4"},
            "6": {"D": "0", "L": "7", "R": "7", "U": "2"},
            "2": {"D": "0", "L": "9", "R": "7", "U": "2"},
        },
        initial_state="1",
        final_states={"7"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((1, 2, 0, 3)),
            Perm((1, 3, 0, 2)),
            Perm((2, 3, 0, 1)),
            Perm((3, 2, 1, 0)),
            Perm((0, 3, 1, 2)),
        ],
        use_db=False,
    ) == DFA(
        states={
            "33",
            "62",
            "103",
            "88",
            "37",
            "86",
            "57",
            "28",
            "79",
            "75",
            "16",
            "21",
            "89",
            "23",
            "19",
            "56",
            "73",
            "25",
            "10",
            "106",
            "54",
            "60",
            "68",
            "55",
            "99",
            "61",
            "91",
            "43",
            "22",
            "4",
            "32",
            "93",
            "5",
            "67",
            "35",
            "90",
            "50",
            "80",
            "65",
            "3",
            "36",
            "100",
            "51",
            "98",
            "69",
            "14",
            "15",
            "34",
            "97",
            "59",
            "13",
            "77",
            "64",
            "47",
            "20",
            "74",
            "48",
            "102",
            "63",
            "6",
            "31",
            "41",
            "71",
            "76",
            "94",
            "29",
            "44",
            "105",
            "18",
            "7",
            "24",
            "40",
            "70",
            "52",
            "49",
            "2",
            "38",
            "1",
            "26",
            "46",
            "9",
            "82",
            "42",
            "39",
            "27",
            "66",
            "92",
            "83",
            "53",
            "11",
            "45",
            "96",
            "95",
            "101",
            "30",
            "8",
            "72",
            "12",
            "85",
            "107",
            "84",
            "81",
            "0",
            "78",
            "87",
            "104",
            "108",
            "58",
            "17",
        },
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "35": {"D": "3", "L": "26", "R": "17", "U": "35"},
            "92": {"D": "61", "L": "38", "R": "91", "U": "95"},
            "83": {"D": "80", "L": "83", "R": "49", "U": "24"},
            "29": {"D": "20", "L": "56", "R": "74", "U": "24"},
            "87": {"D": "47", "L": "24", "R": "4", "U": "68"},
            "50": {"D": "44", "L": "76", "R": "30", "U": "32"},
            "7": {"D": "7", "L": "24", "R": "24", "U": "14"},
            "70": {"D": "3", "L": "55", "R": "57", "U": "35"},
            "25": {"D": "24", "L": "38", "R": "79", "U": "6"},
            "32": {"D": "66", "L": "27", "R": "24", "U": "98"},
            "61": {"D": "61", "L": "24", "R": "53", "U": "95"},
            "26": {"D": "61", "L": "77", "R": "2", "U": "24"},
            "43": {"D": "94", "L": "24", "R": "53", "U": "42"},
            "14": {"D": "7", "L": "24", "R": "99", "U": "14"},
            "11": {"D": "6", "L": "85", "R": "85", "U": "24"},
            "60": {"D": "60", "L": "16", "R": "50", "U": "88"},
            "101": {"D": "65", "L": "56", "R": "74", "U": "24"},
            "24": {"D": "24", "L": "24", "R": "24", "U": "24"},
            "84": {"D": "94", "L": "55", "R": "4", "U": "42"},
            "56": {"D": "12", "L": "56", "R": "74", "U": "6"},
            "4": {"D": "24", "L": "90", "R": "58", "U": "48"},
            "19": {"D": "24", "L": "77", "R": "2", "U": "89"},
            "99": {"D": "24", "L": "38", "R": "79", "U": "7"},
            "100": {"D": "71", "L": "100", "R": "15", "U": "69"},
            "36": {"D": "5", "L": "11", "R": "24", "U": "48"},
            "3": {"D": "3", "L": "54", "R": "108", "U": "35"},
            "34": {"D": "22", "L": "33", "R": "33", "U": "22"},
            "48": {"D": "5", "L": "24", "R": "24", "U": "48"},
            "6": {"D": "6", "L": "24", "R": "24", "U": "6"},
            "47": {"D": "47", "L": "41", "R": "24", "U": "68"},
            "102": {"D": "24", "L": "102", "R": "28", "U": "6"},
            "5": {"D": "5", "L": "86", "R": "24", "U": "48"},
            "33": {"D": "88", "L": "33", "R": "33", "U": "60"},
            "105": {"D": "94", "L": "103", "R": "57", "U": "42"},
            "31": {"D": "66", "L": "29", "R": "24", "U": "98"},
            "16": {"D": "18", "L": "62", "R": "10", "U": "51"},
            "12": {"D": "66", "L": "29", "R": "49", "U": "98"},
            "59": {"D": "47", "L": "24", "R": "24", "U": "68"},
            "52": {"D": "52", "L": "82", "R": "37", "U": "104"},
            "9": {"D": "61", "L": "24", "R": "91", "U": "95"},
            "96": {"D": "3", "L": "55", "R": "108", "U": "35"},
            "62": {"D": "96", "L": "62", "R": "10", "U": "9"},
            "65": {"D": "66", "L": "24", "R": "85", "U": "98"},
            "66": {"D": "66", "L": "101", "R": "49", "U": "98"},
            "58": {"D": "24", "L": "90", "R": "58", "U": "87"},
            "45": {"D": "52", "L": "63", "R": "8", "U": "104"},
            "55": {"D": "61", "L": "100", "R": "15", "U": "24"},
            "2": {"D": "6", "L": "77", "R": "2", "U": "92"},
            "97": {"D": "24", "L": "90", "R": "58", "U": "59"},
            "41": {"D": "59", "L": "90", "R": "58", "U": "24"},
            "107": {"D": "24", "L": "100", "R": "15", "U": "46"},
            "108": {"D": "24", "L": "56", "R": "74", "U": "98"},
            "93": {"D": "24", "L": "83", "R": "49", "U": "48"},
            "27": {"D": "6", "L": "83", "R": "49", "U": "24"},
            "64": {"D": "3", "L": "26", "R": "57", "U": "35"},
            "89": {"D": "61", "L": "85", "R": "24", "U": "95"},
            "106": {"D": "45", "L": "23", "R": "106", "U": "70"},
            "53": {"D": "24", "L": "85", "R": "85", "U": "6"},
            "37": {"D": "7", "L": "90", "R": "58", "U": "48"},
            "15": {"D": "80", "L": "100", "R": "15", "U": "105"},
            "18": {"D": "94", "L": "24", "R": "0", "U": "42"},
            "17": {"D": "24", "L": "62", "R": "10", "U": "51"},
            "49": {"D": "24", "L": "83", "R": "49", "U": "24"},
            "81": {"D": "47", "L": "27", "R": "25", "U": "68"},
            "104": {"D": "52", "L": "37", "R": "39", "U": "104"},
            "75": {"D": "20", "L": "102", "R": "28", "U": "24"},
            "21": {"D": "47", "L": "67", "R": "24", "U": "68"},
            "28": {"D": "6", "L": "102", "R": "28", "U": "24"},
            "85": {"D": "24", "L": "85", "R": "85", "U": "24"},
            "8": {"D": "1", "L": "77", "R": "2", "U": "78"},
            "13": {"D": "47", "L": "11", "R": "24", "U": "68"},
            "77": {"D": "24", "L": "77", "R": "2", "U": "69"},
            "0": {"D": "24", "L": "102", "R": "28", "U": "78"},
            "80": {"D": "5", "L": "27", "R": "24", "U": "48"},
            "63": {"D": "20", "L": "56", "R": "74", "U": "36"},
            "69": {"D": "7", "L": "24", "R": "25", "U": "14"},
            "74": {"D": "80", "L": "56", "R": "74", "U": "24"},
            "71": {"D": "94", "L": "55", "R": "93", "U": "42"},
            "68": {"D": "47", "L": "24", "R": "97", "U": "68"},
            "90": {"D": "21", "L": "90", "R": "58", "U": "24"},
            "54": {"D": "18", "L": "62", "R": "10", "U": "24"},
            "67": {"D": "7", "L": "90", "R": "58", "U": "24"},
            "22": {"D": "22", "L": "106", "R": "23", "U": "22"},
            "86": {"D": "48", "L": "83", "R": "49", "U": "24"},
            "42": {"D": "94", "L": "103", "R": "107", "U": "42"},
            "76": {"D": "84", "L": "76", "R": "30", "U": "81"},
            "46": {"D": "94", "L": "11", "R": "24", "U": "42"},
            "1": {"D": "7", "L": "24", "R": "53", "U": "14"},
            "44": {"D": "61", "L": "24", "R": "25", "U": "95"},
            "39": {"D": "72", "L": "100", "R": "15", "U": "46"},
            "103": {"D": "7", "L": "38", "R": "79", "U": "24"},
            "20": {"D": "20", "L": "24", "R": "85", "U": "78"},
            "30": {"D": "81", "L": "76", "R": "30", "U": "40"},
            "10": {"D": "31", "L": "62", "R": "10", "U": "64"},
            "94": {"D": "94", "L": "73", "R": "93", "U": "42"},
            "78": {"D": "20", "L": "85", "R": "24", "U": "78"},
            "79": {"D": "24", "L": "38", "R": "79", "U": "69"},
            "57": {"D": "24", "L": "100", "R": "15", "U": "98"},
            "95": {"D": "61", "L": "38", "R": "19", "U": "95"},
            "72": {"D": "47", "L": "24", "R": "53", "U": "68"},
            "38": {"D": "24", "L": "38", "R": "79", "U": "24"},
            "91": {"D": "24", "L": "77", "R": "2", "U": "78"},
            "51": {"D": "94", "L": "75", "R": "24", "U": "42"},
            "73": {"D": "43", "L": "100", "R": "15", "U": "24"},
            "23": {"D": "70", "L": "23", "R": "106", "U": "45"},
            "40": {"D": "94", "L": "67", "R": "57", "U": "42"},
            "98": {"D": "66", "L": "11", "R": "24", "U": "98"},
            "88": {"D": "60", "L": "50", "R": "16", "U": "88"},
            "82": {"D": "43", "L": "100", "R": "15", "U": "13"},
        },
        initial_state="34",
        final_states={"24"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((2, 0, 3, 1)),
            Perm((0, 2, 1)),
            Perm((1, 2, 3, 0)),
            Perm((3, 2, 0, 1)),
            Perm((2, 0, 1, 3)),
            Perm((0, 2, 3, 1)),
        ],
        use_db=False,
    ) == DFA(
        states={
            "33",
            "4",
            "32",
            "2",
            "38",
            "1",
            "37",
            "26",
            "57",
            "47",
            "28",
            "5",
            "21",
            "16",
            "20",
            "46",
            "9",
            "35",
            "48",
            "42",
            "39",
            "27",
            "23",
            "19",
            "56",
            "59",
            "6",
            "31",
            "53",
            "41",
            "11",
            "45",
            "50",
            "30",
            "8",
            "25",
            "10",
            "29",
            "54",
            "3",
            "12",
            "60",
            "36",
            "55",
            "44",
            "18",
            "7",
            "0",
            "51",
            "14",
            "15",
            "24",
            "34",
            "58",
            "40",
            "43",
            "17",
            "52",
            "22",
            "49",
            "13",
        },
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "35": {"D": "29", "L": "35", "R": "37", "U": "28"},
            "41": {"D": "45", "L": "16", "R": "48", "U": "44"},
            "27": {"D": "10", "L": "42", "R": "27", "U": "26"},
            "29": {"D": "3", "L": "17", "R": "10", "U": "9"},
            "50": {"D": "50", "L": "37", "R": "35", "U": "50"},
            "7": {"D": "0", "L": "16", "R": "49", "U": "44"},
            "53": {"D": "30", "L": "11", "R": "10", "U": "40"},
            "37": {"D": "28", "L": "35", "R": "37", "U": "29"},
            "25": {"D": "25", "L": "31", "R": "21", "U": "15"},
            "14": {"D": "10", "L": "14", "R": "14", "U": "10"},
            "43": {"D": "10", "L": "58", "R": "43", "U": "54"},
            "32": {"D": "10", "L": "58", "R": "43", "U": "10"},
            "26": {"D": "26", "L": "10", "R": "10", "U": "5"},
            "11": {"D": "10", "L": "42", "R": "27", "U": "10"},
            "60": {"D": "22", "L": "58", "R": "43", "U": "10"},
            "15": {"D": "25", "L": "21", "R": "31", "U": "15"},
            "18": {"D": "55", "L": "39", "R": "20", "U": "18"},
            "55": {"D": "55", "L": "10", "R": "39", "U": "18"},
            "17": {"D": "10", "L": "23", "R": "6", "U": "10"},
            "49": {"D": "44", "L": "16", "R": "49", "U": "10"},
            "24": {"D": "30", "L": "10", "R": "10", "U": "40"},
            "21": {"D": "44", "L": "38", "R": "34", "U": "57"},
            "28": {"D": "55", "L": "17", "R": "49", "U": "18"},
            "56": {"D": "59", "L": "56", "R": "46", "U": "41"},
            "8": {"D": "50", "L": "13", "R": "13", "U": "50"},
            "13": {"D": "15", "L": "13", "R": "13", "U": "25"},
            "0": {"D": "0", "L": "10", "R": "10", "U": "0"},
            "4": {"D": "10", "L": "14", "R": "14", "U": "0"},
            "19": {"D": "10", "L": "16", "R": "49", "U": "44"},
            "54": {"D": "47", "L": "10", "R": "10", "U": "51"},
            "22": {"D": "26", "L": "11", "R": "10", "U": "5"},
            "36": {"D": "26", "L": "42", "R": "27", "U": "10"},
            "3": {"D": "3", "L": "60", "R": "33", "U": "9"},
            "1": {"D": "30", "L": "10", "R": "49", "U": "40"},
            "42": {"D": "10", "L": "42", "R": "27", "U": "12"},
            "46": {"D": "1", "L": "56", "R": "46", "U": "54"},
            "34": {"D": "2", "L": "38", "R": "34", "U": "57"},
            "6": {"D": "24", "L": "23", "R": "6", "U": "26"},
            "48": {"D": "0", "L": "14", "R": "14", "U": "10"},
            "44": {"D": "45", "L": "10", "R": "10", "U": "44"},
            "39": {"D": "10", "L": "38", "R": "34", "U": "57"},
            "20": {"D": "24", "L": "23", "R": "6", "U": "10"},
            "47": {"D": "47", "L": "60", "R": "10", "U": "51"},
            "30": {"D": "30", "L": "10", "R": "17", "U": "40"},
            "10": {"D": "10", "L": "10", "R": "10", "U": "10"},
            "5": {"D": "26", "L": "4", "R": "11", "U": "5"},
            "33": {"D": "44", "L": "23", "R": "6", "U": "10"},
            "31": {"D": "53", "L": "56", "R": "46", "U": "10"},
            "57": {"D": "30", "L": "17", "R": "10", "U": "40"},
            "16": {"D": "10", "L": "16", "R": "49", "U": "10"},
            "38": {"D": "10", "L": "38", "R": "34", "U": "28"},
            "51": {"D": "47", "L": "12", "R": "32", "U": "51"},
            "59": {"D": "47", "L": "11", "R": "10", "U": "51"},
            "12": {"D": "0", "L": "14", "R": "14", "U": "0"},
            "52": {"D": "26", "L": "58", "R": "43", "U": "10"},
            "9": {"D": "3", "L": "7", "R": "52", "U": "9"},
            "23": {"D": "10", "L": "23", "R": "6", "U": "41"},
            "40": {"D": "30", "L": "19", "R": "36", "U": "40"},
            "58": {"D": "59", "L": "58", "R": "43", "U": "12"},
            "45": {"D": "45", "L": "10", "R": "16", "U": "44"},
            "2": {"D": "55", "L": "10", "R": "10", "U": "18"},
        },
        initial_state="8",
        final_states={"10"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((1, 0, 2, 3)),
            Perm((0, 3, 2, 1)),
            Perm((2, 0, 1, 3)),
            Perm((1, 2, 0)),
            Perm(()),
            Perm((1, 3, 0, 2)),
            Perm((3, 1, 0, 2)),
        ],
        use_db=False,
    ) == DFA(
        states={"0"},
        input_symbols={"D", "L", "R", "U"},
        transitions={"0": {"D": "0", "L": "0", "R": "0", "U": "0"}},
        initial_state="0",
        final_states={"0"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((0, 1, 2)),
            Perm((3, 1, 2, 0)),
            Perm((1, 3, 2, 0)),
            Perm((3, 0, 1, 2)),
            Perm((2, 3, 1, 0)),
            Perm((3, 2, 0, 1)),
            Perm((2, 0, 1, 3)),
            Perm((1, 2, 0)),
        ],
        use_db=False,
    ) == DFA(
        states={
            "2",
            "4",
            "1",
            "5",
            "21",
            "16",
            "20",
            "9",
            "23",
            "19",
            "6",
            "11",
            "8",
            "25",
            "10",
            "3",
            "12",
            "18",
            "7",
            "0",
            "14",
            "15",
            "24",
            "17",
            "22",
            "13",
        },
        input_symbols={"D", "L", "R", "U"},
        transitions={
            "22": {"D": "19", "L": "23", "R": "3", "U": "22"},
            "3": {"D": "3", "L": "3", "R": "3", "U": "3"},
            "1": {"D": "1", "L": "3", "R": "3", "U": "1"},
            "6": {"D": "1", "L": "23", "R": "23", "U": "3"},
            "20": {"D": "3", "L": "20", "R": "7", "U": "1"},
            "10": {"D": "14", "L": "10", "R": "8", "U": "5"},
            "5": {"D": "4", "L": "3", "R": "6", "U": "2"},
            "7": {"D": "3", "L": "20", "R": "7", "U": "3"},
            "25": {"D": "11", "L": "21", "R": "18", "U": "25"},
            "14": {"D": "19", "L": "7", "R": "7", "U": "22"},
            "11": {"D": "11", "L": "18", "R": "21", "U": "25"},
            "15": {"D": "14", "L": "15", "R": "24", "U": "5"},
            "18": {"D": "19", "L": "20", "R": "7", "U": "19"},
            "17": {"D": "25", "L": "17", "R": "17", "U": "11"},
            "24": {"D": "13", "L": "15", "R": "24", "U": "14"},
            "16": {"D": "16", "L": "8", "R": "10", "U": "16"},
            "12": {"D": "1", "L": "3", "R": "23", "U": "1"},
            "21": {"D": "12", "L": "15", "R": "24", "U": "3"},
            "9": {"D": "3", "L": "15", "R": "24", "U": "3"},
            "8": {"D": "5", "L": "10", "R": "8", "U": "14"},
            "23": {"D": "3", "L": "23", "R": "23", "U": "3"},
            "13": {"D": "4", "L": "3", "R": "3", "U": "2"},
            "0": {"D": "16", "L": "17", "R": "17", "U": "16"},
            "4": {"D": "4", "L": "18", "R": "9", "U": "2"},
            "19": {"D": "19", "L": "3", "R": "3", "U": "22"},
            "2": {"D": "4", "L": "21", "R": "18", "U": "2"},
        },
        initial_state="0",
        final_states={"3"},
    )
    assert PinWords.make_dfa_for_basis([Perm((0, 2, 1))], use_db=True) == DFA(
        states={
            "6",
            "17",
            "18",
            "14",
            "13",
            "21",
            "9",
            "0",
            "2",
            "12",
            "16",
            "8",
            "20",
            "19",
            "1",
            "15",
            "10",
            "11",
            "3",
            "4",
            "5",
            "7",
        },
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "15": {"D": "17", "R": "15", "U": "13", "L": "7"},
            "0": {"D": "3", "R": "12", "U": "14", "L": "10"},
            "17": {"D": "3", "R": "12", "U": "14", "L": "19"},
            "3": {"D": "3", "R": "2", "U": "14", "L": "19"},
            "12": {"D": "21", "R": "15", "U": "19", "L": "7"},
            "19": {"D": "19", "R": "19", "U": "19", "L": "19"},
            "6": {"D": "5", "R": "4", "U": "0", "L": "6"},
            "18": {"D": "13", "R": "4", "U": "19", "L": "6"},
            "13": {"D": "3", "R": "19", "U": "14", "L": "10"},
            "8": {"D": "19", "R": "15", "U": "13", "L": "7"},
            "2": {"D": "21", "R": "15", "U": "13", "L": "7"},
            "7": {"D": "19", "R": "15", "U": "0", "L": "7"},
            "20": {"D": "9", "R": "20", "U": "11", "L": "20"},
            "14": {"D": "3", "R": "12", "U": "14", "L": "8"},
            "11": {"D": "11", "R": "2", "U": "9", "L": "18"},
            "4": {"D": "0", "R": "4", "U": "5", "L": "6"},
            "9": {"D": "11", "R": "18", "U": "9", "L": "2"},
            "16": {"D": "1", "R": "20", "U": "1", "L": "20"},
            "21": {"D": "3", "R": "19", "U": "14", "L": "19"},
            "5": {"D": "11", "R": "19", "U": "9", "L": "12"},
            "10": {"D": "19", "R": "15", "U": "19", "L": "7"},
            "1": {"D": "1", "R": "6", "U": "1", "L": "4"},
        },
        initial_state="16",
        final_states={"19"},
    )
    assert PinWords.make_dfa_for_basis(
        [Perm((3, 1, 0, 2)), Perm((2, 0, 3, 1))], use_db=True
    ) == DFA(
        states={
            "6",
            "24",
            "43",
            "35",
            "41",
            "18",
            "28",
            "13",
            "21",
            "2",
            "33",
            "0",
            "40",
            "9",
            "12",
            "31",
            "34",
            "1",
            "10",
            "36",
            "39",
            "37",
            "3",
            "11",
            "4",
            "5",
            "44",
            "7",
            "42",
            "17",
            "32",
            "23",
            "45",
            "14",
            "27",
            "16",
            "8",
            "20",
            "19",
            "30",
            "26",
            "25",
            "15",
            "22",
            "38",
            "29",
        },
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "26": {"U": "39", "R": "8", "D": "21", "L": "42"},
            "38": {"U": "43", "R": "38", "D": "36", "L": "40"},
            "18": {"U": "5", "R": "2", "D": "6", "L": "11"},
            "2": {"U": "30", "R": "8", "D": "30", "L": "42"},
            "6": {"U": "5", "R": "34", "D": "6", "L": "14"},
            "27": {"U": "39", "R": "38", "D": "21", "L": "40"},
            "33": {"U": "33", "R": "26", "D": "15", "L": "30"},
            "45": {"U": "39", "R": "8", "D": "35", "L": "42"},
            "43": {"U": "33", "R": "26", "D": "15", "L": "17"},
            "31": {"U": "5", "R": "30", "D": "6", "L": "13"},
            "28": {"U": "3", "R": "8", "D": "21", "L": "42"},
            "16": {"U": "41", "R": "16", "D": "36", "L": "7"},
            "34": {"U": "35", "R": "38", "D": "32", "L": "40"},
            "1": {"U": "5", "R": "30", "D": "6", "L": "30"},
            "22": {"U": "19", "R": "29", "D": "22", "L": "4"},
            "15": {"U": "33", "R": "45", "D": "15", "L": "17"},
            "10": {"U": "5", "R": "30", "D": "6", "L": "11"},
            "37": {"U": "5", "R": "25", "D": "6", "L": "30"},
            "20": {"U": "22", "R": "20", "D": "19", "L": "20"},
            "14": {"U": "1", "R": "38", "D": "21", "L": "40"},
            "36": {"U": "5", "R": "25", "D": "6", "L": "13"},
            "35": {"U": "33", "R": "2", "D": "15", "L": "2"},
            "32": {"U": "5", "R": "25", "D": "6", "L": "11"},
            "40": {"U": "31", "R": "38", "D": "0", "L": "40"},
            "3": {"U": "33", "R": "30", "D": "15", "L": "30"},
            "13": {"U": "1", "R": "38", "D": "30", "L": "40"},
            "4": {"U": "37", "R": "16", "D": "21", "L": "7"},
            "17": {"U": "30", "R": "8", "D": "21", "L": "42"},
            "42": {"U": "30", "R": "8", "D": "43", "L": "42"},
            "19": {"U": "19", "R": "4", "D": "22", "L": "29"},
            "24": {"U": "5", "R": "2", "D": "6", "L": "30"},
            "0": {"U": "5", "R": "27", "D": "6", "L": "28"},
            "12": {"U": "12", "R": "7", "D": "12", "L": "16"},
            "21": {"U": "33", "R": "30", "D": "15", "L": "2"},
            "25": {"U": "30", "R": "38", "D": "30", "L": "40"},
            "39": {"U": "33", "R": "2", "D": "15", "L": "30"},
            "11": {"U": "3", "R": "8", "D": "30", "L": "42"},
            "41": {"U": "19", "R": "9", "D": "22", "L": "26"},
            "23": {"U": "10", "R": "38", "D": "32", "L": "40"},
            "7": {"U": "36", "R": "16", "D": "41", "L": "7"},
            "5": {"U": "5", "R": "26", "D": "6", "L": "23"},
            "30": {"U": "30", "R": "30", "D": "30", "L": "30"},
            "44": {"U": "12", "R": "20", "D": "12", "L": "20"},
            "29": {"U": "18", "R": "38", "D": "32", "L": "40"},
            "8": {"U": "33", "R": "8", "D": "35", "L": "42"},
            "9": {"U": "24", "R": "38", "D": "21", "L": "40"},
        },
        initial_state="44",
        final_states={"30"},
    )
    assert PinWords.make_dfa_for_basis(
        [Perm((2, 0, 1)), Perm((2, 3, 1, 0)), Perm((1, 3, 0, 2))], use_db=True
    ) == DFA(
        states={
            "6",
            "24",
            "35",
            "18",
            "28",
            "13",
            "21",
            "2",
            "9",
            "33",
            "0",
            "12",
            "31",
            "34",
            "1",
            "10",
            "36",
            "37",
            "3",
            "11",
            "4",
            "5",
            "7",
            "17",
            "32",
            "23",
            "14",
            "27",
            "16",
            "8",
            "20",
            "19",
            "30",
            "26",
            "25",
            "15",
            "22",
            "29",
        },
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "26": {"U": "11", "R": "22", "D": "11", "L": "29"},
            "18": {"U": "9", "R": "11", "D": "31", "L": "11"},
            "6": {"U": "9", "R": "6", "D": "11", "L": "23"},
            "2": {"U": "18", "R": "6", "D": "11", "L": "23"},
            "9": {"U": "9", "R": "2", "D": "31", "L": "11"},
            "27": {"U": "14", "R": "15", "D": "14", "L": "15"},
            "33": {"U": "1", "R": "3", "D": "11", "L": "37"},
            "31": {"U": "9", "R": "11", "D": "31", "L": "23"},
            "28": {"U": "28", "R": "35", "D": "24", "L": "11"},
            "20": {"U": "11", "R": "3", "D": "11", "L": "37"},
            "16": {"U": "28", "R": "11", "D": "24", "L": "11"},
            "1": {"U": "9", "R": "11", "D": "31", "L": "17"},
            "22": {"U": "21", "R": "22", "D": "1", "L": "29"},
            "15": {"U": "36", "R": "15", "D": "5", "L": "15"},
            "10": {"U": "10", "R": "30", "D": "0", "L": "20"},
            "34": {"U": "28", "R": "13", "D": "24", "L": "26"},
            "37": {"U": "4", "R": "3", "D": "34", "L": "37"},
            "14": {"U": "14", "R": "12", "D": "14", "L": "19"},
            "36": {"U": "5", "R": "33", "D": "36", "L": "30"},
            "32": {"U": "28", "R": "11", "D": "24", "L": "17"},
            "35": {"U": "16", "R": "22", "D": "1", "L": "29"},
            "13": {"U": "18", "R": "22", "D": "11", "L": "29"},
            "4": {"U": "10", "R": "11", "D": "0", "L": "11"},
            "3": {"U": "34", "R": "3", "D": "25", "L": "37"},
            "17": {"U": "11", "R": "6", "D": "11", "L": "23"},
            "19": {"U": "34", "R": "19", "D": "25", "L": "12"},
            "24": {"U": "28", "R": "2", "D": "24", "L": "8"},
            "0": {"U": "10", "R": "33", "D": "0", "L": "30"},
            "12": {"U": "25", "R": "19", "D": "34", "L": "12"},
            "21": {"U": "28", "R": "13", "D": "24", "L": "11"},
            "25": {"U": "10", "R": "11", "D": "0", "L": "2"},
            "11": {"U": "11", "R": "11", "D": "11", "L": "11"},
            "23": {"U": "11", "R": "6", "D": "1", "L": "23"},
            "7": {"U": "28", "R": "2", "D": "24", "L": "26"},
            "5": {"U": "5", "R": "30", "D": "36", "L": "33"},
            "30": {"U": "16", "R": "22", "D": "32", "L": "29"},
            "29": {"U": "11", "R": "22", "D": "7", "L": "29"},
            "8": {"U": "11", "R": "22", "D": "32", "L": "29"},
        },
        initial_state="27",
        final_states={"11"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((2, 1, 0, 3)),
            Perm((3, 1, 2, 0)),
            Perm((0, 3, 2, 1)),
            Perm((2, 0, 3, 1)),
        ],
        use_db=True,
    ) == DFA(
        states={
            "24",
            "51",
            "35",
            "41",
            "18",
            "104",
            "72",
            "21",
            "55",
            "48",
            "9",
            "40",
            "66",
            "105",
            "103",
            "42",
            "123",
            "17",
            "59",
            "75",
            "100",
            "74",
            "20",
            "61",
            "26",
            "109",
            "87",
            "56",
            "29",
            "111",
            "6",
            "90",
            "60",
            "122",
            "13",
            "81",
            "119",
            "34",
            "101",
            "88",
            "10",
            "36",
            "4",
            "97",
            "7",
            "99",
            "49",
            "32",
            "67",
            "14",
            "27",
            "112",
            "30",
            "58",
            "47",
            "25",
            "69",
            "120",
            "15",
            "38",
            "117",
            "84",
            "116",
            "77",
            "28",
            "125",
            "33",
            "82",
            "50",
            "89",
            "102",
            "39",
            "44",
            "107",
            "71",
            "76",
            "5",
            "11",
            "37",
            "110",
            "92",
            "91",
            "83",
            "121",
            "85",
            "52",
            "126",
            "19",
            "113",
            "64",
            "73",
            "54",
            "65",
            "43",
            "124",
            "118",
            "106",
            "2",
            "0",
            "70",
            "12",
            "96",
            "79",
            "31",
            "1",
            "46",
            "86",
            "98",
            "62",
            "3",
            "95",
            "94",
            "108",
            "115",
            "78",
            "23",
            "45",
            "63",
            "80",
            "16",
            "8",
            "53",
            "22",
            "68",
            "93",
            "57",
            "114",
        },
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "86": {"U": "86", "R": "80", "D": "43", "L": "87"},
            "6": {"U": "1", "R": "24", "D": "74", "L": "114"},
            "54": {"U": "64", "R": "34", "D": "7", "L": "73"},
            "115": {"U": "121", "R": "64", "D": "111", "L": "52"},
            "118": {"U": "118", "R": "124", "D": "118", "L": "28"},
            "89": {"U": "64", "R": "34", "D": "64", "L": "73"},
            "28": {"U": "103", "R": "28", "D": "5", "L": "124"},
            "16": {"U": "17", "R": "116", "D": "62", "L": "117"},
            "10": {"U": "120", "R": "64", "D": "68", "L": "69"},
            "90": {"U": "64", "R": "41", "D": "64", "L": "90"},
            "36": {"U": "120", "R": "54", "D": "68", "L": "98"},
            "40": {"U": "14", "R": "24", "D": "74", "L": "114"},
            "3": {"U": "44", "R": "64", "D": "3", "L": "85"},
            "4": {"U": "113", "R": "64", "D": "60", "L": "90"},
            "42": {"U": "1", "R": "99", "D": "64", "L": "92"},
            "61": {"U": "44", "R": "89", "D": "3", "L": "52"},
            "78": {"U": "64", "R": "52", "D": "30", "L": "52"},
            "57": {"U": "30", "R": "52", "D": "30", "L": "64"},
            "119": {"U": "82", "R": "105", "D": "93", "L": "119"},
            "23": {"U": "86", "R": "112", "D": "43", "L": "100"},
            "71": {"U": "4", "R": "70", "D": "64", "L": "67"},
            "63": {"U": "64", "R": "116", "D": "72", "L": "117"},
            "109": {"U": "64", "R": "105", "D": "102", "L": "119"},
            "95": {"U": "96", "R": "53", "D": "122", "L": "64"},
            "8": {"U": "57", "R": "116", "D": "64", "L": "117"},
            "87": {"U": "61", "R": "99", "D": "97", "L": "92"},
            "102": {"U": "96", "R": "64", "D": "122", "L": "98"},
            "26": {"U": "113", "R": "78", "D": "60", "L": "90"},
            "84": {"U": "108", "R": "84", "D": "35", "L": "101"},
            "18": {"U": "15", "R": "27", "D": "18", "L": "40"},
            "108": {"U": "96", "R": "39", "D": "122", "L": "64"},
            "2": {"U": "113", "R": "70", "D": "106", "L": "67"},
            "101": {"U": "29", "R": "84", "D": "93", "L": "101"},
            "126": {"U": "113", "R": "41", "D": "57", "L": "90"},
            "66": {"U": "64", "R": "99", "D": "7", "L": "92"},
            "47": {"U": "0", "R": "99", "D": "97", "L": "92"},
            "111": {"U": "121", "R": "64", "D": "111", "L": "64"},
            "43": {"U": "86", "R": "16", "D": "43", "L": "6"},
            "52": {"U": "64", "R": "52", "D": "64", "L": "52"},
            "20": {"U": "64", "R": "70", "D": "106", "L": "67"},
            "85": {"U": "64", "R": "34", "D": "11", "L": "73"},
            "93": {"U": "96", "R": "64", "D": "122", "L": "104"},
            "22": {"U": "57", "R": "34", "D": "64", "L": "73"},
            "103": {"U": "86", "R": "58", "D": "43", "L": "100"},
            "94": {"U": "49", "R": "88", "D": "9", "L": "89"},
            "14": {"U": "96", "R": "66", "D": "122", "L": "64"},
            "113": {"U": "113", "R": "64", "D": "60", "L": "64"},
            "91": {"U": "120", "R": "89", "D": "68", "L": "90"},
            "99": {"U": "83", "R": "99", "D": "64", "L": "92"},
            "76": {"U": "125", "R": "20", "D": "76", "L": "64"},
            "122": {"U": "96", "R": "126", "D": "122", "L": "109"},
            "21": {"U": "25", "R": "116", "D": "64", "L": "117"},
            "117": {"U": "64", "R": "116", "D": "10", "L": "117"},
            "55": {"U": "4", "R": "70", "D": "111", "L": "67"},
            "62": {"U": "44", "R": "52", "D": "3", "L": "89"},
            "106": {"U": "121", "R": "88", "D": "111", "L": "64"},
            "5": {"U": "107", "R": "38", "D": "75", "L": "21"},
            "92": {"U": "82", "R": "99", "D": "9", "L": "92"},
            "44": {"U": "44", "R": "13", "D": "3", "L": "64"},
            "112": {"U": "17", "R": "116", "D": "11", "L": "117"},
            "100": {"U": "0", "R": "105", "D": "97", "L": "119"},
            "80": {"U": "14", "R": "24", "D": "72", "L": "114"},
            "96": {"U": "96", "R": "45", "D": "122", "L": "19"},
            "9": {"U": "49", "R": "64", "D": "9", "L": "51"},
            "38": {"U": "64", "R": "99", "D": "115", "L": "92"},
            "27": {"U": "91", "R": "84", "D": "94", "L": "101"},
            "72": {"U": "120", "R": "64", "D": "68", "L": "98"},
            "33": {"U": "49", "R": "53", "D": "9", "L": "22"},
            "51": {"U": "64", "R": "99", "D": "97", "L": "92"},
            "67": {"U": "81", "R": "70", "D": "64", "L": "67"},
            "69": {"U": "64", "R": "116", "D": "11", "L": "117"},
            "70": {"U": "64", "R": "70", "D": "12", "L": "67"},
            "107": {"U": "107", "R": "45", "D": "75", "L": "55"},
            "1": {"U": "49", "R": "53", "D": "9", "L": "64"},
            "124": {"U": "5", "R": "28", "D": "103", "L": "124"},
            "32": {"U": "113", "R": "41", "D": "64", "L": "90"},
            "82": {"U": "121", "R": "88", "D": "111", "L": "123"},
            "88": {"U": "64", "R": "88", "D": "64", "L": "79"},
            "53": {"U": "64", "R": "99", "D": "64", "L": "92"},
            "64": {"U": "64", "R": "64", "D": "64", "L": "64"},
            "48": {"U": "121", "R": "64", "D": "111", "L": "123"},
            "105": {"U": "108", "R": "105", "D": "26", "L": "119"},
            "0": {"U": "44", "R": "89", "D": "3", "L": "64"},
            "98": {"U": "64", "R": "116", "D": "64", "L": "117"},
            "104": {"U": "64", "R": "105", "D": "97", "L": "119"},
            "25": {"U": "113", "R": "52", "D": "60", "L": "64"},
            "39": {"U": "17", "R": "105", "D": "64", "L": "119"},
            "41": {"U": "64", "R": "41", "D": "46", "L": "90"},
            "11": {"U": "44", "R": "64", "D": "3", "L": "89"},
            "60": {"U": "113", "R": "37", "D": "60", "L": "64"},
            "30": {"U": "30", "R": "64", "D": "30", "L": "64"},
            "116": {"U": "120", "R": "116", "D": "26", "L": "117"},
            "59": {"U": "17", "R": "116", "D": "64", "L": "117"},
            "74": {"U": "96", "R": "64", "D": "122", "L": "8"},
            "125": {"U": "125", "R": "64", "D": "76", "L": "71"},
            "50": {"U": "86", "R": "58", "D": "43", "L": "47"},
            "49": {"U": "49", "R": "42", "D": "9", "L": "19"},
            "123": {"U": "30", "R": "52", "D": "64", "L": "52"},
            "45": {"U": "95", "R": "105", "D": "64", "L": "119"},
            "75": {"U": "107", "R": "2", "D": "75", "L": "109"},
            "68": {"U": "120", "R": "126", "D": "68", "L": "63"},
            "65": {"U": "118", "R": "77", "D": "118", "L": "77"},
            "31": {"U": "7", "R": "88", "D": "64", "L": "79"},
            "114": {"U": "33", "R": "24", "D": "23", "L": "114"},
            "73": {"U": "64", "R": "34", "D": "3", "L": "73"},
            "34": {"U": "44", "R": "34", "D": "64", "L": "73"},
            "15": {"U": "15", "R": "40", "D": "18", "L": "27"},
            "58": {"U": "17", "R": "105", "D": "11", "L": "119"},
            "37": {"U": "64", "R": "41", "D": "57", "L": "90"},
            "56": {"U": "64", "R": "88", "D": "111", "L": "79"},
            "35": {"U": "125", "R": "56", "D": "76", "L": "90"},
            "13": {"U": "0", "R": "34", "D": "64", "L": "73"},
            "17": {"U": "120", "R": "89", "D": "68", "L": "64"},
            "121": {"U": "121", "R": "64", "D": "111", "L": "31"},
            "19": {"U": "7", "R": "88", "D": "111", "L": "79"},
            "110": {"U": "0", "R": "99", "D": "64", "L": "92"},
            "24": {"U": "50", "R": "24", "D": "36", "L": "114"},
            "120": {"U": "120", "R": "59", "D": "68", "L": "64"},
            "81": {"U": "125", "R": "64", "D": "76", "L": "32"},
            "12": {"U": "125", "R": "56", "D": "76", "L": "64"},
            "46": {"U": "113", "R": "78", "D": "60", "L": "64"},
            "77": {"U": "18", "R": "77", "D": "15", "L": "77"},
            "7": {"U": "30", "R": "64", "D": "30", "L": "52"},
            "83": {"U": "49", "R": "110", "D": "9", "L": "64"},
            "97": {"U": "49", "R": "64", "D": "9", "L": "89"},
            "29": {"U": "125", "R": "88", "D": "76", "L": "32"},
            "79": {"U": "48", "R": "88", "D": "64", "L": "79"},
        },
        initial_state="65",
        final_states={"64"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((2, 3, 0, 1)),
            Perm((3, 1, 2, 0)),
            Perm((2, 1, 0, 3)),
            Perm((3, 0, 1, 2)),
            Perm((1, 2, 0, 3)),
        ],
        use_db=True,
    ) == DFA(
        states={
            "24",
            "51",
            "35",
            "41",
            "18",
            "104",
            "72",
            "21",
            "55",
            "48",
            "9",
            "40",
            "66",
            "105",
            "103",
            "42",
            "17",
            "59",
            "75",
            "100",
            "74",
            "20",
            "61",
            "26",
            "109",
            "87",
            "56",
            "29",
            "111",
            "6",
            "90",
            "60",
            "13",
            "81",
            "119",
            "34",
            "101",
            "88",
            "10",
            "36",
            "4",
            "97",
            "7",
            "99",
            "49",
            "32",
            "67",
            "14",
            "27",
            "112",
            "30",
            "58",
            "47",
            "25",
            "69",
            "120",
            "15",
            "38",
            "117",
            "84",
            "116",
            "77",
            "28",
            "33",
            "82",
            "50",
            "89",
            "102",
            "39",
            "44",
            "107",
            "71",
            "76",
            "5",
            "11",
            "37",
            "110",
            "92",
            "91",
            "83",
            "85",
            "52",
            "19",
            "113",
            "64",
            "73",
            "54",
            "65",
            "43",
            "118",
            "106",
            "2",
            "0",
            "70",
            "12",
            "96",
            "79",
            "31",
            "1",
            "46",
            "86",
            "98",
            "62",
            "3",
            "95",
            "94",
            "108",
            "115",
            "78",
            "23",
            "45",
            "63",
            "80",
            "16",
            "8",
            "53",
            "22",
            "68",
            "93",
            "57",
            "114",
        },
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "86": {"U": "61", "R": "45", "D": "72", "L": "69"},
            "6": {"U": "44", "R": "47", "D": "21", "L": "6"},
            "54": {"U": "18", "R": "76", "D": "111", "L": "51"},
            "115": {"U": "73", "R": "2", "D": "5", "L": "31"},
            "118": {"U": "73", "R": "56", "D": "60", "L": "51"},
            "89": {"U": "58", "R": "116", "D": "35", "L": "113"},
            "28": {"U": "18", "R": "4", "D": "111", "L": "51"},
            "16": {"U": "51", "R": "16", "D": "7", "L": "3"},
            "10": {"U": "10", "R": "98", "D": "100", "L": "51"},
            "36": {"U": "58", "R": "65", "D": "35", "L": "51"},
            "90": {"U": "51", "R": "90", "D": "51", "L": "104"},
            "40": {"U": "18", "R": "68", "D": "111", "L": "51"},
            "3": {"U": "51", "R": "16", "D": "38", "L": "3"},
            "4": {"U": "117", "R": "25", "D": "51", "L": "75"},
            "42": {"U": "14", "R": "8", "D": "81", "L": "88"},
            "61": {"U": "61", "R": "51", "D": "72", "L": "114"},
            "57": {"U": "51", "R": "57", "D": "7", "L": "0"},
            "78": {"U": "11", "R": "51", "D": "94", "L": "56"},
            "119": {"U": "120", "R": "71", "D": "119", "L": "63"},
            "23": {"U": "43", "R": "23", "D": "51", "L": "48"},
            "71": {"U": "102", "R": "47", "D": "42", "L": "6"},
            "63": {"U": "1", "R": "107", "D": "40", "L": "22"},
            "109": {"U": "51", "R": "23", "D": "51", "L": "48"},
            "95": {"U": "73", "R": "25", "D": "15", "L": "75"},
            "8": {"U": "73", "R": "90", "D": "51", "L": "104"},
            "87": {"U": "87", "R": "51", "D": "85", "L": "51"},
            "102": {"U": "87", "R": "56", "D": "85", "L": "70"},
            "26": {"U": "55", "R": "51", "D": "64", "L": "51"},
            "84": {"U": "84", "R": "37", "D": "84", "L": "29"},
            "18": {"U": "18", "R": "12", "D": "111", "L": "90"},
            "108": {"U": "11", "R": "66", "D": "94", "L": "105"},
            "101": {"U": "51", "R": "56", "D": "60", "L": "101"},
            "2": {"U": "36", "R": "2", "D": "7", "L": "31"},
            "66": {"U": "51", "R": "57", "D": "73", "L": "0"},
            "47": {"U": "28", "R": "47", "D": "86", "L": "6"},
            "111": {"U": "18", "R": "116", "D": "111", "L": "115"},
            "43": {"U": "10", "R": "76", "D": "100", "L": "51"},
            "20": {"U": "20", "R": "12", "D": "33", "L": "109"},
            "52": {"U": "61", "R": "51", "D": "72", "L": "69"},
            "22": {"U": "59", "R": "107", "D": "89", "L": "22"},
            "93": {"U": "54", "R": "25", "D": "51", "L": "75"},
            "85": {"U": "87", "R": "50", "D": "85", "L": "80"},
            "103": {"U": "51", "R": "98", "D": "51", "L": "110"},
            "94": {"U": "11", "R": "50", "D": "94", "L": "32"},
            "14": {"U": "14", "R": "98", "D": "81", "L": "90"},
            "113": {"U": "51", "R": "2", "D": "15", "L": "31"},
            "91": {"U": "119", "R": "91", "D": "120", "L": "91"},
            "99": {"U": "58", "R": "76", "D": "35", "L": "51"},
            "76": {"U": "118", "R": "98", "D": "51", "L": "110"},
            "21": {"U": "18", "R": "41", "D": "111", "L": "95"},
            "117": {"U": "87", "R": "56", "D": "85", "L": "51"},
            "55": {"U": "55", "R": "51", "D": "64", "L": "90"},
            "62": {"U": "52", "R": "30", "D": "108", "L": "62"},
            "5": {"U": "58", "R": "68", "D": "35", "L": "51"},
            "106": {"U": "106", "R": "93", "D": "53", "L": "114"},
            "92": {"U": "112", "R": "25", "D": "73", "L": "75"},
            "44": {"U": "61", "R": "90", "D": "72", "L": "69"},
            "112": {"U": "87", "R": "56", "D": "85", "L": "56"},
            "100": {"U": "10", "R": "51", "D": "100", "L": "13"},
            "80": {"U": "51", "R": "16", "D": "117", "L": "3"},
            "96": {"U": "78", "R": "57", "D": "82", "L": "0"},
            "9": {"U": "84", "R": "91", "D": "84", "L": "91"},
            "38": {"U": "87", "R": "50", "D": "85", "L": "70"},
            "27": {"U": "106", "R": "19", "D": "53", "L": "69"},
            "72": {"U": "61", "R": "74", "D": "72", "L": "96"},
            "33": {"U": "20", "R": "116", "D": "33", "L": "67"},
            "51": {"U": "51", "R": "51", "D": "51", "L": "51"},
            "67": {"U": "49", "R": "2", "D": "5", "L": "31"},
            "69": {"U": "87", "R": "16", "D": "118", "L": "3"},
            "70": {"U": "51", "R": "16", "D": "118", "L": "3"},
            "107": {"U": "39", "R": "107", "D": "7", "L": "22"},
            "1": {"U": "18", "R": "76", "D": "111", "L": "56"},
            "32": {"U": "73", "R": "16", "D": "117", "L": "3"},
            "82": {"U": "11", "R": "56", "D": "94", "L": "51"},
            "88": {"U": "73", "R": "56", "D": "73", "L": "101"},
            "53": {"U": "106", "R": "46", "D": "53", "L": "34"},
            "64": {"U": "55", "R": "51", "D": "64", "L": "88"},
            "48": {"U": "26", "R": "23", "D": "100", "L": "48"},
            "105": {"U": "73", "R": "57", "D": "118", "L": "0"},
            "0": {"U": "26", "R": "57", "D": "38", "L": "0"},
            "98": {"U": "43", "R": "98", "D": "51", "L": "110"},
            "104": {"U": "26", "R": "90", "D": "60", "L": "104"},
            "25": {"U": "36", "R": "25", "D": "7", "L": "75"},
            "39": {"U": "58", "R": "65", "D": "35", "L": "103"},
            "41": {"U": "87", "R": "57", "D": "73", "L": "0"},
            "11": {"U": "11", "R": "51", "D": "94", "L": "90"},
            "60": {"U": "73", "R": "51", "D": "60", "L": "17"},
            "30": {"U": "51", "R": "30", "D": "86", "L": "62"},
            "116": {"U": "87", "R": "16", "D": "51", "L": "3"},
            "59": {"U": "14", "R": "51", "D": "81", "L": "51"},
            "74": {"U": "51", "R": "30", "D": "83", "L": "62"},
            "50": {"U": "51", "R": "16", "D": "51", "L": "3"},
            "49": {"U": "10", "R": "51", "D": "100", "L": "51"},
            "75": {"U": "26", "R": "25", "D": "89", "L": "75"},
            "45": {"U": "51", "R": "90", "D": "26", "L": "104"},
            "68": {"U": "73", "R": "56", "D": "51", "L": "101"},
            "65": {"U": "117", "R": "2", "D": "51", "L": "31"},
            "31": {"U": "51", "R": "2", "D": "89", "L": "31"},
            "114": {"U": "7", "R": "30", "D": "83", "L": "62"},
            "73": {"U": "73", "R": "51", "D": "60", "L": "51"},
            "34": {"U": "24", "R": "25", "D": "40", "L": "75"},
            "15": {"U": "10", "R": "68", "D": "100", "L": "51"},
            "58": {"U": "58", "R": "12", "D": "35", "L": "51"},
            "37": {"U": "27", "R": "29", "D": "79", "L": "37"},
            "56": {"U": "51", "R": "56", "D": "51", "L": "101"},
            "35": {"U": "58", "R": "116", "D": "35", "L": "97"},
            "13": {"U": "51", "R": "98", "D": "49", "L": "110"},
            "17": {"U": "51", "R": "56", "D": "73", "L": "101"},
            "110": {"U": "51", "R": "98", "D": "100", "L": "110"},
            "19": {"U": "118", "R": "23", "D": "26", "L": "48"},
            "24": {"U": "11", "R": "56", "D": "94", "L": "56"},
            "120": {"U": "120", "R": "63", "D": "119", "L": "71"},
            "81": {"U": "14", "R": "51", "D": "81", "L": "77"},
            "12": {"U": "99", "R": "2", "D": "51", "L": "31"},
            "46": {"U": "87", "R": "30", "D": "83", "L": "62"},
            "77": {"U": "73", "R": "98", "D": "49", "L": "110"},
            "7": {"U": "87", "R": "51", "D": "85", "L": "70"},
            "83": {"U": "55", "R": "90", "D": "64", "L": "88"},
            "97": {"U": "51", "R": "2", "D": "5", "L": "31"},
            "29": {"U": "79", "R": "29", "D": "27", "L": "37"},
            "79": {"U": "20", "R": "92", "D": "33", "L": "95"},
        },
        initial_state="9",
        final_states={"51"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((3, 0, 1, 2)),
            Perm((0, 3, 1, 2)),
            Perm((2, 1, 0, 3)),
            Perm((1, 3, 0, 2)),
            Perm((0, 1)),
            Perm((1, 3, 0, 2)),
        ],
        use_db=True,
    ) == DFA(
        states={"6", "1", "3", "5", "2", "0", "4", "9", "7", "8"},
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "7": {"U": "7", "R": "7", "D": "7", "L": "7"},
            "5": {"U": "5", "R": "7", "D": "9", "L": "8"},
            "2": {"U": "5", "R": "7", "D": "9", "L": "7"},
            "0": {"U": "9", "R": "0", "D": "5", "L": "0"},
            "6": {"U": "6", "R": "3", "D": "6", "L": "1"},
            "1": {"U": "7", "R": "1", "D": "2", "L": "3"},
            "8": {"U": "7", "R": "1", "D": "7", "L": "3"},
            "3": {"U": "2", "R": "1", "D": "7", "L": "3"},
            "4": {"U": "6", "R": "0", "D": "6", "L": "0"},
            "9": {"U": "5", "R": "8", "D": "9", "L": "7"},
        },
        initial_state="4",
        final_states={"7"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((2, 0, 1)),
            Perm((0, 1, 2, 3)),
            Perm((0,)),
            Perm((2, 3, 0, 1)),
            Perm((1, 0, 2, 3)),
            Perm((1, 2, 0, 3)),
            Perm((1, 2, 0)),
        ],
        use_db=True,
    ) == DFA(
        states={"3", "1", "2", "0"},
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "2": {"U": "1", "R": "0", "D": "1", "L": "0"},
            "0": {"U": "3", "R": "0", "D": "3", "L": "0"},
            "3": {"U": "3", "R": "3", "D": "3", "L": "3"},
            "1": {"U": "1", "R": "3", "D": "1", "L": "3"},
        },
        initial_state="2",
        final_states={"3"},
    )
    assert PinWords.make_dfa_for_basis(
        [
            Perm((1, 0, 3, 2)),
            Perm((0, 3, 2, 1)),
            Perm((2, 1, 0, 3)),
            Perm((2, 1, 0)),
            Perm((1, 0, 3, 2)),
            Perm((3, 0, 2, 1)),
            Perm((1, 0, 2, 3)),
            Perm((1, 2, 3, 0)),
        ],
        use_db=True,
    ) == DFA(
        states={
            "6",
            "24",
            "43",
            "35",
            "41",
            "18",
            "28",
            "13",
            "21",
            "2",
            "33",
            "0",
            "40",
            "9",
            "12",
            "31",
            "34",
            "1",
            "10",
            "36",
            "39",
            "37",
            "3",
            "11",
            "4",
            "5",
            "7",
            "42",
            "17",
            "32",
            "23",
            "14",
            "27",
            "16",
            "8",
            "20",
            "19",
            "30",
            "26",
            "25",
            "15",
            "22",
            "38",
            "29",
        },
        input_symbols={"U", "R", "D", "L"},
        transitions={
            "26": {"U": "31", "R": "22", "D": "12", "L": "34"},
            "38": {"U": "23", "R": "10", "D": "23", "L": "10"},
            "18": {"U": "2", "R": "40", "D": "35", "L": "18"},
            "6": {"U": "13", "R": "4", "D": "6", "L": "29"},
            "2": {"U": "31", "R": "22", "D": "36", "L": "39"},
            "27": {"U": "12", "R": "22", "D": "12", "L": "34"},
            "33": {"U": "33", "R": "12", "D": "8", "L": "12"},
            "43": {"U": "31", "R": "22", "D": "36", "L": "37"},
            "31": {"U": "31", "R": "1", "D": "36", "L": "12"},
            "28": {"U": "31", "R": "22", "D": "33", "L": "34"},
            "16": {"U": "0", "R": "34", "D": "16", "L": "24"},
            "20": {"U": "2", "R": "21", "D": "17", "L": "20"},
            "1": {"U": "12", "R": "1", "D": "12", "L": "37"},
            "22": {"U": "33", "R": "22", "D": "12", "L": "34"},
            "15": {"U": "2", "R": "25", "D": "14", "L": "15"},
            "10": {"U": "6", "R": "10", "D": "13", "L": "10"},
            "37": {"U": "12", "R": "1", "D": "33", "L": "37"},
            "34": {"U": "12", "R": "22", "D": "19", "L": "34"},
            "14": {"U": "9", "R": "27", "D": "7", "L": "12"},
            "36": {"U": "31", "R": "12", "D": "36", "L": "27"},
            "35": {"U": "0", "R": "28", "D": "16", "L": "42"},
            "40": {"U": "35", "R": "40", "D": "2", "L": "18"},
            "32": {"U": "43", "R": "21", "D": "33", "L": "20"},
            "3": {"U": "33", "R": "1", "D": "8", "L": "1"},
            "4": {"U": "31", "R": "22", "D": "11", "L": "34"},
            "13": {"U": "13", "R": "29", "D": "6", "L": "4"},
            "17": {"U": "9", "R": "12", "D": "7", "L": "12"},
            "42": {"U": "33", "R": "1", "D": "33", "L": "37"},
            "19": {"U": "31", "R": "12", "D": "36", "L": "12"},
            "24": {"U": "43", "R": "21", "D": "12", "L": "20"},
            "0": {"U": "0", "R": "32", "D": "16", "L": "41"},
            "12": {"U": "12", "R": "12", "D": "12", "L": "12"},
            "21": {"U": "30", "R": "21", "D": "12", "L": "20"},
            "25": {"U": "30", "R": "25", "D": "5", "L": "15"},
            "39": {"U": "12", "R": "22", "D": "33", "L": "34"},
            "41": {"U": "31", "R": "22", "D": "19", "L": "34"},
            "11": {"U": "31", "R": "12", "D": "36", "L": "1"},
            "23": {"U": "23", "R": "18", "D": "23", "L": "40"},
            "7": {"U": "9", "R": "12", "D": "7", "L": "24"},
            "5": {"U": "31", "R": "27", "D": "36", "L": "12"},
            "30": {"U": "9", "R": "26", "D": "7", "L": "42"},
            "29": {"U": "43", "R": "25", "D": "3", "L": "15"},
            "8": {"U": "33", "R": "12", "D": "8", "L": "1"},
            "9": {"U": "9", "R": "24", "D": "7", "L": "41"},
        },
        initial_state="38",
        final_states={"12"},
    )


def test_has_finite_alterations():
    assert PinWords.has_finite_alternations([Perm((1, 0, 2, 3, 4))]) is False
    assert (
        PinWords.has_finite_alternations([Perm((3, 1, 0, 4, 2)), Perm((1, 3, 0, 4, 2))])
        is False
    )
    assert (
        PinWords.has_finite_alternations(
            [Perm((2, 1, 3, 0)), Perm((4, 0, 1, 2, 3)), Perm((3, 2, 4, 1, 0))]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((1, 2, 0, 4, 3)),
                Perm((2, 1, 3, 0)),
                Perm((2, 4, 3, 1, 0)),
                Perm((1, 4, 3, 0, 2)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((3, 0, 1, 2, 4)),
                Perm((2, 1, 0, 3, 4)),
                Perm((4, 3, 0, 2, 1)),
                Perm((2, 1, 4, 0, 3)),
                Perm((1, 2, 0, 4, 3)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((1, 4, 2, 3, 0)),
                Perm((3, 0, 1, 2, 4)),
                Perm((0, 1, 4, 2, 3)),
                Perm((0, 1, 3, 2, 4)),
                Perm((1, 3, 2, 0, 4)),
                Perm((2, 0, 1, 3)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((4, 0, 1, 2, 3)),
                Perm((0, 2, 4, 1, 3)),
                Perm((3, 0, 1, 2, 4)),
                Perm((4, 1, 3, 2, 0)),
                Perm((3, 2, 4, 0, 1)),
                Perm((3, 1, 4, 2, 0)),
                Perm((0, 2, 3, 1, 4)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((1, 2, 3, 4, 0)),
                Perm((2, 0, 1, 3, 4)),
                Perm((2, 0, 1, 3, 4)),
                Perm((3, 4, 1, 2, 0)),
                Perm((4, 3, 1, 0, 2)),
                Perm((0, 3, 4, 1, 2)),
                Perm((1, 2, 3, 0)),
                Perm((3, 4, 1, 2, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((2, 1, 4, 3, 0)),
                Perm((2, 4, 3, 0, 1)),
                Perm((4, 0, 1, 2, 3)),
                Perm((3, 1, 0, 2, 4)),
                Perm((2, 4, 0, 3, 1)),
                Perm((0, 1, 4, 2, 3)),
                Perm((3, 0, 2, 1, 4)),
                Perm((3, 2, 1, 0, 4)),
                Perm((3, 2, 0, 4, 1)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((4, 2, 3, 1, 0)),
                Perm((4, 0, 3, 2, 1)),
                Perm((2, 1, 3, 0)),
                Perm((1, 3, 2, 4, 0)),
                Perm((0, 2, 3, 1)),
                Perm((3, 0, 1, 2, 4)),
                Perm((4, 2, 3, 0, 1)),
                Perm((2, 3, 1, 4, 0)),
                Perm((1, 0, 2, 3, 4)),
                Perm((3, 2, 1, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((2, 1, 0, 3)),
                Perm((2, 3, 1, 4, 0)),
                Perm((1, 0, 4, 3, 2)),
                Perm((0, 1, 4, 2, 3)),
                Perm((4, 1, 0, 2, 3)),
                Perm((2, 0, 4, 3, 1)),
                Perm((2, 0, 3, 1, 4)),
                Perm((3, 2, 0, 4, 1)),
                Perm((2, 1, 3, 0)),
                Perm((3, 4, 1, 0, 2)),
                Perm((1, 0, 3, 2)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((0, 2, 3, 1, 4)),
                Perm((3, 0, 1, 4, 2)),
                Perm((1, 3, 4, 2, 0)),
                Perm((3, 1, 0, 2, 4)),
                Perm((3, 2, 1, 0)),
                Perm((0, 3, 1, 2)),
                Perm((3, 4, 0, 2, 1)),
                Perm((2, 0, 1)),
                Perm((2, 1, 4, 0, 3)),
                Perm((1, 3, 2, 4, 0)),
                Perm((1, 4, 3, 0, 2)),
                Perm((1, 2, 3, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((2, 4, 1, 0, 3)),
                Perm((3, 0, 4, 1, 2)),
                Perm((3, 2, 0, 1)),
                Perm((2, 4, 3, 0, 1)),
                Perm((3, 4, 2, 0, 1)),
                Perm((1, 0, 4, 3, 2)),
                Perm((2, 0, 1, 4, 3)),
                Perm((2, 4, 3, 0, 1)),
                Perm((1, 0, 3, 2)),
                Perm((4, 0, 2, 3, 1)),
                Perm((3, 2, 1, 4, 0)),
                Perm((4, 1, 2, 3, 0)),
                Perm((1, 0, 3, 2, 4)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((1, 2, 3, 0)),
                Perm((0,)),
                Perm((2, 3, 4, 1, 0)),
                Perm((4, 3, 0, 1, 2)),
                Perm((0, 2, 3, 4, 1)),
                Perm((0,)),
                Perm((0, 2, 1, 4, 3)),
                Perm((2, 3, 0, 4, 1)),
                Perm((1, 4, 2, 3, 0)),
                Perm((2, 3, 1, 0)),
                Perm((2, 3, 1, 4, 0)),
                Perm((2, 3, 0, 4, 1)),
                Perm((0, 4, 2, 1, 3)),
                Perm((2, 3, 1, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_alternations(
            [
                Perm((3, 0, 1, 2)),
                Perm((3, 0, 2, 4, 1)),
                Perm((3, 2, 1, 4, 0)),
                Perm((2, 3, 1, 0)),
                Perm((3, 4, 0, 1, 2)),
                Perm((1, 4, 2, 0, 3)),
                Perm((1, 0, 2, 3)),
                Perm((0, 1, 2)),
                Perm((2, 0, 3, 1)),
                Perm((2, 3, 0, 1, 4)),
                Perm((2, 3, 1, 0, 4)),
                Perm((1, 4, 0, 3, 2)),
                Perm((1, 2, 0, 3)),
                Perm((2, 1, 4, 0, 3)),
                Perm((1, 4, 0, 3, 2)),
            ]
        )
        is True
    )


def test_has_finite_wedges_type_1():
    assert PinWords.has_finite_wedges_type_1([Perm((2, 1, 4, 3, 0))]) is False
    assert (
        PinWords.has_finite_wedges_type_1([Perm((0, 3, 2, 1)), Perm((1, 4, 3, 2, 0))])
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [Perm((1, 3, 4, 0, 2)), Perm((0,)), Perm((4, 3, 2, 1, 0))]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((1, 2, 4, 3, 0)),
                Perm((3, 4, 2, 1, 0)),
                Perm((1, 4, 3, 2, 0)),
                Perm((3, 4, 1, 0, 2)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((1, 3, 4, 2, 0)),
                Perm((4, 3, 1, 0, 2)),
                Perm((4, 1, 3, 2, 0)),
                Perm((0, 3, 2, 1, 4)),
                Perm((0, 2, 1, 3, 4)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((3, 0, 2, 1)),
                Perm((2, 0, 4, 3, 1)),
                Perm((2, 3, 4, 1, 0)),
                Perm((0,)),
                Perm((3, 0, 4, 1, 2)),
                Perm((4, 0, 3, 1, 2)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((3, 1, 0, 2, 4)),
                Perm((3, 0, 4, 2, 1)),
                Perm((4, 2, 1, 0, 3)),
                Perm((3, 2, 1, 0)),
                Perm((3, 0, 1, 2, 4)),
                Perm((4, 1, 3, 2, 0)),
                Perm((4, 3, 2, 0, 1)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((0, 1)),
                Perm((2, 4, 1, 0, 3)),
                Perm((0, 3, 1, 2, 4)),
                Perm((3, 0, 4, 2, 1)),
                Perm((2, 3, 0, 4, 1)),
                Perm((1, 3, 4, 2, 0)),
                Perm((0, 4, 3, 1, 2)),
                Perm((1, 2, 0, 4, 3)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((0, 1, 3, 4, 2)),
                Perm((1, 4, 2, 0, 3)),
                Perm((1, 3, 2, 0, 4)),
                Perm((2, 0, 1)),
                Perm((3, 0, 1, 4, 2)),
                Perm((4, 1, 3, 2, 0)),
                Perm((1, 3, 0, 4, 2)),
                Perm((3, 0, 2, 1)),
                Perm((3, 2, 1, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((1, 0)),
                Perm((0, 1, 3, 2, 4)),
                Perm((2, 0, 3, 1, 4)),
                Perm((1, 2, 3, 0)),
                Perm((4, 1, 0, 2, 3)),
                Perm((4, 1, 0, 2, 3)),
                Perm((0, 3, 2, 4, 1)),
                Perm((1, 0, 2, 3)),
                Perm((2, 3, 1, 0)),
                Perm((3, 1, 4, 2, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((0, 2, 3, 1)),
                Perm((2, 3, 0, 1, 4)),
                Perm((3, 2, 1, 0)),
                Perm((0, 1, 2, 4, 3)),
                Perm((1, 3, 2, 4, 0)),
                Perm((0, 4, 1, 2, 3)),
                Perm((2, 3, 0, 1, 4)),
                Perm((2, 1, 0, 3)),
                Perm((2, 4, 1, 0, 3)),
                Perm((3, 0, 4, 2, 1)),
                Perm((2, 4, 1, 0, 3)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((2, 1, 3, 0)),
                Perm((3, 2, 0, 1, 4)),
                Perm((2, 3, 4, 0, 1)),
                Perm((3, 2, 4, 0, 1)),
                Perm((0, 2, 1, 3, 4)),
                Perm((3, 1, 2, 0, 4)),
                Perm((3, 1, 0, 2, 4)),
                Perm((0, 2, 1, 3)),
                Perm((4, 1, 2, 0, 3)),
                Perm((4, 1, 0, 3, 2)),
                Perm((0, 3, 1, 2)),
                Perm((4, 0, 2, 1, 3)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((0, 3, 2, 1)),
                Perm((1, 3, 0, 2, 4)),
                Perm((2, 4, 3, 1, 0)),
                Perm((0, 4, 3, 2, 1)),
                Perm((4, 0, 2, 1, 3)),
                Perm((3, 4, 2, 1, 0)),
                Perm((3, 1, 2, 4, 0)),
                Perm((0, 3, 2, 1)),
                Perm((4, 2, 1, 3, 0)),
                Perm((3, 2, 0, 4, 1)),
                Perm((3, 4, 0, 2, 1)),
                Perm((3, 0, 1, 2)),
                Perm((3, 4, 0, 1, 2)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((3, 1, 2, 0)),
                Perm((1, 4, 3, 2, 0)),
                Perm((3, 1, 4, 2, 0)),
                Perm((4, 0, 1, 3, 2)),
                Perm((2, 4, 0, 3, 1)),
                Perm((4, 3, 0, 2, 1)),
                Perm((0, 2, 1)),
                Perm((0, 1)),
                Perm((1, 4, 2, 0, 3)),
                Perm((1, 2, 3, 0, 4)),
                Perm((0, 4, 2, 3, 1)),
                Perm((1, 3, 0, 2)),
                Perm((0, 1, 2, 4, 3)),
                Perm((2, 3, 0, 1)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_1(
            [
                Perm((3, 1, 0, 4, 2)),
                Perm((1, 2, 4, 0, 3)),
                Perm((3, 4, 2, 0, 1)),
                Perm((0, 1, 3, 2, 4)),
                Perm((0, 2, 1, 4, 3)),
                Perm((0, 1, 2, 4, 3)),
                Perm((1, 3, 4, 0, 2)),
                Perm((4, 0, 3, 1, 2)),
                Perm((3, 2, 0, 4, 1)),
                Perm((4, 0, 3, 1, 2)),
                Perm((4, 1, 3, 2, 0)),
                Perm((1, 0, 3, 2)),
                Perm((4, 2, 1, 3, 0)),
                Perm((3, 1, 0, 2, 4)),
                Perm((2, 3, 0, 1, 4)),
            ]
        )
        is True
    )


def test_has_finite_wedges_of_type_2():
    assert PinWords.has_finite_wedges_type_2([Perm((0, 2, 1, 4, 3))]) is False
    assert (
        PinWords.has_finite_wedges_type_2(
            [Perm((3, 1, 4, 2, 0)), Perm((0, 4, 2, 1, 3))]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [Perm((4, 0, 3, 2, 1)), Perm((1, 3, 0, 4, 2)), Perm((3, 0, 1, 2))]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((3, 2, 1, 4, 0)),
                Perm((3, 0, 4, 2, 1)),
                Perm((1, 3, 2, 0, 4)),
                Perm((0, 2, 3, 1)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((4, 2, 0, 3, 1)),
                Perm((0, 4, 1, 3, 2)),
                Perm((4, 2, 3, 1, 0)),
                Perm((3, 1, 2, 4, 0)),
                Perm((3, 0, 4, 1, 2)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((4, 1, 3, 2, 0)),
                Perm((4, 1, 3, 0, 2)),
                Perm((3, 4, 2, 1, 0)),
                Perm((3, 0, 2, 4, 1)),
                Perm((3, 0, 4, 1, 2)),
                Perm((4, 1, 2, 0, 3)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((0, 2, 4, 1, 3)),
                Perm((2, 0, 1)),
                Perm((4, 2, 1, 3, 0)),
                Perm((4, 2, 0, 1, 3)),
                Perm((0, 2, 4, 3, 1)),
                Perm((2, 0, 1, 3)),
                Perm((3, 1, 2, 0, 4)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((1, 3, 0, 2)),
                Perm((0, 1, 2, 3)),
                Perm((2, 1, 3, 0, 4)),
                Perm((3, 2, 1, 4, 0)),
                Perm((1, 0, 3, 4, 2)),
                Perm((1, 0, 2, 3)),
                Perm((3, 1, 2, 0)),
                Perm((0, 1)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((0, 2, 1, 4, 3)),
                Perm((3, 0, 2, 4, 1)),
                Perm((2, 3, 0, 1)),
                Perm((0, 3, 4, 2, 1)),
                Perm((0, 2, 4, 1, 3)),
                Perm((2, 1, 4, 3, 0)),
                Perm((0, 4, 1, 3, 2)),
                Perm((1, 3, 2, 4, 0)),
                Perm((3, 2, 4, 0, 1)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((3, 1, 0, 2, 4)),
                Perm((1, 4, 3, 0, 2)),
                Perm((1, 4, 0, 3, 2)),
                Perm((2, 4, 3, 1, 0)),
                Perm((2, 4, 3, 0, 1)),
                Perm((2, 3, 1, 0)),
                Perm((1, 0, 2, 3, 4)),
                Perm((4, 1, 0, 2, 3)),
                Perm((3, 1, 2, 4, 0)),
                Perm((3, 0, 1, 4, 2)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((4, 1, 0, 2, 3)),
                Perm((2, 0, 3, 4, 1)),
                Perm((0, 3, 2, 1)),
                Perm((3, 1, 0, 2)),
                Perm((1, 2, 3, 0)),
                Perm((4, 2, 1, 3, 0)),
                Perm((2, 1, 0, 3, 4)),
                Perm((1, 2, 0, 4, 3)),
                Perm((0, 3, 2, 4, 1)),
                Perm((0, 2, 3, 4, 1)),
                Perm((1, 3, 2, 4, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((4, 3, 2, 0, 1)),
                Perm((2, 1, 0, 3, 4)),
                Perm((3, 1, 0, 2, 4)),
                Perm((1, 2, 3, 0, 4)),
                Perm((1, 3, 2, 4, 0)),
                Perm((4, 0, 1, 3, 2)),
                Perm((2, 0, 1, 3, 4)),
                Perm((1, 3, 4, 2, 0)),
                Perm((0, 3, 1, 4, 2)),
                Perm((1, 0, 2, 4, 3)),
                Perm((4, 1, 0, 2, 3)),
                Perm((3, 4, 0, 2, 1)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((2, 1, 3, 4, 0)),
                Perm((0, 1)),
                Perm((1, 2, 0)),
                Perm((1, 3, 0, 2, 4)),
                Perm((2, 4, 1, 0, 3)),
                Perm((0, 4, 1, 3, 2)),
                Perm((0, 3, 2, 1)),
                Perm((1, 0, 3, 2, 4)),
                Perm((0, 4, 2, 3, 1)),
                Perm((0, 1, 2, 3, 4)),
                Perm((2, 1, 4, 0, 3)),
                Perm((4, 3, 1, 0, 2)),
                Perm((1, 0, 3, 4, 2)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((2, 4, 1, 0, 3)),
                Perm((2, 0, 3, 1)),
                Perm((1, 2, 0)),
                Perm((0, 2, 3, 4, 1)),
                Perm((3, 0, 1, 2, 4)),
                Perm((1, 2, 0)),
                Perm((2, 4, 1, 0, 3)),
                Perm((0, 1, 3, 2)),
                Perm((2, 4, 1, 3, 0)),
                Perm((4, 0, 1, 2, 3)),
                Perm((2, 4, 1, 3, 0)),
                Perm((4, 0, 2, 1, 3)),
                Perm((3, 1, 0, 4, 2)),
                Perm((3, 0, 2, 1, 4)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_wedges_type_2(
            [
                Perm((4, 3, 1, 2, 0)),
                Perm((0, 1)),
                Perm((1, 3, 2, 0)),
                Perm((2, 4, 1, 0, 3)),
                Perm((1, 2, 0, 3)),
                Perm((3, 0, 1, 4, 2)),
                Perm((0, 3, 1, 4, 2)),
                Perm((1, 3, 4, 2, 0)),
                Perm((0, 3, 2, 1, 4)),
                Perm((1, 4, 0, 3, 2)),
                Perm((4, 2, 1, 3, 0)),
                Perm((1, 0, 4, 3, 2)),
                Perm((3, 2, 0, 4, 1)),
                Perm((3, 2, 4, 0, 1)),
                Perm((2, 0, 1)),
            ]
        )
        is True
    )


def test_has_finite_special_simples():
    assert PinWords.has_finite_special_simples([Perm((2, 1, 0))]) is False
    assert (
        PinWords.has_finite_special_simples(
            [Perm((1, 3, 4, 2, 0)), Perm((3, 1, 2, 0, 4))]
        )
        is False
    )
    assert (
        PinWords.has_finite_special_simples(
            [Perm((0, 1, 2)), Perm((3, 0, 2, 1)), Perm((1, 4, 0, 2, 3))]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((1, 0, 4, 2, 3)),
                Perm((2, 0, 1, 3)),
                Perm((1, 0, 3, 4, 2)),
                Perm((4, 3, 0, 1, 2)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((3, 4, 1, 0, 2)),
                Perm((0, 2, 1, 4, 3)),
                Perm((0, 4, 3, 1, 2)),
                Perm((1, 4, 2, 3, 0)),
                Perm((2, 0, 3, 1, 4)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((3, 4, 2, 0, 1)),
                Perm((4, 1, 2, 3, 0)),
                Perm((4, 1, 0, 2, 3)),
                Perm((1, 0, 4, 2, 3)),
                Perm((4, 1, 0, 2, 3)),
                Perm((1, 2, 0, 4, 3)),
            ]
        )
        is False
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((1, 4, 0, 3, 2)),
                Perm((2, 1, 3, 0, 4)),
                Perm((4, 3, 1, 0, 2)),
                Perm((1, 2, 3, 0)),
                Perm((1, 3, 0, 4, 2)),
                Perm((2, 0, 1)),
                Perm((2, 1, 4, 3, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((1, 3, 2, 4, 0)),
                Perm((0, 1, 3, 2, 4)),
                Perm((2, 3, 0, 1)),
                Perm((2, 1, 0, 3, 4)),
                Perm((2, 0, 1)),
                Perm((4, 2, 1, 3, 0)),
                Perm((3, 0, 1, 2, 4)),
                Perm((3, 1, 2, 4, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((3, 2, 0, 1)),
                Perm((2, 1, 3, 0, 4)),
                Perm((4, 3, 2, 0, 1)),
                Perm((0, 2, 1, 3)),
                Perm((2, 1, 3, 4, 0)),
                Perm((1, 2, 3, 0, 4)),
                Perm((0, 2, 1, 4, 3)),
                Perm((2, 4, 3, 0, 1)),
                Perm((0, 1, 2, 3)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((0, 2, 1, 4, 3)),
                Perm((0, 3, 4, 2, 1)),
                Perm((2, 3, 1, 0)),
                Perm((4, 2, 3, 0, 1)),
                Perm((1, 2, 3, 4, 0)),
                Perm((4, 0, 3, 2, 1)),
                Perm((1, 3, 0, 2)),
                Perm((0, 3, 4, 1, 2)),
                Perm((0, 4, 2, 3, 1)),
                Perm((2, 3, 4, 1, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((1, 3, 2, 0, 4)),
                Perm((0, 1, 2, 4, 3)),
                Perm((1, 3, 0, 4, 2)),
                Perm((1, 4, 0, 2, 3)),
                Perm((2, 1, 0, 3, 4)),
                Perm((2, 1, 3, 0)),
                Perm((4, 1, 3, 0, 2)),
                Perm((1, 2, 0, 3)),
                Perm((3, 1, 4, 2, 0)),
                Perm((1, 0)),
                Perm((0, 3, 1, 4, 2)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((2, 1, 0, 3)),
                Perm((3, 0, 2, 4, 1)),
                Perm((1, 2, 3, 0, 4)),
                Perm((3, 1, 4, 0, 2)),
                Perm((3, 0, 2, 4, 1)),
                Perm((0, 2, 1, 3)),
                Perm((3, 2, 0, 1, 4)),
                Perm((1, 3, 0, 2)),
                Perm((3, 4, 2, 0, 1)),
                Perm((2, 1, 0, 4, 3)),
                Perm((4, 0, 2, 1, 3)),
                Perm((1, 2, 3, 4, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((1, 3, 0, 2)),
                Perm((1, 0, 4, 2, 3)),
                Perm((0,)),
                Perm((1, 0, 2)),
                Perm((1, 2, 0, 3)),
                Perm((2, 4, 1, 3, 0)),
                Perm((4, 2, 1, 3, 0)),
                Perm((0, 2, 3, 1, 4)),
                Perm((4, 3, 2, 0, 1)),
                Perm((0, 2, 4, 1, 3)),
                Perm((2, 0, 1, 3, 4)),
                Perm((0, 2, 3, 4, 1)),
                Perm((2, 3, 1, 4, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((3, 4, 2, 0, 1)),
                Perm((0, 2, 1, 3)),
                Perm((2, 0, 1, 4, 3)),
                Perm((1, 4, 2, 3, 0)),
                Perm((0, 4, 2, 3, 1)),
                Perm((3, 1, 0, 4, 2)),
                Perm((4, 2, 0, 1, 3)),
                Perm((2, 0, 1, 4, 3)),
                Perm((1, 4, 0, 2, 3)),
                Perm((3, 2, 0, 4, 1)),
                Perm((1, 0, 2, 3)),
                Perm((0, 4, 1, 2, 3)),
                Perm((0, 1, 2, 3, 4)),
                Perm((1, 4, 3, 2, 0)),
            ]
        )
        is True
    )
    assert (
        PinWords.has_finite_special_simples(
            [
                Perm((0, 1, 2, 3)),
                Perm((0, 4, 3, 1, 2)),
                Perm((2, 3, 0, 4, 1)),
                Perm((0, 4, 2, 1, 3)),
                Perm((4, 1, 0, 2, 3)),
                Perm((4, 1, 3, 2, 0)),
                Perm((3, 4, 1, 0, 2)),
                Perm((0, 2, 1, 3, 4)),
                Perm((1, 4, 2, 0, 3)),
                Perm((2, 4, 3, 1, 0)),
                Perm((4, 3, 0, 2, 1)),
                Perm((0, 2, 4, 1, 3)),
                Perm((3, 0, 1, 2, 4)),
                Perm((3, 2, 1, 0)),
                Perm((1, 0, 3, 4, 2)),
            ]
        )
        is True
    )


def test_store_dfa_for_perm():
    perm = Perm.from_string("21043")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("12340")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("20314")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("2130")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("31402")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("1302")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("1023")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("01243")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("34201")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("012")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("12403")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("01342")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("32014")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("2103")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()

    perm = Perm.from_string("42301")
    PinWords.store_dfa_for_perm(perm)
    path = Path(f"dfa_db/S{len(perm)}/{perm}.txt")
    assert path.is_file()


def test_load_dfa_for_perm():
    assert PinWords.load_dfa_for_perm(Perm.from_string("31024")) == DFA(
        states={
            "4",
            "26",
            "41",
            "11",
            "12",
            "28",
            "24",
            "23",
            "20",
            "17",
            "39",
            "10",
            "27",
            "44",
            "3",
            "22",
            "19",
            "29",
            "38",
            "36",
            "34",
            "8",
            "33",
            "40",
            "15",
            "30",
            "46",
            "42",
            "16",
            "31",
            "32",
            "35",
            "0",
            "43",
            "21",
            "14",
            "7",
            "25",
            "2",
            "13",
            "5",
            "45",
            "9",
            "6",
            "1",
            "37",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "16": {"L": "21", "D": "5", "U": "30", "R": "16"},
            "5": {"L": "7", "D": "11", "U": "20", "R": "8"},
            "13": {"L": "13", "D": "13", "U": "13", "R": "13"},
            "15": {"L": "43", "D": "11", "U": "20", "R": "8"},
            "34": {"L": "13", "D": "31", "U": "19", "R": "27"},
            "42": {"L": "9", "D": "15", "U": "4", "R": "25"},
            "33": {"L": "12", "D": "31", "U": "19", "R": "22"},
            "17": {"L": "9", "D": "15", "U": "18", "R": "25"},
            "20": {"L": "42", "D": "11", "U": "20", "R": "28"},
            "44": {"L": "12", "D": "12", "U": "44", "R": "13"},
            "7": {"L": "9", "D": "18", "U": "4", "R": "25"},
            "23": {"L": "21", "D": "18", "U": "15", "R": "16"},
            "10": {"L": "16", "D": "10", "U": "10", "R": "21"},
            "18": {"L": "0", "D": "31", "U": "19", "R": "27"},
            "8": {"L": "9", "D": "12", "U": "18", "R": "25"},
            "40": {"L": "38", "D": "18", "U": "14", "R": "40"},
            "0": {"L": "38", "D": "18", "U": "12", "R": "40"},
            "26": {"L": "36", "D": "10", "U": "10", "R": "36"},
            "27": {"L": "38", "D": "12", "U": "34", "R": "40"},
            "39": {"L": "38", "D": "18", "U": "34", "R": "40"},
            "11": {"L": "7", "D": "11", "U": "20", "R": "17"},
            "30": {"L": "28", "D": "37", "U": "29", "R": "24"},
            "38": {"L": "38", "D": "31", "U": "12", "R": "40"},
            "45": {"L": "43", "D": "11", "U": "20", "R": "41"},
            "43": {"L": "38", "D": "18", "U": "33", "R": "40"},
            "4": {"L": "43", "D": "11", "U": "20", "R": "12"},
            "37": {"L": "23", "D": "37", "U": "29", "R": "6"},
            "12": {"L": "12", "D": "12", "U": "44", "R": "46"},
            "14": {"L": "13", "D": "31", "U": "19", "R": "39"},
            "46": {"L": "12", "D": "12", "U": "13", "R": "46"},
            "35": {"L": "13", "D": "12", "U": "44", "R": "13"},
            "32": {"L": "7", "D": "11", "U": "20", "R": "12"},
            "29": {"L": "6", "D": "37", "U": "29", "R": "23"},
            "31": {"L": "0", "D": "31", "U": "19", "R": "39"},
            "19": {"L": "12", "D": "31", "U": "19", "R": "39"},
            "2": {"L": "43", "D": "11", "U": "20", "R": "1"},
            "3": {"L": "12", "D": "31", "U": "19", "R": "27"},
            "41": {"L": "9", "D": "18", "U": "18", "R": "25"},
            "22": {"L": "12", "D": "12", "U": "35", "R": "46"},
            "28": {"L": "38", "D": "18", "U": "3", "R": "40"},
            "21": {"L": "21", "D": "30", "U": "5", "R": "16"},
            "25": {"L": "9", "D": "5", "U": "31", "R": "25"},
            "36": {"L": "36", "D": "29", "U": "37", "R": "36"},
            "24": {"L": "9", "D": "18", "U": "2", "R": "25"},
            "9": {"L": "9", "D": "45", "U": "32", "R": "25"},
            "6": {"L": "9", "D": "15", "U": "2", "R": "25"},
            "1": {"L": "38", "D": "12", "U": "3", "R": "40"},
        },
        initial_state="26",
        final_states={"13"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("01324")) == DFA(
        states={
            "80",
            "106",
            "28",
            "17",
            "81",
            "10",
            "97",
            "55",
            "36",
            "68",
            "16",
            "32",
            "77",
            "21",
            "53",
            "92",
            "123",
            "47",
            "117",
            "72",
            "58",
            "108",
            "61",
            "86",
            "9",
            "18",
            "4",
            "91",
            "65",
            "12",
            "95",
            "88",
            "102",
            "44",
            "22",
            "76",
            "74",
            "8",
            "89",
            "104",
            "33",
            "51",
            "15",
            "115",
            "128",
            "111",
            "69",
            "90",
            "114",
            "14",
            "59",
            "101",
            "2",
            "87",
            "105",
            "126",
            "37",
            "83",
            "26",
            "41",
            "99",
            "11",
            "93",
            "23",
            "54",
            "71",
            "20",
            "103",
            "27",
            "78",
            "19",
            "29",
            "38",
            "73",
            "52",
            "40",
            "84",
            "46",
            "131",
            "107",
            "49",
            "62",
            "31",
            "116",
            "35",
            "0",
            "96",
            "120",
            "127",
            "100",
            "110",
            "70",
            "13",
            "124",
            "34",
            "45",
            "6",
            "125",
            "119",
            "130",
            "98",
            "113",
            "24",
            "75",
            "39",
            "79",
            "3",
            "129",
            "109",
            "121",
            "30",
            "42",
            "57",
            "112",
            "43",
            "63",
            "94",
            "56",
            "64",
            "50",
            "122",
            "7",
            "118",
            "25",
            "82",
            "5",
            "48",
            "66",
            "67",
            "85",
            "60",
            "1",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "90": {"L": "75", "D": "41", "U": "106", "R": "82"},
            "13": {"L": "97", "D": "71", "U": "3", "R": "13"},
            "96": {"L": "97", "D": "108", "U": "3", "R": "13"},
            "98": {"L": "6", "D": "0", "U": "11", "R": "33"},
            "105": {"L": "118", "D": "7", "U": "130", "R": "66"},
            "42": {"L": "24", "D": "42", "U": "42", "R": "32"},
            "33": {"L": "6", "D": "40", "U": "11", "R": "33"},
            "67": {"L": "54", "D": "103", "U": "21", "R": "47"},
            "53": {"L": "54", "D": "109", "U": "74", "R": "122"},
            "44": {"L": "102", "D": "94", "U": "113", "R": "44"},
            "80": {"L": "97", "D": "0", "U": "10", "R": "13"},
            "18": {"L": "59", "D": "53", "U": "9", "R": "18"},
            "92": {"L": "75", "D": "41", "U": "3", "R": "92"},
            "73": {"L": "59", "D": "39", "U": "9", "R": "18"},
            "114": {"L": "97", "D": "108", "U": "120", "R": "13"},
            "77": {"L": "23", "D": "77", "U": "104", "R": "70"},
            "85": {"L": "75", "D": "112", "U": "106", "R": "92"},
            "122": {"L": "59", "D": "37", "U": "90", "R": "18"},
            "88": {"L": "29", "D": "43", "U": "11", "R": "88"},
            "60": {"L": "4", "D": "15", "U": "60", "R": "100"},
            "56": {"L": "20", "D": "56", "U": "127", "R": "55"},
            "31": {"L": "59", "D": "63", "U": "105", "R": "18"},
            "19": {"L": "48", "D": "43", "U": "121", "R": "129"},
            "86": {"L": "34", "D": "123", "U": "90", "R": "83"},
            "113": {"L": "91", "D": "126", "U": "78", "R": "111"},
            "51": {"L": "51", "D": "117", "U": "14", "R": "16"},
            "49": {"L": "57", "D": "56", "U": "127", "R": "110"},
            "95": {"L": "19", "D": "41", "U": "106", "R": "92"},
            "0": {"L": "27", "D": "77", "U": "104", "R": "70"},
            "78": {"L": "25", "D": "126", "U": "78", "R": "124"},
            "61": {"L": "75", "D": "41", "U": "106", "R": "66"},
            "36": {"L": "36", "D": "60", "U": "15", "R": "36"},
            "16": {"L": "51", "D": "67", "U": "116", "R": "16"},
            "34": {"L": "34", "D": "20", "U": "89", "R": "83"},
            "115": {"L": "29", "D": "43", "U": "115", "R": "11"},
            "64": {"L": "111", "D": "79", "U": "81", "R": "11"},
            "126": {"L": "100", "D": "126", "U": "78", "R": "46"},
            "69": {"L": "97", "D": "108", "U": "2", "R": "13"},
            "110": {"L": "75", "D": "41", "U": "17", "R": "92"},
            "4": {"L": "51", "D": "39", "U": "12", "R": "16"},
            "63": {"L": "75", "D": "41", "U": "106", "R": "92"},
            "68": {"L": "97", "D": "52", "U": "3", "R": "13"},
            "55": {"L": "34", "D": "123", "U": "9", "R": "83"},
            "87": {"L": "20", "D": "56", "U": "127", "R": "86"},
            "12": {"L": "99", "D": "109", "U": "74", "R": "50"},
            "14": {"L": "31", "D": "103", "U": "21", "R": "91"},
            "124": {"L": "102", "D": "116", "U": "125", "R": "44"},
            "116": {"L": "57", "D": "56", "U": "127", "R": "50"},
            "41": {"L": "23", "D": "41", "U": "106", "R": "92"},
            "128": {"L": "36", "D": "42", "U": "42", "R": "36"},
            "72": {"L": "99", "D": "109", "U": "74", "R": "0"},
            "21": {"L": "8", "D": "103", "U": "21", "R": "91"},
            "79": {"L": "111", "D": "79", "U": "81", "R": "62"},
            "50": {"L": "75", "D": "41", "U": "2", "R": "92"},
            "123": {"L": "20", "D": "56", "U": "127", "R": "50"},
            "109": {"L": "54", "D": "109", "U": "74", "R": "73"},
            "125": {"L": "0", "D": "79", "U": "81", "R": "98"},
            "24": {"L": "32", "D": "101", "U": "93", "R": "24"},
            "58": {"L": "97", "D": "108", "U": "23", "R": "13"},
            "1": {"L": "51", "D": "39", "U": "116", "R": "16"},
            "120": {"L": "118", "D": "7", "U": "130", "R": "23"},
            "48": {"L": "48", "D": "11", "U": "121", "R": "129"},
            "5": {"L": "97", "D": "125", "U": "10", "R": "13"},
            "82": {"L": "27", "D": "77", "U": "115", "R": "70"},
            "112": {"L": "29", "D": "76", "U": "121", "R": "129"},
            "52": {"L": "0", "D": "7", "U": "130", "R": "96"},
            "93": {"L": "91", "D": "126", "U": "78", "R": "114"},
            "104": {"L": "27", "D": "77", "U": "104", "R": "11"},
            "17": {"L": "27", "D": "77", "U": "104", "R": "88"},
            "76": {"L": "11", "D": "76", "U": "121", "R": "129"},
            "20": {"L": "48", "D": "76", "U": "121", "R": "129"},
            "71": {"L": "111", "D": "7", "U": "130", "R": "96"},
            "7": {"L": "111", "D": "7", "U": "130", "R": "68"},
            "8": {"L": "51", "D": "117", "U": "12", "R": "16"},
            "40": {"L": "111", "D": "79", "U": "81", "R": "98"},
            "26": {"L": "31", "D": "109", "U": "74", "R": "107"},
            "39": {"L": "63", "D": "109", "U": "74", "R": "69"},
            "43": {"L": "11", "D": "43", "U": "115", "R": "88"},
            "70": {"L": "27", "D": "77", "U": "11", "R": "70"},
            "46": {"L": "59", "D": "39", "U": "72", "R": "18"},
            "29": {"L": "29", "D": "11", "U": "115", "R": "88"},
            "35": {"L": "34", "D": "20", "U": "49", "R": "83"},
            "106": {"L": "75", "D": "41", "U": "106", "R": "65"},
            "121": {"L": "48", "D": "76", "U": "121", "R": "65"},
            "2": {"L": "75", "D": "41", "U": "106", "R": "23"},
            "47": {"L": "59", "D": "37", "U": "61", "R": "18"},
            "107": {"L": "34", "D": "123", "U": "0", "R": "83"},
            "89": {"L": "57", "D": "56", "U": "127", "R": "107"},
            "99": {"L": "34", "D": "95", "U": "61", "R": "83"},
            "25": {"L": "59", "D": "39", "U": "119", "R": "18"},
            "54": {"L": "97", "D": "108", "U": "10", "R": "13"},
            "84": {"L": "59", "D": "37", "U": "0", "R": "18"},
            "101": {"L": "31", "D": "103", "U": "21", "R": "47"},
            "81": {"L": "131", "D": "79", "U": "81", "R": "11"},
            "129": {"L": "48", "D": "76", "U": "3", "R": "129"},
            "119": {"L": "99", "D": "109", "U": "74", "R": "110"},
            "15": {"L": "100", "D": "15", "U": "60", "R": "4"},
            "102": {"L": "102", "D": "93", "U": "45", "R": "44"},
            "83": {"L": "34", "D": "87", "U": "9", "R": "83"},
            "100": {"L": "102", "D": "116", "U": "30", "R": "44"},
            "59": {"L": "59", "D": "117", "U": "26", "R": "18"},
            "23": {"L": "29", "D": "43", "U": "115", "R": "88"},
            "10": {"L": "118", "D": "7", "U": "130", "R": "65"},
            "117": {"L": "118", "D": "7", "U": "130", "R": "96"},
            "130": {"L": "5", "D": "7", "U": "130", "R": "65"},
            "27": {"L": "27", "D": "23", "U": "104", "R": "70"},
            "74": {"L": "28", "D": "109", "U": "74", "R": "107"},
            "103": {"L": "54", "D": "103", "U": "21", "R": "1"},
            "111": {"L": "6", "D": "0", "U": "22", "R": "33"},
            "127": {"L": "35", "D": "56", "U": "127", "R": "107"},
            "11": {"L": "11", "D": "11", "U": "11", "R": "11"},
            "65": {"L": "48", "D": "76", "U": "23", "R": "129"},
            "30": {"L": "118", "D": "7", "U": "130", "R": "58"},
            "131": {"L": "6", "D": "125", "U": "22", "R": "33"},
            "108": {"L": "27", "D": "41", "U": "106", "R": "92"},
            "45": {"L": "31", "D": "109", "U": "74", "R": "84"},
            "38": {"L": "80", "D": "7", "U": "130", "R": "65"},
            "37": {"L": "85", "D": "56", "U": "127", "R": "50"},
            "66": {"L": "75", "D": "41", "U": "23", "R": "92"},
            "57": {"L": "34", "D": "20", "U": "61", "R": "83"},
            "118": {"L": "75", "D": "77", "U": "106", "R": "92"},
            "32": {"L": "32", "D": "93", "U": "101", "R": "24"},
            "94": {"L": "31", "D": "109", "U": "74", "R": "122"},
            "97": {"L": "97", "D": "125", "U": "38", "R": "13"},
            "3": {"L": "48", "D": "76", "U": "121", "R": "23"},
            "91": {"L": "34", "D": "123", "U": "61", "R": "83"},
            "28": {"L": "59", "D": "117", "U": "119", "R": "18"},
            "22": {"L": "0", "D": "79", "U": "81", "R": "11"},
            "62": {"L": "6", "D": "125", "U": "11", "R": "33"},
            "9": {"L": "57", "D": "56", "U": "127", "R": "0"},
            "6": {"L": "6", "D": "125", "U": "64", "R": "33"},
            "75": {"L": "75", "D": "23", "U": "106", "R": "92"},
        },
        initial_state="128",
        final_states={"11"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("42310")) == DFA(
        states={
            "80",
            "106",
            "28",
            "17",
            "81",
            "10",
            "97",
            "55",
            "36",
            "68",
            "16",
            "32",
            "77",
            "21",
            "53",
            "92",
            "123",
            "47",
            "117",
            "58",
            "72",
            "108",
            "61",
            "9",
            "86",
            "18",
            "4",
            "65",
            "91",
            "12",
            "95",
            "88",
            "102",
            "44",
            "22",
            "76",
            "74",
            "8",
            "89",
            "33",
            "104",
            "15",
            "51",
            "115",
            "128",
            "111",
            "69",
            "114",
            "90",
            "14",
            "59",
            "101",
            "2",
            "87",
            "105",
            "126",
            "37",
            "99",
            "26",
            "41",
            "83",
            "11",
            "93",
            "23",
            "54",
            "71",
            "20",
            "103",
            "27",
            "78",
            "19",
            "29",
            "38",
            "73",
            "52",
            "40",
            "84",
            "131",
            "46",
            "107",
            "49",
            "62",
            "31",
            "0",
            "116",
            "35",
            "96",
            "120",
            "127",
            "100",
            "110",
            "70",
            "13",
            "124",
            "45",
            "34",
            "6",
            "125",
            "130",
            "119",
            "98",
            "113",
            "24",
            "75",
            "39",
            "79",
            "3",
            "129",
            "109",
            "121",
            "30",
            "42",
            "57",
            "112",
            "63",
            "56",
            "94",
            "43",
            "64",
            "50",
            "7",
            "122",
            "118",
            "25",
            "82",
            "5",
            "48",
            "66",
            "67",
            "85",
            "60",
            "1",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "29": {"D": "22", "L": "125", "U": "112", "R": "114"},
            "65": {"D": "65", "L": "65", "U": "65", "R": "65"},
            "74": {"D": "21", "L": "6", "U": "5", "R": "131"},
            "32": {"D": "37", "L": "38", "U": "78", "R": "32"},
            "35": {"D": "20", "L": "37", "U": "109", "R": "77"},
            "19": {"D": "122", "L": "65", "U": "19", "R": "36"},
            "30": {"D": "30", "L": "57", "U": "41", "R": "121"},
            "52": {"D": "3", "L": "104", "U": "123", "R": "42"},
            "27": {"D": "82", "L": "27", "U": "74", "R": "43"},
            "23": {"D": "122", "L": "40", "U": "19", "R": "75"},
            "131": {"D": "105", "L": "117", "U": "49", "R": "89"},
            "111": {"D": "114", "L": "25", "U": "127", "R": "92"},
            "42": {"D": "15", "L": "73", "U": "119", "R": "76"},
            "1": {"D": "94", "L": "130", "U": "91", "R": "62"},
            "118": {"D": "22", "L": "97", "U": "112", "R": "111"},
            "0": {"D": "65", "L": "96", "U": "4", "R": "0"},
            "11": {"D": "15", "L": "73", "U": "37", "R": "76"},
            "3": {"D": "3", "L": "68", "U": "123", "R": "42"},
            "58": {"D": "22", "L": "93", "U": "112", "R": "121"},
            "91": {"D": "15", "L": "37", "U": "119", "R": "76"},
            "124": {"D": "21", "L": "7", "U": "5", "R": "131"},
            "87": {"D": "87", "L": "96", "U": "4", "R": "65"},
            "49": {"D": "79", "L": "12", "U": "54", "R": "70"},
            "25": {"D": "58", "L": "25", "U": "85", "R": "92"},
            "21": {"D": "21", "L": "63", "U": "5", "R": "110"},
            "92": {"D": "90", "L": "25", "U": "118", "R": "92"},
            "34": {"D": "34", "L": "18", "U": "34", "R": "66"},
            "45": {"D": "34", "L": "47", "U": "34", "R": "47"},
            "8": {"D": "15", "L": "73", "U": "119", "R": "0"},
            "128": {"D": "42", "L": "117", "U": "49", "R": "89"},
            "97": {"D": "105", "L": "117", "U": "75", "R": "89"},
            "31": {"D": "29", "L": "26", "U": "102", "R": "44"},
            "64": {"D": "79", "L": "64", "U": "91", "R": "70"},
            "76": {"D": "65", "L": "73", "U": "119", "R": "76"},
            "61": {"D": "8", "L": "64", "U": "54", "R": "70"},
            "121": {"D": "126", "L": "130", "U": "10", "R": "62"},
            "130": {"D": "14", "L": "130", "U": "91", "R": "62"},
            "81": {"D": "23", "L": "59", "U": "120", "R": "81"},
            "17": {"D": "98", "L": "110", "U": "17", "R": "31"},
            "113": {"D": "126", "L": "130", "U": "37", "R": "62"},
            "71": {"D": "22", "L": "39", "U": "112", "R": "60"},
            "122": {"D": "122", "L": "107", "U": "19", "R": "6"},
            "103": {"D": "53", "L": "27", "U": "23", "R": "43"},
            "72": {"D": "87", "L": "73", "U": "119", "R": "76"},
            "36": {"D": "23", "L": "59", "U": "16", "R": "81"},
            "116": {"D": "79", "L": "106", "U": "54", "R": "70"},
            "67": {"D": "75", "L": "130", "U": "10", "R": "62"},
            "6": {"D": "75", "L": "59", "U": "16", "R": "81"},
            "126": {"D": "79", "L": "64", "U": "54", "R": "32"},
            "43": {"D": "124", "L": "27", "U": "48", "R": "43"},
            "73": {"D": "15", "L": "73", "U": "91", "R": "76"},
            "4": {"D": "87", "L": "65", "U": "4", "R": "0"},
            "98": {"D": "98", "L": "31", "U": "17", "R": "110"},
            "59": {"D": "9", "L": "59", "U": "65", "R": "81"},
            "127": {"D": "20", "L": "12", "U": "109", "R": "77"},
            "110": {"D": "53", "L": "27", "U": "24", "R": "43"},
            "68": {"D": "105", "L": "117", "U": "85", "R": "89"},
            "22": {"D": "22", "L": "51", "U": "112", "R": "121"},
            "18": {"D": "124", "L": "66", "U": "108", "R": "18"},
            "63": {"D": "29", "L": "25", "U": "84", "R": "92"},
            "96": {"D": "87", "L": "96", "U": "65", "R": "0"},
            "77": {"D": "100", "L": "64", "U": "54", "R": "70"},
            "112": {"D": "22", "L": "97", "U": "112", "R": "28"},
            "60": {"D": "83", "L": "117", "U": "49", "R": "89"},
            "105": {"D": "3", "L": "13", "U": "123", "R": "42"},
            "78": {"D": "100", "L": "65", "U": "78", "R": "32"},
            "70": {"D": "37", "L": "64", "U": "54", "R": "70"},
            "39": {"D": "79", "L": "64", "U": "50", "R": "70"},
            "55": {"D": "30", "L": "131", "U": "41", "R": "111"},
            "100": {"D": "100", "L": "38", "U": "78", "R": "37"},
            "7": {"D": "126", "L": "130", "U": "35", "R": "62"},
            "20": {"D": "20", "L": "1", "U": "109", "R": "6"},
            "129": {"D": "30", "L": "33", "U": "41", "R": "121"},
            "5": {"D": "21", "L": "103", "U": "5", "R": "2"},
            "104": {"D": "105", "L": "117", "U": "116", "R": "89"},
            "62": {"D": "23", "L": "130", "U": "95", "R": "62"},
            "38": {"D": "100", "L": "38", "U": "65", "R": "32"},
            "66": {"D": "108", "L": "66", "U": "124", "R": "18"},
            "117": {"D": "52", "L": "117", "U": "85", "R": "89"},
            "2": {"D": "29", "L": "25", "U": "71", "R": "92"},
            "53": {"D": "3", "L": "13", "U": "123", "R": "128"},
            "14": {"D": "20", "L": "99", "U": "109", "R": "6"},
            "99": {"D": "126", "L": "130", "U": "91", "R": "62"},
            "84": {"D": "22", "L": "75", "U": "112", "R": "60"},
            "46": {"D": "3", "L": "97", "U": "123", "R": "128"},
            "12": {"D": "79", "L": "64", "U": "37", "R": "70"},
            "37": {"D": "87", "L": "96", "U": "4", "R": "0"},
            "106": {"D": "100", "L": "38", "U": "4", "R": "32"},
            "86": {"D": "3", "L": "39", "U": "123", "R": "128"},
            "44": {"D": "90", "L": "26", "U": "55", "R": "44"},
            "50": {"D": "100", "L": "96", "U": "78", "R": "32"},
            "102": {"D": "22", "L": "13", "U": "112", "R": "60"},
            "28": {"D": "90", "L": "25", "U": "71", "R": "92"},
            "82": {"D": "22", "L": "93", "U": "112", "R": "111"},
            "119": {"D": "15", "L": "11", "U": "119", "R": "76"},
            "85": {"D": "3", "L": "75", "U": "123", "R": "128"},
            "123": {"D": "3", "L": "97", "U": "123", "R": "69"},
            "56": {"D": "23", "L": "130", "U": "10", "R": "62"},
            "95": {"D": "20", "L": "11", "U": "109", "R": "67"},
            "90": {"D": "20", "L": "99", "U": "109", "R": "77"},
            "48": {"D": "22", "L": "80", "U": "112", "R": "111"},
            "41": {"D": "30", "L": "131", "U": "41", "R": "115"},
            "57": {"D": "29", "L": "26", "U": "53", "R": "44"},
            "88": {"D": "79", "L": "37", "U": "54", "R": "70"},
            "16": {"D": "122", "L": "65", "U": "19", "R": "75"},
            "40": {"D": "75", "L": "59", "U": "65", "R": "81"},
            "9": {"D": "122", "L": "40", "U": "19", "R": "6"},
            "101": {"D": "3", "L": "13", "U": "123", "R": "61"},
            "94": {"D": "20", "L": "99", "U": "109", "R": "75"},
            "26": {"D": "129", "L": "26", "U": "53", "R": "44"},
            "69": {"D": "42", "L": "117", "U": "86", "R": "89"},
            "10": {"D": "20", "L": "11", "U": "109", "R": "77"},
            "51": {"D": "29", "L": "25", "U": "85", "R": "92"},
            "47": {"D": "17", "L": "47", "U": "98", "R": "47"},
            "120": {"D": "122", "L": "65", "U": "19", "R": "6"},
            "93": {"D": "101", "L": "25", "U": "116", "R": "92"},
            "13": {"D": "79", "L": "64", "U": "88", "R": "70"},
            "115": {"D": "90", "L": "26", "U": "102", "R": "44"},
            "15": {"D": "15", "L": "73", "U": "119", "R": "65"},
            "79": {"D": "79", "L": "64", "U": "54", "R": "37"},
            "107": {"D": "23", "L": "59", "U": "65", "R": "81"},
            "33": {"D": "101", "L": "25", "U": "49", "R": "92"},
            "75": {"D": "100", "L": "38", "U": "78", "R": "32"},
            "24": {"D": "20", "L": "113", "U": "109", "R": "77"},
            "54": {"D": "79", "L": "11", "U": "54", "R": "70"},
            "108": {"D": "30", "L": "33", "U": "41", "R": "111"},
            "80": {"D": "101", "L": "25", "U": "75", "R": "92"},
            "83": {"D": "79", "L": "64", "U": "54", "R": "72"},
            "89": {"D": "42", "L": "117", "U": "46", "R": "89"},
            "114": {"D": "79", "L": "64", "U": "54", "R": "70"},
            "125": {"D": "126", "L": "130", "U": "88", "R": "62"},
            "109": {"D": "20", "L": "11", "U": "109", "R": "56"},
        },
        initial_state="45",
        final_states={"65"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("43201")) == DFA(
        states={
            "83",
            "26",
            "41",
            "11",
            "80",
            "28",
            "93",
            "23",
            "54",
            "71",
            "20",
            "17",
            "81",
            "10",
            "27",
            "55",
            "78",
            "19",
            "29",
            "38",
            "36",
            "73",
            "52",
            "40",
            "84",
            "46",
            "49",
            "68",
            "16",
            "62",
            "32",
            "77",
            "0",
            "31",
            "35",
            "21",
            "53",
            "92",
            "47",
            "70",
            "72",
            "58",
            "13",
            "61",
            "34",
            "9",
            "86",
            "45",
            "6",
            "18",
            "4",
            "91",
            "65",
            "12",
            "24",
            "75",
            "39",
            "88",
            "79",
            "44",
            "3",
            "22",
            "76",
            "74",
            "8",
            "89",
            "33",
            "51",
            "15",
            "30",
            "57",
            "42",
            "69",
            "90",
            "63",
            "43",
            "56",
            "94",
            "64",
            "50",
            "14",
            "7",
            "59",
            "2",
            "25",
            "82",
            "5",
            "48",
            "87",
            "66",
            "67",
            "85",
            "60",
            "1",
            "37",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "44": {"U": "42", "D": "66", "R": "82", "L": "24"},
            "49": {"U": "28", "D": "50", "R": "26", "L": "18"},
            "27": {"U": "47", "D": "27", "R": "68", "L": "38"},
            "26": {"U": "33", "D": "50", "R": "26", "L": "18"},
            "53": {"U": "53", "D": "67", "R": "49", "L": "51"},
            "15": {"U": "3", "D": "72", "R": "11", "L": "78"},
            "11": {"U": "11", "D": "11", "R": "11", "L": "11"},
            "58": {"U": "85", "D": "4", "R": "23", "L": "10"},
            "88": {"U": "85", "D": "4", "R": "63", "L": "51"},
            "29": {"U": "88", "D": "62", "R": "29", "L": "25"},
            "4": {"U": "85", "D": "4", "R": "54", "L": "17"},
            "9": {"U": "85", "D": "4", "R": "23", "L": "36"},
            "65": {"U": "46", "D": "75", "R": "65", "L": "5"},
            "62": {"U": "53", "D": "67", "R": "71", "L": "36"},
            "66": {"U": "42", "D": "66", "R": "82", "L": "39"},
            "87": {"U": "1", "D": "61", "R": "23", "L": "78"},
            "13": {"U": "3", "D": "8", "R": "16", "L": "78"},
            "93": {"U": "28", "D": "61", "R": "29", "L": "25"},
            "85": {"U": "85", "D": "4", "R": "19", "L": "51"},
            "73": {"U": "87", "D": "61", "R": "29", "L": "25"},
            "23": {"U": "1", "D": "83", "R": "23", "L": "0"},
            "48": {"U": "53", "D": "67", "R": "64", "L": "36"},
            "20": {"U": "40", "D": "92", "R": "20", "L": "2"},
            "81": {"U": "81", "D": "14", "R": "41", "L": "56"},
            "19": {"U": "84", "D": "62", "R": "29", "L": "25"},
            "0": {"U": "35", "D": "61", "R": "23", "L": "0"},
            "31": {"U": "94", "D": "8", "R": "11", "L": "12"},
            "94": {"U": "94", "D": "8", "R": "71", "L": "11"},
            "90": {"U": "28", "D": "76", "R": "26", "L": "18"},
            "82": {"U": "84", "D": "61", "R": "29", "L": "25"},
            "35": {"U": "94", "D": "8", "R": "71", "L": "12"},
            "80": {"U": "85", "D": "4", "R": "13", "L": "59"},
            "89": {"U": "74", "D": "74", "R": "69", "L": "69"},
            "14": {"U": "81", "D": "14", "R": "56", "L": "41"},
            "22": {"U": "28", "D": "72", "R": "26", "L": "18"},
            "70": {"U": "70", "D": "6", "R": "49", "L": "52"},
            "59": {"U": "51", "D": "61", "R": "29", "L": "25"},
            "24": {"U": "1", "D": "61", "R": "23", "L": "0"},
            "6": {"U": "70", "D": "6", "R": "45", "L": "90"},
            "75": {"U": "70", "D": "6", "R": "11", "L": "22"},
            "30": {"U": "51", "D": "76", "R": "26", "L": "18"},
            "68": {"U": "79", "D": "8", "R": "65", "L": "5"},
            "71": {"U": "94", "D": "31", "R": "71", "L": "12"},
            "86": {"U": "70", "D": "6", "R": "16", "L": "22"},
            "1": {"U": "1", "D": "61", "R": "23", "L": "35"},
            "5": {"U": "86", "D": "48", "R": "65", "L": "5"},
            "12": {"U": "11", "D": "8", "R": "71", "L": "12"},
            "40": {"U": "85", "D": "4", "R": "63", "L": "36"},
            "16": {"U": "3", "D": "15", "R": "16", "L": "78"},
            "84": {"U": "85", "D": "4", "R": "23", "L": "51"},
            "47": {"U": "47", "D": "27", "R": "19", "L": "52"},
            "54": {"U": "28", "D": "8", "R": "26", "L": "18"},
            "78": {"U": "35", "D": "72", "R": "16", "L": "78"},
            "25": {"U": "51", "D": "55", "R": "29", "L": "25"},
            "36": {"U": "51", "D": "72", "R": "26", "L": "18"},
            "3": {"U": "3", "D": "72", "R": "16", "L": "35"},
            "64": {"U": "28", "D": "11", "R": "26", "L": "18"},
            "7": {"U": "3", "D": "11", "R": "16", "L": "78"},
            "91": {"U": "85", "D": "4", "R": "23", "L": "59"},
            "34": {"U": "47", "D": "27", "R": "23", "L": "93"},
            "17": {"U": "51", "D": "80", "R": "29", "L": "25"},
            "61": {"U": "1", "D": "61", "R": "13", "L": "0"},
            "55": {"U": "85", "D": "4", "R": "54", "L": "59"},
            "10": {"U": "3", "D": "61", "R": "23", "L": "0"},
            "63": {"U": "84", "D": "83", "R": "29", "L": "25"},
            "67": {"U": "53", "D": "67", "R": "64", "L": "30"},
            "74": {"U": "74", "D": "74", "R": "43", "L": "77"},
            "39": {"U": "24", "D": "91", "R": "60", "L": "57"},
            "92": {"U": "70", "D": "6", "R": "71", "L": "22"},
            "28": {"U": "53", "D": "67", "R": "16", "L": "51"},
            "21": {"U": "94", "D": "11", "R": "71", "L": "12"},
            "83": {"U": "3", "D": "72", "R": "71", "L": "78"},
            "79": {"U": "53", "D": "67", "R": "16", "L": "36"},
            "46": {"U": "53", "D": "67", "R": "37", "L": "36"},
            "18": {"U": "51", "D": "48", "R": "26", "L": "18"},
            "72": {"U": "3", "D": "72", "R": "7", "L": "78"},
            "76": {"U": "53", "D": "67", "R": "7", "L": "36"},
            "2": {"U": "86", "D": "55", "R": "20", "L": "2"},
            "32": {"U": "42", "D": "66", "R": "82", "L": "73"},
            "56": {"U": "9", "D": "61", "R": "20", "L": "2"},
            "51": {"U": "3", "D": "72", "R": "16", "L": "78"},
            "52": {"U": "79", "D": "72", "R": "65", "L": "5"},
            "45": {"U": "79", "D": "11", "R": "65", "L": "5"},
            "37": {"U": "28", "D": "15", "R": "26", "L": "18"},
            "33": {"U": "53", "D": "67", "R": "37", "L": "51"},
            "8": {"U": "94", "D": "8", "R": "21", "L": "12"},
            "77": {"U": "32", "D": "34", "R": "77", "L": "43"},
            "38": {"U": "28", "D": "80", "R": "29", "L": "25"},
            "41": {"U": "58", "D": "91", "R": "60", "L": "57"},
            "60": {"U": "44", "D": "91", "R": "60", "L": "57"},
            "42": {"U": "42", "D": "66", "R": "41", "L": "24"},
            "69": {"U": "14", "D": "81", "R": "69", "L": "69"},
            "50": {"U": "53", "D": "67", "R": "11", "L": "36"},
            "43": {"U": "34", "D": "32", "R": "77", "L": "43"},
            "57": {"U": "24", "D": "32", "R": "60", "L": "57"},
        },
        initial_state="89",
        final_states={"11"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("2031")) == DFA(
        states={
            "4",
            "11",
            "0",
            "12",
            "14",
            "7",
            "10",
            "2",
            "13",
            "3",
            "5",
            "8",
            "9",
            "6",
            "1",
            "15",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "15": {"D": "12", "R": "3", "U": "12", "L": "3"},
            "0": {"D": "5", "R": "6", "U": "1", "L": "4"},
            "3": {"D": "1", "R": "3", "U": "5", "L": "3"},
            "12": {"D": "12", "R": "9", "U": "12", "L": "8"},
            "6": {"D": "2", "R": "8", "U": "4", "L": "9"},
            "13": {"D": "4", "R": "8", "U": "0", "L": "9"},
            "8": {"D": "10", "R": "8", "U": "14", "L": "9"},
            "2": {"D": "5", "R": "4", "U": "1", "L": "13"},
            "7": {"D": "2", "R": "8", "U": "0", "L": "9"},
            "11": {"D": "10", "R": "8", "U": "10", "L": "9"},
            "14": {"D": "5", "R": "7", "U": "1", "L": "7"},
            "4": {"D": "4", "R": "4", "U": "4", "L": "4"},
            "9": {"D": "14", "R": "8", "U": "10", "L": "9"},
            "5": {"D": "5", "R": "11", "U": "1", "L": "7"},
            "10": {"D": "5", "R": "6", "U": "1", "L": "13"},
            "1": {"D": "5", "R": "7", "U": "1", "L": "11"},
        },
        initial_state="15",
        final_states={"4"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("03214")) == DFA(
        states={
            "4",
            "26",
            "41",
            "11",
            "12",
            "28",
            "24",
            "23",
            "20",
            "17",
            "39",
            "10",
            "27",
            "44",
            "3",
            "22",
            "19",
            "29",
            "38",
            "36",
            "8",
            "33",
            "52",
            "40",
            "15",
            "51",
            "46",
            "30",
            "49",
            "16",
            "42",
            "31",
            "32",
            "35",
            "0",
            "43",
            "21",
            "53",
            "50",
            "14",
            "7",
            "45",
            "47",
            "25",
            "2",
            "13",
            "5",
            "48",
            "34",
            "9",
            "6",
            "1",
            "37",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "5": {"L": "42", "D": "8", "U": "37", "R": "27"},
            "48": {"L": "34", "D": "34", "U": "19", "R": "11"},
            "13": {"L": "34", "D": "34", "U": "39", "R": "11"},
            "52": {"L": "53", "D": "33", "U": "37", "R": "2"},
            "42": {"L": "42", "D": "34", "U": "1", "R": "27"},
            "33": {"L": "53", "D": "33", "U": "37", "R": "37"},
            "17": {"L": "15", "D": "51", "U": "45", "R": "17"},
            "53": {"L": "53", "D": "53", "U": "53", "R": "53"},
            "20": {"L": "20", "D": "53", "U": "19", "R": "21"},
            "44": {"L": "15", "D": "0", "U": "3", "R": "17"},
            "7": {"L": "10", "D": "7", "U": "7", "R": "9"},
            "8": {"L": "20", "D": "33", "U": "37", "R": "37"},
            "18": {"L": "42", "D": "34", "U": "30", "R": "27"},
            "40": {"L": "14", "D": "25", "U": "1", "R": "37"},
            "26": {"L": "47", "D": "33", "U": "37", "R": "37"},
            "39": {"L": "2", "D": "34", "U": "43", "R": "53"},
            "43": {"L": "34", "D": "34", "U": "43", "R": "53"},
            "46": {"L": "50", "D": "0", "U": "3", "R": "13"},
            "29": {"L": "42", "D": "12", "U": "1", "R": "27"},
            "35": {"L": "15", "D": "26", "U": "45", "R": "17"},
            "31": {"L": "4", "D": "31", "U": "28", "R": "44"},
            "19": {"L": "20", "D": "16", "U": "19", "R": "53"},
            "2": {"L": "20", "D": "16", "U": "19", "R": "21"},
            "47": {"L": "24", "D": "53", "U": "2", "R": "37"},
            "51": {"L": "18", "D": "25", "U": "1", "R": "27"},
            "49": {"L": "44", "D": "31", "U": "28", "R": "44"},
            "25": {"L": "34", "D": "25", "U": "1", "R": "27"},
            "0": {"L": "50", "D": "0", "U": "3", "R": "6"},
            "36": {"L": "41", "D": "7", "U": "7", "R": "41"},
            "16": {"L": "53", "D": "16", "U": "19", "R": "21"},
            "15": {"L": "15", "D": "46", "U": "32", "R": "17"},
            "34": {"L": "34", "D": "34", "U": "43", "R": "11"},
            "23": {"L": "34", "D": "34", "U": "43", "R": "22"},
            "10": {"L": "9", "D": "44", "U": "49", "R": "10"},
            "27": {"L": "42", "D": "25", "U": "37", "R": "27"},
            "11": {"L": "34", "D": "34", "U": "53", "R": "11"},
            "30": {"L": "34", "D": "34", "U": "43", "R": "21"},
            "38": {"L": "24", "D": "52", "U": "37", "R": "37"},
            "45": {"L": "38", "D": "0", "U": "3", "R": "35"},
            "4": {"L": "9", "D": "44", "U": "44", "R": "10"},
            "37": {"L": "24", "D": "33", "U": "37", "R": "37"},
            "12": {"L": "34", "D": "25", "U": "1", "R": "48"},
            "14": {"L": "24", "D": "16", "U": "37", "R": "37"},
            "32": {"L": "42", "D": "25", "U": "1", "R": "5"},
            "3": {"L": "29", "D": "0", "U": "3", "R": "35"},
            "41": {"L": "41", "D": "28", "U": "31", "R": "41"},
            "22": {"L": "34", "D": "2", "U": "53", "R": "11"},
            "28": {"L": "44", "D": "31", "U": "28", "R": "4"},
            "21": {"L": "20", "D": "16", "U": "53", "R": "21"},
            "50": {"L": "15", "D": "46", "U": "23", "R": "17"},
            "24": {"L": "24", "D": "53", "U": "37", "R": "37"},
            "9": {"L": "9", "D": "49", "U": "44", "R": "10"},
            "6": {"L": "42", "D": "25", "U": "40", "R": "27"},
            "1": {"L": "42", "D": "25", "U": "1", "R": "37"},
        },
        initial_state="36",
        final_states={"53"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("34120")) == DFA(
        states={
            "4",
            "26",
            "41",
            "11",
            "12",
            "28",
            "24",
            "23",
            "20",
            "17",
            "39",
            "10",
            "27",
            "44",
            "3",
            "22",
            "19",
            "29",
            "38",
            "36",
            "8",
            "33",
            "40",
            "15",
            "30",
            "46",
            "49",
            "16",
            "42",
            "31",
            "32",
            "35",
            "0",
            "43",
            "21",
            "14",
            "7",
            "45",
            "47",
            "25",
            "2",
            "13",
            "5",
            "48",
            "34",
            "9",
            "6",
            "1",
            "37",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "16": {"L": "4", "D": "48", "U": "15", "R": "44"},
            "5": {"L": "12", "D": "5", "U": "27", "R": "7"},
            "48": {"L": "38", "D": "25", "U": "31", "R": "41"},
            "13": {"L": "4", "D": "48", "U": "0", "R": "44"},
            "15": {"L": "12", "D": "47", "U": "17", "R": "40"},
            "36": {"L": "4", "D": "37", "U": "0", "R": "44"},
            "34": {"L": "34", "D": "23", "U": "33", "R": "34"},
            "42": {"L": "35", "D": "47", "U": "7", "R": "40"},
            "33": {"L": "13", "D": "33", "U": "23", "R": "45"},
            "17": {"L": "42", "D": "47", "U": "17", "R": "40"},
            "20": {"L": "4", "D": "37", "U": "14", "R": "44"},
            "44": {"L": "4", "D": "37", "U": "49", "R": "44"},
            "7": {"L": "7", "D": "7", "U": "7", "R": "7"},
            "23": {"L": "45", "D": "33", "U": "23", "R": "13"},
            "10": {"L": "35", "D": "47", "U": "19", "R": "40"},
            "8": {"L": "12", "D": "5", "U": "27", "R": "11"},
            "18": {"L": "4", "D": "48", "U": "8", "R": "44"},
            "40": {"L": "35", "D": "37", "U": "17", "R": "40"},
            "26": {"L": "35", "D": "47", "U": "27", "R": "40"},
            "27": {"L": "21", "D": "5", "U": "27", "R": "11"},
            "39": {"L": "21", "D": "47", "U": "17", "R": "40"},
            "11": {"L": "12", "D": "7", "U": "27", "R": "11"},
            "38": {"L": "35", "D": "47", "U": "39", "R": "40"},
            "30": {"L": "29", "D": "30", "U": "30", "R": "32"},
            "45": {"L": "32", "D": "43", "U": "3", "R": "29"},
            "43": {"L": "38", "D": "25", "U": "31", "R": "20"},
            "4": {"L": "4", "D": "22", "U": "46", "R": "44"},
            "37": {"L": "35", "D": "47", "U": "17", "R": "8"},
            "12": {"L": "12", "D": "5", "U": "19", "R": "11"},
            "14": {"L": "10", "D": "47", "U": "17", "R": "40"},
            "46": {"L": "8", "D": "25", "U": "31", "R": "20"},
            "29": {"L": "32", "D": "24", "U": "1", "R": "29"},
            "35": {"L": "35", "D": "47", "U": "6", "R": "40"},
            "32": {"L": "32", "D": "1", "U": "24", "R": "29"},
            "24": {"L": "3", "D": "33", "U": "23", "R": "9"},
            "19": {"L": "7", "D": "5", "U": "27", "R": "11"},
            "31": {"L": "18", "D": "25", "U": "31", "R": "36"},
            "2": {"L": "34", "D": "30", "U": "30", "R": "34"},
            "47": {"L": "35", "D": "47", "U": "17", "R": "41"},
            "3": {"L": "35", "D": "47", "U": "17", "R": "40"},
            "41": {"L": "35", "D": "8", "U": "17", "R": "40"},
            "28": {"L": "4", "D": "48", "U": "46", "R": "44"},
            "22": {"L": "16", "D": "25", "U": "31", "R": "41"},
            "49": {"L": "18", "D": "25", "U": "31", "R": "20"},
            "21": {"L": "12", "D": "5", "U": "7", "R": "11"},
            "25": {"L": "28", "D": "25", "U": "31", "R": "41"},
            "0": {"L": "26", "D": "25", "U": "31", "R": "20"},
            "9": {"L": "4", "D": "48", "U": "14", "R": "44"},
            "6": {"L": "7", "D": "47", "U": "17", "R": "40"},
            "1": {"L": "16", "D": "25", "U": "31", "R": "20"},
        },
        initial_state="2",
        final_states={"7"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("21034")) == DFA(
        states={
            "4",
            "26",
            "11",
            "16",
            "0",
            "12",
            "21",
            "24",
            "23",
            "14",
            "7",
            "20",
            "17",
            "10",
            "25",
            "2",
            "13",
            "3",
            "22",
            "5",
            "19",
            "8",
            "9",
            "6",
            "1",
            "15",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "16": {"L": "15", "D": "1", "U": "1", "R": "15"},
            "5": {"L": "11", "D": "11", "U": "26", "R": "7"},
            "13": {"L": "11", "D": "14", "U": "13", "R": "23"},
            "15": {"L": "15", "D": "10", "U": "25", "R": "15"},
            "17": {"L": "17", "D": "21", "U": "20", "R": "4"},
            "20": {"L": "12", "D": "14", "U": "13", "R": "6"},
            "7": {"L": "11", "D": "11", "U": "3", "R": "7"},
            "23": {"L": "12", "D": "3", "U": "0", "R": "6"},
            "10": {"L": "20", "D": "25", "U": "10", "R": "2"},
            "18": {"L": "11", "D": "3", "U": "3", "R": "7"},
            "8": {"L": "11", "D": "11", "U": "22", "R": "18"},
            "26": {"L": "3", "D": "11", "U": "22", "R": "3"},
            "11": {"L": "11", "D": "11", "U": "22", "R": "7"},
            "4": {"L": "17", "D": "20", "U": "21", "R": "4"},
            "12": {"L": "12", "D": "14", "U": "8", "R": "6"},
            "14": {"L": "12", "D": "14", "U": "13", "R": "5"},
            "19": {"L": "19", "D": "19", "U": "19", "R": "19"},
            "2": {"L": "17", "D": "20", "U": "20", "R": "4"},
            "3": {"L": "3", "D": "3", "U": "9", "R": "24"},
            "22": {"L": "11", "D": "11", "U": "22", "R": "3"},
            "21": {"L": "20", "D": "25", "U": "10", "R": "20"},
            "25": {"L": "2", "D": "25", "U": "10", "R": "20"},
            "0": {"L": "3", "D": "14", "U": "13", "R": "23"},
            "24": {"L": "3", "D": "3", "U": "19", "R": "24"},
            "9": {"L": "3", "D": "3", "U": "9", "R": "19"},
            "6": {"L": "12", "D": "11", "U": "0", "R": "6"},
            "1": {"L": "4", "D": "1", "U": "1", "R": "17"},
        },
        initial_state="16",
        final_states={"19"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("31402")) == DFA(
        states={
            "4",
            "11",
            "0",
            "12",
            "14",
            "7",
            "2",
            "10",
            "13",
            "3",
            "5",
            "8",
            "9",
            "6",
            "1",
            "15",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "4": {"L": "10", "D": "11", "U": "5", "R": "1"},
            "5": {"L": "7", "D": "11", "U": "5", "R": "13"},
            "6": {"L": "15", "D": "0", "U": "8", "R": "6"},
            "13": {"L": "15", "D": "4", "U": "8", "R": "6"},
            "12": {"L": "3", "D": "11", "U": "5", "R": "13"},
            "15": {"L": "15", "D": "8", "U": "0", "R": "6"},
            "14": {"L": "6", "D": "14", "U": "14", "R": "15"},
            "2": {"L": "2", "D": "5", "U": "11", "R": "2"},
            "3": {"L": "3", "D": "3", "U": "3", "R": "3"},
            "9": {"L": "2", "D": "14", "U": "14", "R": "2"},
            "7": {"L": "15", "D": "8", "U": "8", "R": "6"},
            "10": {"L": "15", "D": "4", "U": "12", "R": "6"},
            "8": {"L": "10", "D": "11", "U": "5", "R": "13"},
            "0": {"L": "13", "D": "11", "U": "5", "R": "13"},
            "11": {"L": "13", "D": "11", "U": "5", "R": "7"},
            "1": {"L": "15", "D": "3", "U": "8", "R": "6"},
        },
        initial_state="9",
        final_states={"3"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("12340")) == DFA(
        states={
            "4",
            "26",
            "11",
            "16",
            "0",
            "12",
            "28",
            "21",
            "24",
            "23",
            "14",
            "7",
            "20",
            "17",
            "10",
            "25",
            "27",
            "2",
            "13",
            "3",
            "22",
            "5",
            "19",
            "8",
            "9",
            "6",
            "1",
            "15",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "16": {"L": "16", "D": "16", "U": "16", "R": "16"},
            "5": {"L": "8", "D": "5", "U": "12", "R": "15"},
            "13": {"L": "13", "D": "20", "U": "10", "R": "6"},
            "15": {"L": "24", "D": "5", "U": "8", "R": "15"},
            "17": {"L": "7", "D": "17", "U": "7", "R": "16"},
            "20": {"L": "24", "D": "5", "U": "12", "R": "15"},
            "23": {"L": "16", "D": "17", "U": "7", "R": "16"},
            "7": {"L": "7", "D": "17", "U": "7", "R": "2"},
            "10": {"L": "20", "D": "11", "U": "14", "R": "20"},
            "8": {"L": "28", "D": "19", "U": "9", "R": "26"},
            "18": {"L": "7", "D": "17", "U": "7", "R": "25"},
            "26": {"L": "28", "D": "4", "U": "7", "R": "26"},
            "27": {"L": "13", "D": "20", "U": "20", "R": "6"},
            "11": {"L": "20", "D": "11", "U": "14", "R": "27"},
            "4": {"L": "16", "D": "19", "U": "9", "R": "21"},
            "12": {"L": "24", "D": "5", "U": "12", "R": "8"},
            "14": {"L": "27", "D": "11", "U": "14", "R": "20"},
            "19": {"L": "7", "D": "19", "U": "9", "R": "21"},
            "2": {"L": "7", "D": "16", "U": "7", "R": "2"},
            "3": {"L": "3", "D": "14", "U": "11", "R": "3"},
            "28": {"L": "28", "D": "18", "U": "9", "R": "26"},
            "22": {"L": "3", "D": "0", "U": "0", "R": "3"},
            "21": {"L": "28", "D": "4", "U": "16", "R": "26"},
            "25": {"L": "7", "D": "16", "U": "16", "R": "2"},
            "0": {"L": "6", "D": "0", "U": "0", "R": "13"},
            "24": {"L": "24", "D": "8", "U": "12", "R": "15"},
            "9": {"L": "28", "D": "19", "U": "9", "R": "1"},
            "6": {"L": "13", "D": "10", "U": "20", "R": "6"},
            "1": {"L": "7", "D": "23", "U": "7", "R": "2"},
        },
        initial_state="22",
        final_states={"16"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("32041")) == DFA(
        states={
            "4",
            "11",
            "16",
            "0",
            "12",
            "21",
            "24",
            "23",
            "14",
            "7",
            "20",
            "17",
            "10",
            "2",
            "13",
            "3",
            "22",
            "5",
            "19",
            "8",
            "9",
            "6",
            "1",
            "15",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "4": {"L": "6", "D": "13", "U": "1", "R": "11"},
            "16": {"L": "0", "D": "16", "U": "24", "R": "8"},
            "5": {"L": "5", "D": "2", "U": "19", "R": "5"},
            "6": {"L": "6", "D": "16", "U": "12", "R": "11"},
            "13": {"L": "0", "D": "16", "U": "24", "R": "4"},
            "15": {"L": "22", "D": "7", "U": "7", "R": "3"},
            "12": {"L": "0", "D": "16", "U": "24", "R": "9"},
            "14": {"L": "3", "D": "14", "U": "14", "R": "22"},
            "19": {"L": "15", "D": "19", "U": "2", "R": "0"},
            "2": {"L": "0", "D": "19", "U": "2", "R": "15"},
            "17": {"L": "6", "D": "23", "U": "12", "R": "11"},
            "3": {"L": "22", "D": "7", "U": "20", "R": "3"},
            "20": {"L": "0", "D": "19", "U": "2", "R": "0"},
            "23": {"L": "0", "D": "16", "U": "24", "R": "1"},
            "7": {"L": "0", "D": "16", "U": "24", "R": "21"},
            "22": {"L": "22", "D": "20", "U": "7", "R": "3"},
            "10": {"L": "1", "D": "16", "U": "24", "R": "9"},
            "18": {"L": "5", "D": "14", "U": "14", "R": "5"},
            "8": {"L": "6", "D": "13", "U": "12", "R": "11"},
            "21": {"L": "6", "D": "13", "U": "10", "R": "11"},
            "0": {"L": "6", "D": "7", "U": "12", "R": "11"},
            "24": {"L": "0", "D": "16", "U": "24", "R": "17"},
            "9": {"L": "6", "D": "23", "U": "10", "R": "11"},
            "11": {"L": "6", "D": "13", "U": "24", "R": "11"},
            "1": {"L": "1", "D": "1", "U": "1", "R": "1"},
        },
        initial_state="18",
        final_states={"1"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("23104")) == DFA(
        states={
            "4",
            "26",
            "41",
            "11",
            "12",
            "28",
            "24",
            "23",
            "54",
            "20",
            "17",
            "39",
            "10",
            "27",
            "44",
            "3",
            "55",
            "22",
            "19",
            "29",
            "38",
            "36",
            "8",
            "33",
            "52",
            "40",
            "51",
            "15",
            "46",
            "30",
            "49",
            "16",
            "42",
            "31",
            "32",
            "35",
            "0",
            "43",
            "56",
            "21",
            "53",
            "50",
            "14",
            "7",
            "45",
            "47",
            "25",
            "2",
            "13",
            "5",
            "48",
            "34",
            "9",
            "6",
            "1",
            "37",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "5": {"L": "5", "D": "42", "U": "14", "R": "28"},
            "48": {"L": "48", "D": "0", "U": "6", "R": "34"},
            "13": {"L": "13", "D": "47", "U": "44", "R": "17"},
            "52": {"L": "12", "D": "52", "U": "46", "R": "32"},
            "42": {"L": "36", "D": "1", "U": "53", "R": "49"},
            "33": {"L": "41", "D": "6", "U": "3", "R": "20"},
            "17": {"L": "13", "D": "32", "U": "2", "R": "17"},
            "53": {"L": "36", "D": "1", "U": "53", "R": "37"},
            "20": {"L": "41", "D": "14", "U": "2", "R": "20"},
            "44": {"L": "3", "D": "52", "U": "46", "R": "49"},
            "7": {"L": "31", "D": "7", "U": "4", "R": "23"},
            "18": {"L": "29", "D": "52", "U": "46", "R": "49"},
            "8": {"L": "29", "D": "24", "U": "35", "R": "15"},
            "40": {"L": "3", "D": "26", "U": "56", "R": "36"},
            "26": {"L": "12", "D": "26", "U": "56", "R": "23"},
            "39": {"L": "22", "D": "10", "U": "10", "R": "22"},
            "43": {"L": "3", "D": "54", "U": "54", "R": "30"},
            "56": {"L": "33", "D": "26", "U": "56", "R": "21"},
            "46": {"L": "16", "D": "52", "U": "46", "R": "9"},
            "29": {"L": "50", "D": "24", "U": "45", "R": "15"},
            "35": {"L": "29", "D": "24", "U": "35", "R": "51"},
            "31": {"L": "48", "D": "25", "U": "6", "R": "34"},
            "19": {"L": "3", "D": "3", "U": "19", "R": "54"},
            "2": {"L": "16", "D": "52", "U": "46", "R": "49"},
            "47": {"L": "27", "D": "52", "U": "46", "R": "32"},
            "51": {"L": "50", "D": "54", "U": "35", "R": "15"},
            "49": {"L": "13", "D": "32", "U": "8", "R": "17"},
            "25": {"L": "50", "D": "52", "U": "46", "R": "32"},
            "54": {"L": "54", "D": "54", "U": "54", "R": "54"},
            "36": {"L": "13", "D": "25", "U": "8", "R": "17"},
            "0": {"L": "36", "D": "1", "U": "53", "R": "32"},
            "16": {"L": "13", "D": "25", "U": "3", "R": "17"},
            "15": {"L": "50", "D": "3", "U": "35", "R": "15"},
            "34": {"L": "48", "D": "32", "U": "42", "R": "34"},
            "23": {"L": "41", "D": "6", "U": "8", "R": "20"},
            "10": {"L": "28", "D": "10", "U": "10", "R": "5"},
            "27": {"L": "13", "D": "25", "U": "11", "R": "17"},
            "11": {"L": "3", "D": "24", "U": "35", "R": "15"},
            "30": {"L": "3", "D": "3", "U": "54", "R": "30"},
            "38": {"L": "27", "D": "52", "U": "46", "R": "49"},
            "45": {"L": "3", "D": "3", "U": "19", "R": "43"},
            "4": {"L": "23", "D": "7", "U": "4", "R": "31"},
            "37": {"L": "48", "D": "32", "U": "6", "R": "34"},
            "55": {"L": "3", "D": "24", "U": "35", "R": "51"},
            "12": {"L": "13", "D": "25", "U": "44", "R": "17"},
            "14": {"L": "50", "D": "26", "U": "56", "R": "36"},
            "32": {"L": "50", "D": "24", "U": "35", "R": "15"},
            "3": {"L": "3", "D": "3", "U": "19", "R": "30"},
            "41": {"L": "41", "D": "38", "U": "40", "R": "20"},
            "28": {"L": "5", "D": "14", "U": "42", "R": "28"},
            "22": {"L": "22", "D": "4", "U": "7", "R": "22"},
            "21": {"L": "13", "D": "25", "U": "18", "R": "17"},
            "50": {"L": "50", "D": "24", "U": "55", "R": "15"},
            "24": {"L": "50", "D": "24", "U": "35", "R": "3"},
            "9": {"L": "13", "D": "32", "U": "18", "R": "17"},
            "6": {"L": "50", "D": "52", "U": "46", "R": "49"},
            "1": {"L": "31", "D": "1", "U": "53", "R": "32"},
        },
        initial_state="39",
        final_states={"54"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("32014")) == DFA(
        states={
            "4",
            "26",
            "41",
            "11",
            "12",
            "28",
            "24",
            "23",
            "54",
            "20",
            "17",
            "39",
            "10",
            "27",
            "44",
            "3",
            "55",
            "22",
            "19",
            "29",
            "38",
            "36",
            "8",
            "33",
            "52",
            "40",
            "51",
            "15",
            "46",
            "30",
            "49",
            "16",
            "42",
            "31",
            "32",
            "35",
            "0",
            "43",
            "56",
            "21",
            "53",
            "50",
            "14",
            "7",
            "45",
            "47",
            "25",
            "2",
            "13",
            "5",
            "48",
            "34",
            "9",
            "6",
            "1",
            "37",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "48": {"L": "7", "D": "48", "U": "27", "R": "39"},
            "5": {"L": "31", "D": "55", "U": "20", "R": "0"},
            "13": {"L": "14", "D": "14", "U": "9", "R": "13"},
            "52": {"L": "35", "D": "55", "U": "4", "R": "52"},
            "42": {"L": "42", "D": "38", "U": "37", "R": "42"},
            "33": {"L": "24", "D": "14", "U": "53", "R": "26"},
            "17": {"L": "35", "D": "17", "U": "41", "R": "1"},
            "20": {"L": "18", "D": "48", "U": "27", "R": "54"},
            "53": {"L": "19", "D": "48", "U": "27", "R": "54"},
            "44": {"L": "14", "D": "14", "U": "44", "R": "9"},
            "7": {"L": "31", "D": "25", "U": "18", "R": "0"},
            "18": {"L": "35", "D": "17", "U": "41", "R": "52"},
            "8": {"L": "19", "D": "6", "U": "28", "R": "46"},
            "40": {"L": "34", "D": "53", "U": "20", "R": "30"},
            "26": {"L": "24", "D": "22", "U": "51", "R": "26"},
            "39": {"L": "31", "D": "14", "U": "20", "R": "0"},
            "43": {"L": "29", "D": "43", "U": "10", "R": "33"},
            "56": {"L": "19", "D": "48", "U": "27", "R": "14"},
            "46": {"L": "31", "D": "17", "U": "20", "R": "0"},
            "29": {"L": "31", "D": "25", "U": "20", "R": "0"},
            "35": {"L": "35", "D": "17", "U": "14", "R": "52"},
            "31": {"L": "31", "D": "3", "U": "18", "R": "0"},
            "19": {"L": "31", "D": "17", "U": "18", "R": "0"},
            "2": {"L": "9", "D": "14", "U": "44", "R": "9"},
            "47": {"L": "14", "D": "14", "U": "2", "R": "13"},
            "51": {"L": "19", "D": "48", "U": "27", "R": "5"},
            "49": {"L": "49", "D": "8", "U": "12", "R": "15"},
            "54": {"L": "35", "D": "55", "U": "41", "R": "52"},
            "25": {"L": "19", "D": "48", "U": "27", "R": "36"},
            "0": {"L": "31", "D": "56", "U": "11", "R": "0"},
            "36": {"L": "35", "D": "14", "U": "41", "R": "52"},
            "16": {"L": "24", "D": "17", "U": "53", "R": "26"},
            "15": {"L": "49", "D": "12", "U": "8", "R": "15"},
            "34": {"L": "34", "D": "8", "U": "18", "R": "30"},
            "23": {"L": "15", "D": "23", "U": "23", "R": "49"},
            "10": {"L": "16", "D": "43", "U": "10", "R": "50"},
            "27": {"L": "18", "D": "48", "U": "27", "R": "50"},
            "11": {"L": "18", "D": "48", "U": "27", "R": "5"},
            "38": {"L": "16", "D": "37", "U": "38", "R": "40"},
            "30": {"L": "34", "D": "53", "U": "45", "R": "30"},
            "4": {"L": "9", "D": "17", "U": "41", "R": "52"},
            "45": {"L": "18", "D": "6", "U": "28", "R": "46"},
            "37": {"L": "40", "D": "37", "U": "38", "R": "16"},
            "55": {"L": "35", "D": "17", "U": "41", "R": "47"},
            "12": {"L": "46", "D": "43", "U": "10", "R": "54"},
            "14": {"L": "14", "D": "14", "U": "44", "R": "13"},
            "32": {"L": "34", "D": "53", "U": "18", "R": "30"},
            "3": {"L": "19", "D": "48", "U": "27", "R": "39"},
            "41": {"L": "14", "D": "17", "U": "41", "R": "52"},
            "22": {"L": "46", "D": "43", "U": "10", "R": "14"},
            "28": {"L": "18", "D": "6", "U": "28", "R": "40"},
            "21": {"L": "42", "D": "23", "U": "23", "R": "42"},
            "50": {"L": "31", "D": "56", "U": "20", "R": "0"},
            "24": {"L": "24", "D": "3", "U": "12", "R": "26"},
            "9": {"L": "9", "D": "9", "U": "9", "R": "9"},
            "6": {"L": "32", "D": "6", "U": "28", "R": "46"},
            "1": {"L": "35", "D": "14", "U": "4", "R": "52"},
        },
        initial_state="21",
        final_states={"9"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("13240")) == DFA(
        states={
            "26",
            "41",
            "11",
            "28",
            "23",
            "54",
            "71",
            "20",
            "17",
            "10",
            "27",
            "55",
            "19",
            "29",
            "38",
            "36",
            "73",
            "52",
            "40",
            "46",
            "49",
            "68",
            "16",
            "62",
            "31",
            "32",
            "35",
            "0",
            "21",
            "53",
            "47",
            "70",
            "58",
            "72",
            "13",
            "61",
            "45",
            "34",
            "9",
            "6",
            "18",
            "4",
            "65",
            "12",
            "24",
            "39",
            "44",
            "3",
            "22",
            "8",
            "33",
            "51",
            "15",
            "30",
            "42",
            "57",
            "69",
            "43",
            "56",
            "63",
            "64",
            "50",
            "14",
            "7",
            "59",
            "25",
            "2",
            "5",
            "48",
            "66",
            "67",
            "60",
            "1",
            "37",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "48": {"L": "42", "D": "61", "U": "31", "R": "54"},
            "5": {"L": "35", "D": "13", "U": "60", "R": "38"},
            "6": {"L": "10", "D": "26", "U": "69", "R": "10"},
            "13": {"L": "54", "D": "13", "U": "60", "R": "17"},
            "52": {"L": "33", "D": "39", "U": "10", "R": "7"},
            "42": {"L": "36", "D": "15", "U": "43", "R": "12"},
            "33": {"L": "33", "D": "70", "U": "27", "R": "7"},
            "67": {"L": "69", "D": "10", "U": "10", "R": "32"},
            "17": {"L": "57", "D": "2", "U": "46", "R": "18"},
            "53": {"L": "53", "D": "48", "U": "5", "R": "49"},
            "20": {"L": "10", "D": "40", "U": "56", "R": "19"},
            "71": {"L": "69", "D": "6", "U": "69", "R": "32"},
            "44": {"L": "23", "D": "62", "U": "10", "R": "66"},
            "7": {"L": "33", "D": "45", "U": "69", "R": "7"},
            "18": {"L": "57", "D": "0", "U": "46", "R": "18"},
            "8": {"L": "54", "D": "8", "U": "24", "R": "30"},
            "73": {"L": "23", "D": "40", "U": "56", "R": "19"},
            "40": {"L": "69", "D": "40", "U": "56", "R": "59"},
            "26": {"L": "69", "D": "26", "U": "69", "R": "10"},
            "39": {"L": "23", "D": "51", "U": "64", "R": "44"},
            "43": {"L": "23", "D": "51", "U": "64", "R": "66"},
            "70": {"L": "43", "D": "8", "U": "24", "R": "52"},
            "60": {"L": "16", "D": "13", "U": "60", "R": "42"},
            "56": {"L": "37", "D": "40", "U": "56", "R": "55"},
            "46": {"L": "14", "D": "40", "U": "56", "R": "19"},
            "29": {"L": "36", "D": "9", "U": "43", "R": "12"},
            "35": {"L": "57", "D": "43", "U": "47", "R": "18"},
            "31": {"L": "34", "D": "61", "U": "31", "R": "3"},
            "24": {"L": "25", "D": "8", "U": "24", "R": "69"},
            "19": {"L": "23", "D": "62", "U": "64", "R": "66"},
            "2": {"L": "43", "D": "13", "U": "60", "R": "1"},
            "47": {"L": "43", "D": "8", "U": "24", "R": "22"},
            "51": {"L": "69", "D": "51", "U": "64", "R": "44"},
            "49": {"L": "53", "D": "5", "U": "48", "R": "49"},
            "54": {"L": "33", "D": "39", "U": "72", "R": "7"},
            "25": {"L": "33", "D": "70", "U": "72", "R": "7"},
            "0": {"L": "54", "D": "13", "U": "60", "R": "38"},
            "61": {"L": "3", "D": "61", "U": "31", "R": "34"},
            "36": {"L": "36", "D": "69", "U": "4", "R": "12"},
            "16": {"L": "57", "D": "21", "U": "65", "R": "18"},
            "15": {"L": "69", "D": "40", "U": "56", "R": "19"},
            "34": {"L": "57", "D": "2", "U": "65", "R": "18"},
            "59": {"L": "36", "D": "20", "U": "46", "R": "12"},
            "64": {"L": "23", "D": "51", "U": "64", "R": "71"},
            "23": {"L": "23", "D": "58", "U": "64", "R": "66"},
            "10": {"L": "10", "D": "10", "U": "10", "R": "10"},
            "27": {"L": "54", "D": "8", "U": "24", "R": "69"},
            "65": {"L": "29", "D": "13", "U": "60", "R": "43"},
            "11": {"L": "33", "D": "39", "U": "69", "R": "7"},
            "38": {"L": "57", "D": "73", "U": "43", "R": "18"},
            "30": {"L": "33", "D": "70", "U": "10", "R": "7"},
            "45": {"L": "54", "D": "8", "U": "24", "R": "52"},
            "4": {"L": "14", "D": "40", "U": "56", "R": "55"},
            "37": {"L": "36", "D": "69", "U": "46", "R": "12"},
            "63": {"L": "35", "D": "13", "U": "60", "R": "42"},
            "66": {"L": "23", "D": "62", "U": "69", "R": "66"},
            "57": {"L": "57", "D": "21", "U": "63", "R": "18"},
            "68": {"L": "68", "D": "31", "U": "61", "R": "68"},
            "55": {"L": "36", "D": "20", "U": "43", "R": "12"},
            "12": {"L": "36", "D": "41", "U": "46", "R": "12"},
            "14": {"L": "36", "D": "69", "U": "43", "R": "12"},
            "32": {"L": "69", "D": "10", "U": "69", "R": "32"},
            "3": {"L": "53", "D": "46", "U": "21", "R": "49"},
            "41": {"L": "10", "D": "40", "U": "56", "R": "55"},
            "22": {"L": "23", "D": "51", "U": "69", "R": "66"},
            "28": {"L": "49", "D": "28", "U": "28", "R": "53"},
            "72": {"L": "43", "D": "8", "U": "24", "R": "69"},
            "21": {"L": "43", "D": "8", "U": "24", "R": "11"},
            "50": {"L": "68", "D": "28", "U": "28", "R": "68"},
            "62": {"L": "10", "D": "51", "U": "64", "R": "44"},
            "9": {"L": "69", "D": "51", "U": "64", "R": "66"},
            "69": {"L": "69", "D": "26", "U": "69", "R": "32"},
            "58": {"L": "69", "D": "26", "U": "69", "R": "67"},
            "1": {"L": "33", "D": "39", "U": "64", "R": "7"},
        },
        initial_state="50",
        final_states={"10"},
    )
    assert PinWords.load_dfa_for_perm(Perm.from_string("1230")) == DFA(
        states={
            "4",
            "11",
            "16",
            "0",
            "12",
            "21",
            "23",
            "14",
            "7",
            "20",
            "17",
            "10",
            "2",
            "13",
            "3",
            "22",
            "5",
            "19",
            "8",
            "9",
            "6",
            "1",
            "15",
            "18",
        },
        input_symbols={"U", "L", "R", "D"},
        transitions={
            "4": {"L": "4", "D": "6", "U": "1", "R": "4"},
            "16": {"L": "20", "D": "16", "U": "20", "R": "7"},
            "5": {"L": "12", "D": "8", "U": "3", "R": "0"},
            "6": {"L": "9", "D": "1", "U": "6", "R": "5"},
            "12": {"L": "12", "D": "14", "U": "3", "R": "0"},
            "15": {"L": "15", "D": "5", "U": "2", "R": "13"},
            "14": {"L": "20", "D": "16", "U": "20", "R": "21"},
            "13": {"L": "15", "D": "2", "U": "5", "R": "13"},
            "19": {"L": "4", "D": "18", "U": "18", "R": "4"},
            "2": {"L": "5", "D": "1", "U": "6", "R": "5"},
            "17": {"L": "20", "D": "22", "U": "20", "R": "10"},
            "3": {"L": "12", "D": "8", "U": "3", "R": "17"},
            "20": {"L": "20", "D": "16", "U": "20", "R": "10"},
            "7": {"L": "7", "D": "7", "U": "7", "R": "7"},
            "22": {"L": "7", "D": "16", "U": "20", "R": "7"},
            "23": {"L": "7", "D": "8", "U": "3", "R": "11"},
            "10": {"L": "20", "D": "7", "U": "20", "R": "10"},
            "8": {"L": "20", "D": "8", "U": "3", "R": "11"},
            "18": {"L": "13", "D": "18", "U": "18", "R": "15"},
            "21": {"L": "20", "D": "7", "U": "7", "R": "10"},
            "0": {"L": "12", "D": "23", "U": "20", "R": "0"},
            "9": {"L": "15", "D": "5", "U": "5", "R": "13"},
            "11": {"L": "12", "D": "23", "U": "7", "R": "0"},
            "1": {"L": "5", "D": "1", "U": "6", "R": "9"},
        },
        initial_state="19",
        final_states={"7"},
    )


def test_create_dfa_db_for_length():
    PinWords.create_dfa_db_for_length(1)
    for perm in Perm.of_length(1):
        assert PinWords.load_dfa_for_perm(perm) == PinWords.make_dfa_for_perm(perm)

    PinWords.create_dfa_db_for_length(2)
    for perm in Perm.of_length(2):
        assert PinWords.load_dfa_for_perm(perm) == PinWords.make_dfa_for_perm(perm)

    PinWords.create_dfa_db_for_length(3)
    for perm in Perm.of_length(3):
        assert PinWords.load_dfa_for_perm(perm) == PinWords.make_dfa_for_perm(perm)

    PinWords.create_dfa_db_for_length(4)
    for perm in Perm.of_length(4):
        assert PinWords.load_dfa_for_perm(perm) == PinWords.make_dfa_for_perm(perm)
